\chapter{The Theory of Number Fields}
  Introductory analytic number theory is done over $\Q$. The associated set of integers $\Z$ is a ring inside $\Q$. Moreover, the fundamental theorem of arithmetic tells us that prime factorization exists in $\Z$. That is, every integer is uniquely a product of primes (up to reordering of the factors). The study of number fields is concerned with finite extensions of $\Q$ where there might no longer be prime factorization. In the following, we discuss the structure of number fields, their associated ring of integers, and the properties of prime factorization.
  \section{Numbers Fields \& Algebraic Integers}
    An \textbf{number field}\index{number field} $K$ is a finite extension of $\Q$. That is, $K$ is a finite dimensional vector space over $\Q$. In particular, $K/\Q$ is a finite separable extension, so that the primitive element theorem applies, and is Galois if and only if $K/\Q$ is normal. We say that the \textbf{degree}\index{degree} of $K$ is $[K:\Q]$ which is the dimension of $K$ as a vector space over $\Q$. If $K$ is of degree $2$, $3$, etc. then we say it is \textbf{quadratic}\index{quadratic}, \textbf{cubic}\index{cubic}, etc. Any $\k \in K$ is called an \textbf{algebraic number}\index{algebraic number}. Moreover, we say that $\k$ is an \textbf{algebraic integer}\index{algebraic integer} if it is the root of a monic polynomial $f(x) \in \Z[x]$. If $K = \Q$, it is clear that any integer is an algebraic integer ($n$ is the root of $x-n$.). Moreover, any rational root of a monic polynomial must be an integer by the rational root theorem. In other words, if $f(x) \in \Z[x]$ is monic and $q \in \Q$ is a root of $f(x)$ then $q \in \Z$. Therefore for the number field $\Q$, the algebraic integers are exactly the integers $\Z$. Our first goal in studying number fields is to discuss the algebraic integers. Accordingly, we define the \textbf{ring of integers}\index{ring of integers} $\mc{O}_{K}$ of $K$ by
    \[
      \mc{O}_{K} = \{\k \in K:\text{$\k$ is an algebraic integer}\}.
    \]
    From what we have just shown above, $\Z \subseteq \mc{O}_{K}$. For a general number field $K$, $\mc{O}_{K}$ can be strictly larger than $\Z$. The ring of integers $\mc{O}_{K}$ is the analog of $\Z$ in $\Q$ but for $K$. Our primarily goals will be to show that $\mc{O}_{K}$ is a ring and more precisely a free abelian group of rank equal to the degree of $K$. The following proposition shows that $\mc{O}_{K}$ is indeed a ring:

    \begin{proposition}\label{prop:algebraic_integer_if_finitely_generated}
      Let $K$ be a number field. Then the finitely many elements $\k_{1},\ldots,\k_{n} \in B$ are all algebraic integers if and only if $\Z[\k_{1},\ldots,\k_{n}]$ is a finitely generated $\Z$-module. In particular, $\mc{O}_{K}$ is a ring.
    \end{proposition}
    \begin{proof}
      First suppose $\k \in K$ is an algebraic integer. Then there exists a monic polynomial $f(x) \in \Z[x]$, of say degree $n \ge 1$, such that $f(\k) = 0$. Now for any $g(x) \in \Z[x]$, Euclidean division implies
      \[
        g(x) = q(x)f(x)+r(x),
      \]
      with $q(x),r(x) \in \Z[x]$ and $\deg(r(x)) < n$. Letting $r(x) = a_{n-1}x^{n-1}+\cdots+a_{1}x+a_{0}$ with $a_{i} \in \Z$ for $0 \le i \le n-1$, it follows that
      \[
        g(\k) = r(\k) = a_{n-1}\k^{n-1}+\cdots+a_{1}\k+a_{0}.
      \]
      As $g(x)$ was arbitrary, we see that $\{1,\k,\ldots,\k^{n-1}\}$ is a generating set for $\Z[\k]$ as a $\Z$-module. Now suppose $\k_{1},\ldots,\k_{n} \in K$ are all algebraic integers. We will prove that $\Z[\k_{1},\ldots,\k_{n}]$ is finitely generated as an $\Z$-module by induction. Our previous work implies the base case. So assume by induction that $R = \Z[\k_{1},\ldots,\k_{n-1}]$ is a finitely generated $\Z$-module. Then $R[\k_{n}] = A[\k_{1},\ldots,\k_{n}]$ is a finitely generated $R$-module and hence a finitely generated $\Z$-module as well by our induction hypothesis. Now suppose $A[\k_{1},\ldots,\k_{n}]$ is a finitely generated $\Z$-module. Let $\{\w_{1},\ldots,\w_{r}\}$ be a basis for $A[\k_{1},\ldots,\k_{n}]$. Then for any $\k \in A[\k_{1},\ldots,\k_{n}]$, we have
      \[
        \k\w_{i} = \sum_{1 \le j \le r}a_{i,j}\w_{j},
      \]
      with $a_{i,j} \in \Z$ for $1 \le i,j \le r$.We can rewrite this as,
      \[
        (\k-a_{i,i})\w_{i}-\sum_{\substack{1 \le j \le r \\ j \neq i}}a_{i,j}\w_{j} = 0,
      \]
      for all $i$. These $r$ equations are equivalent to the identity
      \[
        \begin{pmatrix} k-a_{1,1} & a_{1,2} & \cdots & -a_{1,r} \\ -a_{2,1} & \k-a_{2,2} & & \\ \vdots & & \ddots & \\ -a_{r,1} & & & \k-a_{r,r} \end{pmatrix}\begin{pmatrix} \w_{1} \\ \w_{2} \\ \vdots \\ \w_{r} \end{pmatrix} = \mathbf{0}.
      \]
      Thus the determinant of the matrix on the left-hand side must be zero. This shows that $\k$ is the root of the characteristic polynomial $\det(xI-(a_{i,j})_{i,j})$ which is a monic polynomial with coefficients in $\Z$. Hence $\k$ is an algebraic integer. As $\k$ was arbitrary, this shows that the elements $\k_{1},\ldots,\k_{n}$ are all algebraic integers and that the sum and product of algebraic integers are algebraic integers. It follows that $\mc{O}_{K}$ is a ring.
    \end{proof}

    We can also show that $K$ is the field of fractions of $\mc{O}_{K}$. Actually, the following proposition proves this and more:

    \begin{proposition}\label{prop:field_of_fractions_of_ring_of_integers}
      Let $K$ be a number field. Then every $\k \in K$ is of the form
      \[
        \k = \frac{\a}{a},
      \]
      for some $\a \in \mc{O}_{K}$ and nonzero $a \in \Z$. In particular, $K$ is the field of fractions of $\mc{O}_{K}$. Moreover, $\k \in K$ is an algebraic integer if and only if the minimal polynomial of $\k$ has coefficients in $\Z$.
    \end{proposition}
    \begin{proof}
      As $K/\Q$ is finite, it is necessarily algebraic so that any $\k \in K$ satisfies
      \[
        a\k^{n}+a_{n-1}\k^{n-1}+\cdots+a_{0} = 0,
      \]
      with $a_{i} \in \Z$ for $0 \le i \le n-1$ and nonzero $a \in \Z$. We claim that $a\k$ is an algebraic integer. Indeed, multiplying the previous identity by $a^{n-1}$ yields
      \[
        (a\k)^{n}+a'_{n-1}(a\k)^{n-1}+\cdots+a'_{0} = 0,
      \]
      where $a'_{i} = a_{i}a^{n-1-i}$ for $0 \le i \le n-1$, and so $a\k$ is the root of a monic polynomial with coefficients in $\Z$. Then $a\k \in \mc{O}_{K}$ and so $a\k = \a$ for some $\a \in \mc{O}_{K}$ which is equivalent to $\k = \frac{\a}{a}$. As $\Z \subseteq \mc{O}_{K}$, this also implies that $K$ is the field of fractions of $\mc{O}_{K}$. For the last statement, suppose $\k \in K$. If the minimal polynomial of $\k$ has integer coefficients then $\k$ is automatically an algebraic integer (since the minimal polynomial is monic). So suppose $\k$ is an algebraic integer so that $\k$ is a root of a monic polynomial $f(x) \in \Z[x]$. If $m_{\k}(x) \in \Q[x]$ is the minimal polynomial of $\k$, then $m_{\k}(x)$ divides $f(x)$ and thus all of the roots of $m_{\k}(x)$ algebraic integers too. By Vieta's formulas, the coefficients of $m_{\k}(x)$ algebraic integers as well. But then $m_{\k}(x) \in \Z[x]$. This completes the proof.
    \end{proof}
  \section{Traces \& Norms}
    We will now require norms and traces of algebras. Let $K$ be a field and let $R$ be an $n$-dimensional $K$-algebra. Then the \textbf{trace}\index{trace} and \textbf{norm}\index{norm} of $R$, denoted $\Trace_{R/K}$ and $\Norm_{R/K}$ respectively, are defined by
    \[
      \Trace_{R/K}(\rho) = \tr(T_{\rho}) \quad \text{and} \quad \Norm_{R/K}(\rho) = \det(T_{\rho}),
    \]
    for any $\rho \in R$, where $T_{\rho}:R \to R$ is the linear operator defined by
    \[
      T_{\rho}(x) = \rho x,
    \]
    for all $x \in R$. That is, $T_{\rho}$ is the multiplication by $\rho$ map. Letting $f_{\rho}(t)$ denote the characteristic polynomial of $T_{\rho}$, we have
    \[
      f_{\rho}(t) = \det(tI-T_{\rho}) = t^{n}-\k_{n-1}t^{n-1}+\cdots+(-1)^{n}\k_{0},
    \]
    with $\k_{i} \in K$ for $0 \le i \le n-1$. Then the trace and the norm are given by
    \begin{equation}\label{equ:trace_and_norm_characteristic_polynomial}
      \Trace_{R/K}(\rho) = \k_{n-1} \quad \text{and} \quad \Norm_{R/K}(\rho) = \k_{0},
    \end{equation}
    and therefore take values in $K$. Moreover, we have
    \[
      \Trace_{R/K}(\k\rho) = \k\Trace_{R/K}(\rho) \quad \text{and} \quad \Norm_{R/K}(\k\rho) = \k^{m}\Norm_{R/K}(\rho),
    \]
    for all $\k \in K$ because $T_{\k\l} = \k T_{\l}$. Also note that $T_{\l+\nu} = T_{\l}+T_{\nu}$ and $T_{\l \nu} = T_{\l}T_{\nu}$ for all $\l,\nu \in R$. In the case of a degree $n$ extension $L/K$, we call $\Trace_{L/K}$ and $\Norm_{L/K}$ the \textbf{trace}\index{trace} and \textbf{norm}\index{norm} of $L/K$. Moreover, $\Norm(\l) = 0$ if and only if $\l = 0$ because otherwise $T_{\l}$ has inverse $T_{\l^{-1}}$ and hence a nonzero determinant. Therefore we obtain homomorphisms
    \[
      \Trace_{L/K}:L \to K \quad \text{and} \quad \Norm_{L/K}:L^{\ast} \to K^{\ast}.
    \]
    In the specialized setting $K/\Q$ for a number field $K$, we write $\Trace = \Trace_{K/\Q}$ and $\Norm = \Norm_{K/\Q}$ and call these the \textbf{field trace}\index{field trace} and \textbf{field norm}\index{field norm} respectively. Moreover, for any $\k \in K$ we call $\Trace(\k)$ and $\Norm(\k)$ the \textbf{trace}\index{trace} and \textbf{norm}\index{norm} of $\k$ respectively. When $L/K$ is separable, we can derive alternative descriptions of the trace and norm of $L/K$. This additional assumption is weak because the only situations we will be interested in are finite extensions of $\Q$ and $\F_{p}$ which are always separable (because both $\Q$ and $\F_{p}$ are perfect). In any case, to do this we need to work in the algebraic closure $\conj{K}$ of $K$. As $L/K$ is a degree $n$ separable extension, there are exactly $n$ distinct $K$-embeddings $\s_{1},\ldots,\s_{n}$ of $L$ into $\conj{K}$ (each given by letting $\t$ be a primitive element for $L$ so that $L = K[\t]$ and sending $\t$ to one of its conjugate roots in the minimal polynomial $m_{\t}(x)$ of $\t$). Clearly $\s_{1},\ldots,\s_{n}$ send $\mc{O}_{K}$ to itself and fix $\mc{O}_{K}$ pointwise. Moreover, we prove the following proposition:

    \begin{proposition}\label{prop:formulas_for_trace_and_norm}
      Let $L/K$ be a degree $n$ separable extension and let $\s$ run over all $K$-embeddings $\s$ of $L$ into $\conj{K}$. For any $\l \in L$, the characteristic polynomial $f_{\l}(t)$ of $T_{\l}$ is a power of the minimal polynomial of $\l$ and satisfies
      \[
        f_{\l}(t) = \prod_{\s}(t-\s(\l)).
      \]
      In particular,
      \[
        \Trace_{L/K}(\l) = \sum_{\s}\s(\l) \quad \text{and} \quad \Norm_{L/K}(\l) = \prod_{\s}\s(\l).
      \]
    \end{proposition}
    \begin{proof}
      Let
      \[
        m_{\l}(t) = t^{m}+\k_{m-1}t^{m-1}+\cdots+\k_{0},
      \]
      with $\k_{i} \in K$ for $0 \le i \le n-1$, be the minimal polynomial of $\l$ (necessarily $m$ is the degree of $K(\l)/K$). Let $d$ be the degree of $L/K(\l)$. We first show that $f_{\l}(t)$ is a power of $m_{\l}(t)$. Precisely, we claim that
      \[
        f_{\l}(t) = m_{\l}(t)^{d}.
      \]
      To see this, recall that $\{1,\l,\ldots,\l^{n-1}\}$ is a basis for $K(\l)/K$. If $\{\a_{1},\ldots,\a_{d}\}$ is a basis for $L/K(\l)$, then
      \[
        \{\a_{1},\a_{1}\l,\ldots,\a_{1}\l^{m-1},\ldots,\a_{d},\a_{d}\l,\ldots,\a_{d}\l^{m-1}\},
      \]
      is a basis for $L/K$. Because the minimal polynomial $m_{\l}(t)$ gives the linear relation
      \[
        \l^{m} = -\k_{0}-k_{1}\l-\cdots-\k_{m-1}\l^{m-1},
      \]
      the matrix of $T_{\l}$ is block diagonal with $d$ blocks each of the form
      \[
        \begin{pmatrix} & 1 & & \\ & & \ddots & \\ & & & 1 \\ -\k_{0} & -\k_{1} & \cdots & -\k_{m-1} \\ \end{pmatrix}.
      \]
      This is the companion matrix to $m_{\l}(t)$ and hence the characteristic polynomial is $m_{\l}(t)$ as well. Our claim follows since the matrix of $T_{\l}$ is block diagonal. Since $\l$ is algebraic over $K$ of degree $m$, $K(\l)$ is the splitting field of $m_{\l}(t)$ and there are $m$ distinct $K$-embeddings of $K(\l)$ into $\conj{K}$. Let $\tau$ be such an $K$embedding. Then the $K$-embeddings $\s$ are partitioned into $m$ many equivalence classes each of size $d$ (because $L/K(\l)$ is degree $d$) where $\s$ and $\s'$ are in the same class if and only if $\s(\l) = \s'(\l)$. In particular, a complete set of representatives is given by the $\tau$. But then
      \[
        f_{\l}(t) = m_{\l}(t)^{d} = \left(\prod_{\tau}(t-\tau(\l))\right)^{d} = \prod_{\s}(t-\s(\l)),
      \]
      which proves the first statement. The formulas for the trace and norm follow from Vieta's formulas and \cref{equ:trace_and_norm_characteristic_polynomial}.
    \end{proof}

    As a corollary of \cref{prop:formulas_for_trace_and_norm}, we can show how the field trace and field norm act on algebraic integers:

    \begin{corollary}\label{cor:norm_and_trace_of_algebraic_integers}
      Let $K$ be a number field. If $\k \in K$ is an algebraic integer, then the trace and norm of $\k$ are integers.
    \end{corollary}
    \begin{proof}
      By \cref{prop:field_of_fractions_of_ring_of_integers}, if $\k$ is an algebraic integer then its minimal polynomial $m_{\k}(t)$ has integer coefficients. By \cref{prop:formulas_for_trace_and_norm} the characteristic polynomial $f_{\k}(t)$ is a power of $m_{\k}(t)$. Hence $f_{\k}(t)$ has integer coefficients. From \cref{equ:trace_and_norm_characteristic_polynomial} we conclude that the trace and norm of $\k$ are integers.
    \end{proof}

    We can also classify the units in $\mc{O}_{K}$ according to their norm:

    \begin{corollary}\label{cor:unit_if_and_only_if_absolute_value_norm_1}
      Let $K$ be a number field. Then $\a \in \mc{O}_{K}$ is a unit if and only if its norm is $\pm 1$.
    \end{corollary}
    \begin{proof}
      Let $\a \in \mc{O}_{K}$. First suppose $\a$ is a unit in $\mc{O}_{K}$. Then $\frac{1}{\a} \in \mc{O}_{K}$ and so
      \[
        \Norm(\a)\Norm\left(\frac{1}{\a}\right) = \Norm(1) = 1.
      \]
      By \cref{cor:norm_and_trace_of_algebraic_integers}, the norm of $\a$ and $\frac{1}{\a}$ are both integers. Hence they must be $\pm1$ and thus the norm of $\a$ is $\pm1$. Now suppose the norm of $\a$ is $\pm1$. By \cref{prop:field_of_fractions_of_ring_of_integers}, its minimal polynomial $m_{\a}(t)$ has integer coefficients. Moreover, \cref{equ:trace_and_norm_characteristic_polynomial,prop:formulas_for_trace_and_norm} together imply that the constant term is $\pm1$. Letting the degree of $m_{\a}(t)$ be $m$, we have shown that
      \[
        m_{\a}(t) = t^{m}+a_{m-1}t^{m-1}+\cdots\pm1,
      \]
      with $a_{i} \in \Z$ for $1 \le i \le m-1$. Dividing $m_{\a}(\a)$ by $\a^{m}$, we find that $\frac{1}{\a}$ is a root of the polynomial
      \[
        f(x) = \pm t^{m}+a_{1}t^{m-1}+\cdots+1.
      \]
      Multiplying by $-1$ if necessary, it follows that $\frac{1}{\a}$ is a root of a monic polynomial with coefficients in $\Z$. Hence $\frac{1}{\a} \in \mc{O}_{K}$ and thus $\a$ is a unit in $\mc{O}_{K}$.
    \end{proof}

    We can now prove a structure theorem for the ring of integers $\mc{O}_{K}$ of a number field $K$. We show that the ring of integers is a free abelian group with rank equal to the degree of $K$ which clearly is a generalization of the structure of $\Z$ for for the number field $\Q$:

    \begin{theorem}\label{thm:ring_of_integers_finitely_generated}
      Let $K$ be a number field of degree $n$. Then $\mc{O}_{K}$ is a free abelian group of rank $n$. In particular, $\mc{O}_{K}$ is a finitely generated $\Z$-module.
    \end{theorem}
    \begin{proof}
      Let $\{\k_{1},\ldots,\k_{n}\}$ be a basis for $K$. By \cref{prop:field_of_fractions_of_ring_of_integers}, we have $\k_{i} = \frac{\a_{i}}{a_{i}}$ with $\a_{i} \in \mc{O}_{K}$ and $a_{i} \in \Z$ for $1 \le i \le n$. Hence $\{\a_{1},\ldots,\a_{n}\}$ is a basis for $K$ as well. In particular, any element $\a \in \mc{O}_{K}$ can be expressed as
      \[
        \a = \sum_{1 \le i \le n}q_{i}(\a)\a_{i},
      \]
      with $q_{i}(\a) \in \Q$. We now show that the denominators of the $q_{i}(\a)$ are uniformly bounded for all $1 \le i \le n$ and all $\a$. Assume this is not the case. Then there is a sequence $(\b_{j})_{j \ge 1}$ of nonzero elements in $\mc{O}_{K}$ where
      \[
        \b_{j} = \sum_{1 \le i \le n}q_{i}(\b_{j})\a_{i},
      \]
      is such that the greatest denominator of $q_{i}(\b_{j})$ for $1 \le i \le n$ tends to infinity as $j \to \infty$. In terms of the basis $\{\a_{1},\ldots,\a_{n}\}$, $\Norm(\b_{j})$ is the determinant of an $n \x n$ matrix with coefficients in $\Q[q_{i}(\b_{j})]_{1 \le i \le n}$. In particular, it is a homogenous polynomial of degree $n$ in the $q_{i}(\b_{j})$ for $1 \le i \le n$ with coefficients in $\Q$ determined by the basis $\{\a_{1},\ldots,\a_{n}\}$. But $\Norm(\b_{j})$ is an integer by \cref{cor:norm_and_trace_of_algebraic_integers}. It is also nonzero because $\b_{j}$ is nonzero. Hence $|\Norm(\b_{j})| \ge 1$ and thus, by what we have just shown, the greatest denominator of $q_{i}(\b_{j})$ for $1 \le i \le n$ must be bounded as $j \to \infty$. This gives a contradiction. Hence there is an integer $M \ge 1$ such that $Mq_{i}(\a) \in \Z$ for all $1 \le i \le n$ and $\a \in \mc{O}_{K}$. Therefore
      \[
        \mc{O}_{K} \subseteq \frac{1}{M}\bigop_{1 \le i \le n}\Z\a_{i}.
      \]
      As the group on the right-hand side is a free abelian group so is $\mc{O}_{K}$. Moreover, as $\{\a_{1},\ldots,\a_{n}\}$ is a basis for $K$ we see that $\{\a_{1},\ldots,\a_{n}\}$ is linearly independent over $\Z$ as well. This means that the rank of $\mc{O}_{K}$ must be $n$. The last statement is now clear.
    \end{proof}

    In accordance with \cref{thm:ring_of_integers_finitely_generated}, we say that $\{\a_{1},\ldots,\a_{n}\}$ is an \textbf{integral basis}\index{integral basis} for $K$ if $\{\a_{1},\ldots,\a_{n}\}$ is a basis for $K$ and $\mc{O}_{K}$ can be expressed as
    \[
      \mc{O}_{K} = \Z\a_{1}+\cdots+\Z\a_{n}.
    \]
    That is, every $\a \in \mc{O}_{K}$ is a unique integer linear combination of the $\a_{i}$. An integral basis for $K$ always exists by \cref{thm:ring_of_integers_finitely_generated}. In the special case $\mc{O}_{K} = \Z[\a]$ for some $\a \in \mc{O}_{K}$, we say $K$ is \textbf{monogenic}\index{monogenic}. By \cref{thm:ring_of_integers_finitely_generated}, we see that $\{1,\a,\ldots,\a^{n-1}\}$ is an integral basis for $K$. Lastly, we can show that algebraic integers satisfy a slightly weaker condition:

    \begin{proposition}\label{ring_of_integers_algebraically_closed}
      Let $K$ be a number field. Then $\k \in K$ is an algebraic integer if and only if $\k$ is the root of a monic polynomial with coefficients in $\mc{O}_{K}$.
    \end{proposition}
    \begin{proof}
      If $\k \in K$ is an algebraic integer, then $\k$ is the root of a monic polynomial with coefficients in $\Z$ and hence in $\mc{O}_{K}$ as well. So suppose $\k \in K$ is the root of a monic polynomial $f(x) \in \mc{O}_{K}$. Let $f(x)$ have degree $n$ and write
      \[
        f(x) = x^{n}+\a_{n-1}x^{n-1}+\cdots+\a_{0},
      \]
      with $\a_{i} \in \mc{O}_{K}$ for $0 \le i \le n-1$. As $f(\k) = 0$, we have
      \[
        \k^{n} = -\a_{n-1}\k^{n-1}-\cdots-\a_{0},
      \]
      and hence $\mc{O}_{K}[\k]$ is a finitely generated $\Z$-module because $\mc{O}_{K}$ is by \cref{thm:ring_of_integers_finitely_generated}. As $\Z[\k] \subseteq \mc{O}_{K}[\k]$, we see that $\Z[\k]$ must also be a finitely generated $\Z$-module. Hence $\k$ is an algebraic integer by \cref{prop:algebraic_integer_if_finitely_generated}.
    \end{proof}
  \section{Discriminants}
    We will now discuss discriminants of algebras. Let $K$ be a field and $R$ be an $n$-dimensional $K$-algebra. If $\{\rho_{1},\ldots,\rho_{n}\}$ is a basis for $R$, we set
    \[
      \disc_{R/K}(\rho_{1},\ldots,\rho_{n}) = \det((\Trace_{R/K}(\rho_{i}\rho_{j}))_{i,j}).
    \]
    In particular, $\disc_{R/K}(\rho_{1},\ldots,\rho_{n})$ is an element of $K$. It is also independent of the choice of basis up to elements of $(K^{\ast})^{2}$. Indeed, if $\{\rho'_{1},\ldots,\rho'_{n}\}$ is another basis then we have
    \[
      \rho'_{i} = \sum_{1 \le j \le m}\k_{i,j}\rho_{j},
    \]
    with $\k_{i,j} \in K$ for $1 \le i,j \le n$. Then $(\k_{i,j})_{i,j}$ is the base change matrix from $\{\rho_{1},\ldots,\rho_{n}\}$ to $\{\rho'_{1},\ldots,\rho'_{n}\}$ and so it has nonzero determinant. Thus $\det((\k_{i,j})_{i,j}) \in K^{\ast}$. Moreover, we have
    \[
      (\Trace_{R/K}(\rho'_{i}\rho'_{j}))_{i,j} = (\k_{i,j})_{i,j}(\Trace_{R/K}(\rho_{i}\rho_{j}))_{i,j}(\k_{i,j})_{i,j}^{t},
    \]
    which, upon taking the determinant, shows that
    \begin{equation}\label{equ:discriminant_base_change}
      \disc_{R/K}(\rho'_{1},\ldots,\rho'_{n}) = \det((\k_{i,j})_{i,j})^{2}\disc_{R/K}(\rho_{1},\ldots,\rho_{n}),
    \end{equation}
    as claimed. We define the \textbf{discriminant}\index{discriminant} $\disc_{K}(R)$ of $R$ by
    \[
      \disc_{K}(R) = \disc_{R/K}(\rho_{1},\ldots,\rho_{n}) \pmod{(K^{\ast})^{2}}.
    \]
    for any basis $\{\rho_{1},\ldots,\rho_{n}\}$ of $R$. By what we have shown, $\disc_{K}(R)$ is well-defined. The discriminant is also multiplicative with respect to direct sums:

    \begin{proposition}\label{prop:discriminant_and_direct_sums}
      Let $K$ be a field and $R$ be an $n$-dimensional $K$-algebra. Suppose we have a direct sum decomposition
      \[
        R = R_{1} \op R_{2},
      \]
      for $K$-algebras $R_{1}$ and $R_{2}$ of dimensions $n_{1}$ and $n_{2}$ respectively. Also let $\{\eta_{1},\ldots,\eta_{n_{1}}\}$ and $\{\g_{1},\ldots,\g_{n_{2}}\}$ be bases of $R_{1}$ and $R_{2}$ respectively. Then
      \[
        \disc_{R/K}(\eta_{1},\ldots,\eta_{n_{1}},\g_{1},\ldots,\g_{n_{2}}) = \disc_{R/K}(\eta_{1},\ldots,\eta_{n_{1}})\disc_{R}(\g_{1},\ldots,\g_{n_{2}}).
      \]
      In particular,
      \[
        \disc_{K}(R) = \disc_{K}(R_{1})\disc_{K}(R_{2}).
      \]
    \end{proposition}
    \begin{proof}
      The second statement follows immediately from the first. To prove the first statement, write
      \[
        \disc_{R/K}(\eta_{1},\ldots,\eta_{n_{1}}) = \det((\Trace_{R/K}(\eta_{i}\eta_{j}))_{i,j}) \quad \text{and} \quad \disc_{R}(\g_{1},\ldots,\g_{n_{2}}) = \det((\Trace_{R/K}(\g_{k}\g_{\ell}))_{k,\ell}).
      \]
      As $R$ is the direct sum of $R_{1}$ and $R_{2}$ as $K$-modules, we have $\eta_{i}\g_{k} = 0$ for all $1 \le i \le n_{1}$ and $1 \le k \le n_{2}$. It follows that $\disc_{R/K}(\eta_{1},\ldots,\eta_{n_{1}},\g_{1},\ldots,\g_{n_{2}})$ is the determinant of the block diagonal matrix
      \[
        \begin{pmatrix} (\Trace_{R/K}(\eta_{i}\eta_{j}))_{i,j} & \\ & (\Trace_{R/K}(\g_{k}\g_{\ell}))_{k,\ell} \end{pmatrix}.
      \]
      Moreover, we have
      \[
        \Trace_{R/K}(\rho_{1}) = \Trace_{R_{1}/K}(\rho_{1}) \quad \text{and} \quad \Trace_{R/K}(\rho_{2}) = \Trace_{R_{2}/K}(\rho_{2})
      \]
      for any $\rho_{1} \in R_{1}$ and $\rho_{2} \in R_{2}$. Indeed, multiplication by $\rho_{1}$ and $\rho_{2}$ annihilate $R_{2}$ and $R_{1}$ respectively. But then
      \[
        \begin{pmatrix} (\Trace_{R/K}(\eta_{i}\eta_{j}))_{i,j} & \\ & (\Trace_{R/K}(\g_{k}\g_{\ell}))_{k,\ell} \end{pmatrix} = \begin{pmatrix} (\Trace_{R_{1}/K}(\eta_{i}\eta_{j}))_{i,j} & \\ & (\Trace_{R_{2}/K}(\g_{k}\g_{\ell}))_{k,\ell} \end{pmatrix}.
      \]
      The determinant of the matrix on right-hand side is $\disc_{R/K}(\eta_{1},\ldots,\eta_{n_{1}})\disc_{R}(\g_{1},\ldots,\g_{n_{2}})$. This completes the proof.
    \end{proof}
    
    We now specialize to the setting of a degree $n$ separable extension $L/K$. It turns out that the discriminant is nonzero. To see this, we require a lemma:

    \begin{lemma}\label{lem:trace_is_nondegenerate}
      Let $L/K$ be a finite separable extension. Then the map
      \[
        \Trace_{L/K}:L \x L \to K \qquad (\l,\eta) \to \Trace_{L/K}(\l\eta),
      \]
      is a nondegenerate symmetric bilinear form.
    \end{lemma}
    \begin{proof}
      From the definition of the trace, it is clear that the map is a symmetric bilinear form. To see that is is nondegenerate, suppose $L/K$ is degree $n$. Then for any nonzero $\l \in L$, \cref{prop:formulas_for_trace_and_norm} implies that
      \[
        \Trace_{L/K}(\l\l^{-1}) = \Trace_{L/K}(1) = n.
      \]
      Hence the symmetric bilinear form is nondegenerate.
    \end{proof}

    We can now show that the discriminant is never zero:

    \begin{proposition}\label{prop:discriminant_not_zero}
      Let $L/K$ be a degree $n$ separable extension and let $\{\l_{1},\ldots,\l_{n}\}$ be a basis for $L$. Then we have that $\disc_{K}(\l_{1},\ldots,\l_{n}) \neq 0$. In particular, $\disc_{K}(L) \neq 0$.
    \end{proposition}
    \begin{proof}
      The second statement follows immediately from the first. To prove the first statement, suppose to the contrary that $\disc_{K}(\l_{1},\ldots,\l_{n}) = 0$. Then the matrix $(\Trace_{L/K}(\l_{i}\l_{j}))_{i,j}$ is not invertible. Hence there exists a nonzero column vector $(\k_{1},\ldots,\k_{n})^{t}$ with $\k_{i} \in K$ for $1 \le i \le n$ such that
      \[
        (\Trace_{L/K}(\l_{i}\l_{j}))_{i,j}(\k_{1},\ldots,\k_{n})^{t} = \mathbf{0}.
      \]
      This is equivalent to the $n$ equations
      \[
        \sum_{1 \le j \le n}\k_{j}\Trace_{L/K}(\l_{i}\l_{j}) = 0,
      \]
      for all $i$. Setting
      \[
        \l = \sum_{1 \le j \le n}\k_{j}\l_{j},
      \]
      linearity of the trace implies that these $n$ equations are equivalent to the fact that $\Trace_{L/K}(\l\l_{i}) = 0$ for all $i$. As $\{\l_{1},\ldots,\l_{n}\}$ is a basis for $L$, it follows that $\l \in L$ is a nonzero element for which $\Trace_{L/K}(\l\eta) = 0$ for all $\eta \in L$. This is impossible by \cref{lem:trace_is_nondegenerate}. Hence $\disc_{K}(\l_{1},\ldots,\l_{n}) \neq 0$.
    \end{proof}

    In addition to $\disc_{K}(\l_{1},\ldots,\l_{n})$ never vanishing, we can also write it in an alternative form. To do this, for any basis $\{\l_{1},\ldots,\l_{n}\}$ of $L$ we define the associated \textbf{embedding matrix}\index{embedding matrix} $M(\l_{1},\ldots,\l_{n})$ by
    \[
      M(\l_{1},\ldots,\l_{n}) = \begin{pmatrix} \s_{1}(\l_{1}) & \cdots & \s_{1}(\l_{n}) \\ \vdots & & \vdots \\ \s_{n}(\l_{1}) & \cdots & \s_{n}(\l_{n}) \end{pmatrix},
    \]
    where $\s_{1},\ldots,\s_{n}$ are the $n$ distinct $K$-embeddings of $L$ into $\conj{K}$. Then we have the following result:

    \begin{proposition}\label{disc_as_square_of_embedding_matrix}
      Let $L/K$ be a degree $n$ separable extension. Then for any basis $\{\l_{1},\ldots,\l_{n}\}$ of $L$, we have
      \[
        \disc_{K}(\l_{1},\ldots,\l_{n}) = \det(M(\l_{1},\ldots,\l_{n}))^{2}.
      \]
    \end{proposition}
    \begin{proof}
      Recalling that the $(i,j)$-entry of $M(\l_{1},\ldots,\l_{n})^{t}M(\l_{1},\ldots,\l_{n})$ is the dot product of the $i$-th and $j$-th columns of $M(\l_{1},\ldots,\l_{n})$, we have
    \begin{align*}
      \det(M(\l_{1},\ldots,\l_{n}))^{2} &= \det(M(\l_{1},\ldots,\l_{n})^{t}M(\l{1},\ldots,\l_{n})) \\
      &= \det\left(\left(\sum_{\s}\s(\l_{i})\s(\l_{j})\right)_{i,j}\right) \\
      &= \det\left(\left(\sum_{\s}\s(\l_{i}\l_{j})\right)_{i,j}\right) \\
      &= \det((\Trace_{L/K}(\l_{i}\l_{j}))_{i,j}) \\
      &= \disc_{L/K}(\l_{1},\ldots,\l_{n}),
    \end{align*}
    where the sums run over all $K$-embeddings $\s$ of $L$ into $\conj{K}$ and the second to last equality follows by \cref{prop:formulas_for_trace_and_norm}, as desired.
    \end{proof}

    In the specialized case $K/\Q$ for a number field $K$, we define the \textbf{discriminant}\index{discriminant} $\D_{K}$ of $K$ by
    \[
      \D_{K} = \disc_{K}(\a_{1},\ldots,\a_{n}),
    \]
    for any integral basis $\{\a_{1},\ldots,\a_{n}\}$. As $\D_{K}$ is not defined modulo $(K^{\ast})^{2}$, we need to show that $\D_{K}$ is independent of the choice of integral basis and hence well-defined. Indeed, if $\{\a'_{1},\ldots,\a'_{n}\}$ is another integral basis then the base change matrix, as well as its inverse, both have integer entries (because integral bases are bases for $\mc{O}_{K}$ as a $\Z$-module). This implies that the determinant of the base change matrix is $\pm 1$ and so \cref{equ:discriminant_base_change} shows that $\D_{K}$ is independent of the choice of integral basis. Moreover, $\D_{K}$ is nonzero by \cref{prop:discriminant_not_zero} and
    \[
      \D_{K} = \det(M(\a_{1},\ldots,\a_{n}))^{2},
    \]
    by \cref{disc_as_square_of_embedding_matrix}.
  \section{Integral \& Fractional Ideals}
    For the number field $\Q$, its ring of integers $\Z$ is a unique factorization domain. Indeed, this is just a restatement of the fundamental theorem of arithmetic. Unfortunately, for a general number field $K$ its ring of integers $\mc{O}_{K}$ need not be a unique factorization domain. However, the integral ideals of $\mc{O}_{K}$ do factor into a unique product of prime integral ideals (this is trivial for a unique factorization domain). Our main goal is to prove this. We first introduce some notation. Any nonzero ideal $\mf{a}$ of $\mc{O}_{K}$ is said to be an \textbf{integral ideal}\index{integral ideal} of $K$. As $\mc{O}_{K}$ is a free abelian group of rank $n$ by \cref{thm:ring_of_integers_finitely_generated}, any subgroup is also free abelian. Since $\a\mc{O}_{K} \subseteq \mf{a}$ for any nonzero $\a \in \mf{a}$, it follows that $\mf{a}$ is also a free abelian group of rank $n$ as well. We first show that the quotient ring by an integral ideal is finite:

    \begin{proposition}\label{prop:residue_of_integral_ideal_is_finite}
      Let $K$ be a number field. Then $\mc{O}_{K}/\mf{a}$ is finite for any integral ideal $\mf{a}$. In particular, for any $\a \in \mc{O}_{K}$ we have
      \[
        |\mc{O}_{K}/\a\mc{O}_{K}| = |\Norm(\a)|.
      \]
    \end{proposition}
    \begin{proof}
      Since $\mf{a}$ and $\mc{O}_{K}$ are both free abelian groups of rank $n$ (recall \cref{thm:ring_of_integers_finitely_generated}) and $\mf{a}$ is a subgroup, the first statement follows by \cref{prop:base_change_quotient_determinant}. For the second statement, let $\{\a_{1},\ldots,\a_{n}\}$ be an integral basis for $K$. Writing
      \[
        \a = \sum_{1 \le i \le n}a_{i}\a_{i},
      \]
      with $a_{i} \in \Z$, we see that $\{a_{1}\a_{1},\ldots,a_{n}\a_{n}\}$ is a basis for $\a\mc{O}_{K}$. In particular, the base change matrix from $\{\a_{1},\ldots,\a_{n}\}$  to this basis is the diagonal with the $a_{i}$ on the diagonal. Then on the one hand, we have $|\mc{O}_{K}/\a\mc{O}_{K}| = |a_{1} \cdots a_{n}|$ by \cref{prop:base_change_quotient_determinant} again. On the other hand, in terms of the basis $\{a_{1}\a_{1},\ldots,a_{n}\a_{n}\}$ the map $T_{\a}$ is given by
      \[
        T_{\a} = \begin{pmatrix} a_{1} & & \\ & \ddots & \\ & & a_{n} \end{pmatrix},
      \]
      and so $\Norm(\a) = a_{1} \cdots a_{n}$. Hence
      \[
        |\mc{O}_{K}/\a\mc{O}_{K}| = |\Norm(\a)|,
      \]
      as desired.
    \end{proof}

    For an integral ideal $\mf{a}$, we define its \textbf{norm}\index{norm} $\Norm(\mf{a})$ by
    \[
      \Norm(\mf{a}) = |\mc{O}_{K}/\mf{a}|.
    \]
    We also define the norm of the zero ideal to be zero. Then by \cref{prop:residue_of_integral_ideal_is_finite}, the norm of any integral ideal is finite, necessarily a positive integer, and for every $\a \in \mc{O}_{K}$ we have
    \[
      \Norm(\a\mc{O}_{K}) = |\Norm(\a)|.
    \]
    Moreover, Lagrange's theorem implies that $\Norm(\mf{a}) \in \mf{a}$ for any integral ideal $\mf{a}$. We can now show that every prime integral ideal is maximal:

    \begin{proposition}\label{prop:prime_integral_ideals_are_maximal}
      Let $K$ be a number field. Every prime integral ideal $\mf{p}$ in $\mc{O}_{K}$ is maximal.
    \end{proposition}
    \begin{proof}
      Recall that an ideal is maximal if and only if the quotient ring is a field. Therefore it suffices to show that $\mc{O}_{K}/\mf{p}$ is a field. Let $\a \in \mc{O}_{K}/\mf{p}$ be nonzero. We will show that $\a$ is invertible in $\mc{O}_{K}/\mf{p}$. Since $\mf{p}$ is maximal, $\mc{O}_{K}/\mf{p}$ is an integral domain. Therefore the multiplication map
      \[
        \mc{O}_{K}/\mf{p} \to \mc{O}_{K}/\mf{p} \qquad x \mapsto \a x,
      \]
      is injective. By \cref{prop:residue_of_integral_ideal_is_finite}, $\mc{O}_{K}/\mf{p}$ is finite and therefore this map must be a bijection. But this means that $\a$ has an inverse in $\mc{O}_{K}/\mf{p}$. Hence $\mc{O}_{K}/\mf{p}$ is a field.
    \end{proof}

    As prime integral ideals are maximal by \cref{prop:prime_integral_ideals_are_maximal} and distinct maximal ideals are relatively prime, we see that distinct prime integral ideals $\mf{p}$ and $\mf{q}$ are relatively prime. In particular, their powers are relatively prime as well (which follows by induction). We will now being working to show that every integral ideal factors uniquely into a product of prime integral ideals. First we show containment in one direction:

    \begin{lemma}\label{lem:integral_ideal_prime_containment}
      Let $K$ be a number field. For every integral ideal $\mf{a}$, there exist prime integral ideals $\mf{p}_{1},\ldots,\mf{p}_{k}$ such that
      \[
        \mf{p}_{1}\cdots\mf{p}_{k} \subseteq \mf{a}.
      \]
    \end{lemma}
    \begin{proof}
      Let $\mc{S}$ be the set of integral ideals which do not contain a product of prime integral. Then it suffices to show $\mc{S}$ is empty. Assume otherwise so that there is an integral ideal $\mf{a} \in \mc{S}$. Then $\mf{a}$ cannot be prime for otherwise $\mf{a}$ contains a product of prime integral ideals (namely itself). Since $\mf{a}$ is not prime, there exist $\a_{1},\a_{2} \in \mc{O}_{K}$ with $\a_{1}\a_{2} \in \mf{a}$ and such that $\a_{1},\a_{2} \notin \mf{a}$. Now define integral ideals
      \[
        \mf{b}_{1} = \mf{a}+\a_{1}\mc{O}_{K} \quad \text{and} \quad \mf{b}_{2} = \mf{a}+\a_{2}\mc{O}_{K}.
      \]
      Note that $\mf{b}_{1}$ and $\mf{b}_{2}$ strictly contain $\mf{a}$ because $\a_{1},\a_{2} \notin \mf{a}$. Moreover, $\mf{b}_{1}\mf{b}_{2} \subseteq \mf{a}$ because
      \[
        \mf{b}_{1}\mf{b}_{2} = (\mf{a}+\a_{1}\mc{O}_{K})(\mf{a}+\a_{2}\mc{O}_{K}) = \mf{a}^{2}+\a_{1}\mc{O}_{K}+\a_{2}\mc{O}_{K}+\a_{1}\a_{2}\mc{O}_{K},
      \]
      and $\a_{1}\a_{2} \in \mf{a}$. We now show that either $\mf{b}_{1}$ or $\mf{b}_{2}$ belongs to $\mc{S}$. Suppose otherwise. Then there exist prime integral ideals $\mf{p}_{1},\ldots,\mf{p}_{k}$ and $\mf{q}_{1},\ldots,\mf{q}_{\ell}$ such that
      \[
        \mf{p}_{1}\cdots\mf{p}_{k} \subseteq \mf{b}_{1} \quad \text{and} \quad \mf{q}_{1}\cdots\mf{q}_{\ell} \subseteq \mf{b}_{2}.
      \]
      But then
      \[
        \mf{p}_{1}\cdots\mf{p}_{k}\mf{q}_{1}\cdots\mf{q}_{\ell} \subseteq \b_{1}\b_{2} \subseteq \mf{a},
      \]
      which contradicts the fact that $\mf{a}$ is in $\mc{S}$. Hence $\mf{b}_{1}$ or $\mf{b}_{2}$ belongs to $\mc{S}$. In total, we have shown that if $\mf{a} \in \mc{S}$, then there exists an integral ideal $\mf{a}_{1} \in \mc{S}$ strictly larger than $\mf{a}$. Thus we obtain a strictly increasing infinite sequence of integral ideals in $\mc{S}$:
      \[
        \mf{a} \subset \mf{a}_{1} \subset \mf{a}_{2} \subset \cdots.
      \]
      Taking the norm, we obtain a strictly decreasing sequence of positive integers:
      \[
        \Norm(\mf{a}) > \Norm(\mf{a}_{1}) > \Norm(\mf{a}_{2}) > \cdots.
      \]
      This is impossible since the norm of an integral ideal is a positive integer. Hence $\mc{S}$ is empty and the claim follows.
    \end{proof}

    In order to obtain the reverse containment in \cref{lem:integral_ideal_prime_containment}, we need to do more work. Precisely, we want to show that every integral ideal factors into a product of prime integral ideals. To accomplish this, we will construct a group containing the ideals. Unfortunately, ideals are not invertible and so we need to work in a slightly more general setting. First observe that an integral ideal $\mf{a}$ is just an $\mc{O}_{K}$-submodule of $\mc{O}_{K}$. Moreover, it is a finitely generated $\mc{O}_{K}$-submodule of $K$ by \cref{thm:ring_of_integers_finitely_generated}. We say $\mf{f}$ is a \textbf{fractional ideal}\index{fractional ideal} of $K$ if $\mf{f}$ a nonzero finitely generated $\mc{O}_{K}$-submodule of $K$. In particular, all integral ideals are fractional ideals. Now let $\k_{1},\ldots,\k_{r} \in K$ be generators for the fractional ideal $\mf{f}$. Since $K$ is the field of fractions of $\mc{O}_{K}$ by \cref{prop:field_of_fractions_of_ring_of_integers}, $\k_{i} = \frac{\a_{i}}{\d_{i}}$ with $\a_{i},\d_{i} \in \mc{O}_{K}$ and where $\d_{i}$ is nonzero for $1 \le i \le r$. Setting $\d = \d_{1} \cdots \d_{r}$, we have that $\d\k_{i} \in \mc{O}_{K}$ for all $i$ and hence $\d\mf{f}$ is an integral ideal. Conversely, if there exists some nonzero $\d \in \mc{O}_{K}$ such that $\d\mf{f}$ is an integral ideal then $\mf{f}$ is a fractional ideal because $\mf{a}$ is a finitely generated $\mc{O}_{K}$-submodule of $K$ and hence $\mf{f}$ is too. Thus for any fractional ideal $\mf{f}$, there exists a nonzero $\d \in \mc{O}_{K}$ and an integral ideal $\mf{a}$ such that
    \[
      \mf{f} = \frac{1}{\d}\mf{a}.
    \]
    Every fractional ideal is of this form and integral ideals are precisely those for which $\d = 1$. In particular, since $\mf{a}$ is a free abelian group of rank $n$, we see that $\mf{f}$ is a free abelian group of rank $n$ as well. However, $\mf{f}$ is not necessarily a subgroup of $\mc{O}_{K}$. Now let $\mf{p}$ be a prime integral ideal. We define $\mf{p}^{-1}$ by
    \[
      \mf{p}^{-1} = \{\k \in K:\k\mf{p} \subseteq \mc{O}_{K}\}.
    \]
    It turns out that $\mf{p}^{-1}$ is a fractional ideal. Indeed, since $\mf{p}$ is an integral ideal there exists a nonzero $\a \in \mf{p}$. By definition of $\mf{p}^{-1}$, we have that $\a\mf{p}^{-1} \subseteq \mc{O}_{K}$. Hence $\a\mf{p}^{-1}$ is an integral ideal and therefore $\mf{p}^{-1}$ is a fractional ideal. Unlike integral ideals, $1 \in \mf{p}^{-1}$ so that $\mf{p}^{-1}$ contains units. The following proposition proves a stronger version of this and more:

    \begin{lemma}\label{lem:inverse_for_prime_ideals}
      Let $K$ be a number field and $\mf{p}$ be a prime integral ideal. Then the following hold:
      \begin{enumerate}[label=(\roman*)]
        \item
        \[
          \mc{O}_{K} \subset \mf{p}^{-1}.
        \]
        \item
        \[
          \mf{p}^{-1}\mf{p} = \mc{O}_{K}.
        \]
      \end{enumerate}
    \end{lemma}
    \begin{proof}
      We will prove the latter two statement separately:
      \begin{enumerate}[label=(\roman*)]
        \item Clearly $\mc{O}_{K} \subseteq \mf{p}^{-1}$ so it suffices to show that $\mf{p}^{-1}$ contains a nonzero element which is not an algebraic integer. Again, let $\a \in \mf{p}$ be nonzero. By \cref{lem:integral_ideal_prime_containment} let $k \ge 1$ be the minimal integer such that there exist prime integral ideals $\mf{p}_{1},\ldots,\mf{p}_{k}$ with
        \[
          \mf{p}_{1} \cdots \mf{p}_{k} \subseteq \a\mc{O}_{K}.
        \]
        As $\a \in \mf{p}$, we have $\a\mc{O}_{K} \subseteq \mf{p}$. Since $\mf{p}$ is prime, there must be some $i$ with $1 \le i \le k$ such that $\mf{p}_{i} \subseteq \mf{p}$. Without loss of generality, we may assume $\mf{p}_{1} \subseteq \mf{p}$. But by \cref{prop:prime_integral_ideals_are_maximal} prime integral ideals are maximal and thus $\mf{p}_{1} = \mf{p}$. Moreover, since $k$ is minimal we must have
        \[
          \mf{p}_{2} \cdots \mf{p}_{k} \not\subseteq \a\mc{O}_{K}.
        \]
        Hence there exists a nonzero $\b \in \mf{p}_{2} \cdots \mf{p}_{k}$ with $\b \notin \a\mc{O}_{K}$. We will now show that $\b\a^{-1}$ is a nonzero element in $\mf{p}^{-1}$ that is not an algebraic integer. Clearly $\b\a^{-1}$ is nonzero. Since $\mf{p}_{1} = \mf{p}$, what we have previously shown implies $\b\mf{p} \subseteq \a\mc{O}_{K}$ and hence $\b\a^{-1}\mf{p} \in \mc{O}_{K}$ which means $\b\a^{-1} \in \mf{p}^{-1}$. But as $\b \notin \a\mc{O}_{K}$, we also have $\b\a^{-1} \notin \mc{O}_{K}$ so that $\b\a^{-1}$ is not an algebraic integer. This proves (i).
        \item By (i) and the definition of $\mf{p}^{-1}$, we have $\mf{p} \subseteq \mf{p}^{-1}\mf{p} \subseteq \mc{O}$. Since $\mf{p}$ is maximal by \cref{prop:prime_integral_ideals_are_maximal}, it follows that $\mf{p}^{-1}\mf{p}$ is either $\mf{p}$ or $\mc{O}_{K}$. So it suffices to show that the first case cannot hold. Assume by contradiction that $\mf{p}^{-1}\mf{p} = \mf{p}$. Let $\{\w_{1},\ldots,\w_{r}\}$ be a set of generators for $\mf{p}$ and let $\a \in \mf{p}^{-1}$ be a nonzero element that is not an algebraic integer which exists by (i). Then $\a\w_{i} \in \mf{p}^{-1}\mf{p}$ for $1 \le i \le r$ and hence $\a\mf{p} \subseteq \mf{p}^{-1}\mf{p}$. By our assumption, this further implies that $\a\mf{p} \subseteq \mf{p}$. But then
        \[
          \a\w_{i} = \sum_{1 \le j \le r}\a_{i,j}\w_{j},
        \]
        with $\a_{i,j} \in \mc{O}_{K}$ for $1 \le i,j \le r$. We can rewrite this as,
        \[
          (\a-\a_{i,i})\w_{i}-\sum_{\substack{1 \le j \le r \\ j \neq i}}\a_{i,j}\w_{j} = 0,
        \]
        for all $i$. These $r$ equations are equivalent to the identity
        \[
          \begin{pmatrix} \a-\a_{1,1} & \a_{1,2} & \cdots & -\a_{1,r} \\ -\a_{2,1} & \a-\a_{2,2} & & \\ \vdots & & \ddots & \\ -\a_{r,1} & & & \a-\a_{r,r} \end{pmatrix}\begin{pmatrix} \w_{1} \\ \w_{2} \\ \vdots \\ \w_{r} \end{pmatrix} = \mathbf{0}.
        \]
        Thus the determinant of the matrix on the left-hand side must be zero. But this means $\a$ is a root of the characteristic polynomial $\det(xI-(\a_{i,j}))$ which is a monic polynomial with coefficients $\mc{O}_{K}$. By \cref{ring_of_integers_algebraically_closed}, $\a$ is an algebraic integer which is a contradiction. Thus $\mf{p}^{-1}\mf{p} = \mc{O}_{K}$.
      \end{enumerate}
    \end{proof}

    Let $I_{K}$ denote the collection of fractional ideals of $K$. We call $I_{K}$ the \textbf{ideal group}\index{ideal group} of $K$. The following theorem shows that $I_{K}$ is indeed a group:

    \begin{theorem}
      Let $K$ be a number field. Then $I_{K}$ is an abelian group with identity $\mc{O}_{K}$.
    \end{theorem}
    \begin{proof}
      Since fractional ideals are finitely generated $\mc{O}_{K}$-submodules of $K$, the product of fractional ideals is a fractional ideal. It is also clear that $I_{K}$ is abelian if it is a group. Moreover, $\mc{O}_{K}$ is the identity since every every fractional ideal is a finitely generated $\mc{O}_{K}$-submodule of $K$. It now suffices to show that every fractional ideal $\mf{f}$ has an inverse in $I_{K}$. By \cref{lem:inverse_for_prime_ideals} (ii), the prime integral ideal $\mf{p}$ has inverse $\mf{p}^{-1}$. We now show that any integral ideal that is not prime has an inverse. Suppose by contradiction that $\mf{a}$ is such an integral ideal with $N(\mf{a})$ minimal. By \cref{prop:prime_integral_ideals_are_maximal}, there exists a prime integral ideal $\mf{p}$ such that $\mf{a} \subset \mf{p}$. This fact together with \cref{lem:inverse_for_prime_ideals} (i) implies that
      \[
        \mf{a} \subseteq \mf{p}^{-1}\mf{a} \subseteq \mf{p}^{-1}\mf{p} = \mc{O}_{K}.
      \]
      We now claim $\mf{a} \subset \mf{p}^{-1}\mf{a}$. If not, $\mf{a} = \mf{p}^{-1}\mf{a}$. Let $\{\w_{1},\ldots,\w_{r}\}$ be a set of generators for $\mf{a}$. By \cref{lem:inverse_for_prime_ideals}, let $\a \in \mf{p}^{-1}$ be a nonzero element that is not an algebraic integer. Then $\a\w_{i} \in \mf{p}^{-1}\mf{a}$ for $1 \le i \le r$ and hence $\a\mf{a} \subseteq \mf{p}^{-1}\mf{a}$. By our assumption, this further implies that $\a\mf{p} \subseteq \mf{a}$. But then
      \[
        \a\w_{i} = \sum_{1 \le j \le r}\a_{i,j}\w_{j},
      \]
      with $\a_{i,j} \in \mc{O}_{K}$ for $1 \le i,j \le r$. We can rewrite this as,
      \[
        (\a-\a_{i,i})\w_{i}-\sum_{\substack{1 \le j \le r \\ j \neq i}}\a_{i,j}\w_{j} = 0,
      \]
      for all $i$. These $r$ equations are equivalent to the identity
      \[
        \begin{pmatrix} \a-\a_{1,1} & \a_{1,2} & \cdots & -\a_{1,r} \\ -\a_{2,1} & \a-\a_{2,2} & & \\ \vdots & & \ddots & \\ -\a_{r,1} & & & \a-\a_{r,r} \end{pmatrix}\begin{pmatrix} \w_{1} \\ \w_{2} \\ \vdots \\ \w_{r} \end{pmatrix} = \mathbf{0}.
      \]
      Thus the determinant of the matrix on the left-hand side must be zero. But this means $\a$ is a root of the characteristic polynomial $\det(xI-(\a_{i,j}))$ which is a monic polynomial with coefficients $\mc{O}_{K}$. By \cref{ring_of_integers_algebraically_closed}, $\a$ is an algebraic integer which is a contradiction. Thus $\mf{a} \subset \mf{p}^{-1}\mf{a}$. But then $\Norm(\mf{p}^{-1}\mf{a}) < \Norm(\mf{a})$ and by the minimality of $\Norm(\mf{a})$ it follows that the fractional ideal $\mf{p}^{-1}\mf{a}$ is invertible. Let $\mf{b}$ be its inverse. Then $\mf{b}\mf{p}^{-1}\mf{a} = \mc{O}_{K}$ and thus $\mf{a}$ is invertible with inverse $\mf{b}\mf{p}^{-1}$. This is a contradiction, so we conclude that every integral ideal is invertible. We now show that every fractional ideal $\mf{f}$ is invertible. Since $\mf{f}$ is a fractional ideal, there exists a nonzero $\d \in \mc{O}_{K}$ and an integral ideal $\mf{a}$ such that
      \[
        \mf{f} = \frac{1}{\d}\mf{a}.
      \]
      As $\mf{a}$ is invertible, $\d\mf{a}^{-1}$ is the inverse of $\mf{f}$. This completes the proof.
    \end{proof}

    We can also deduce the explicit form for the inverse of any fractional ideal:

    \begin{proposition}\label{prop:explicit_inverse_ideal}
      Let $K$ be a number field and let $\mf{f}$ be a fractional ideal. Then
      \[
        \mf{f}^{-1} = \{\k \in K:\k\mf{f} \subseteq \mc{O}_{K}\}.
      \]
      In particular, $\mc{O}_{K} \subseteq \mf{f}$ if and only if $\mf{f}^{-1}$ is an integral ideal.
    \end{proposition}
    \begin{proof}
      Since $\mf{f}\mf{f}^{-1} = \mc{O}_{K}$, we have
      \[
        \{\k \in K:\k\mf{f} \subseteq \mc{O}_{K}\} = \{\k \in K:\k\mc{O}_{K} \subseteq \mf{f}^{-1}\} = \mf{f}^{-1}.
      \]
      This proves the first statement. For the second statement, if $\mc{O}_{K} \subseteq \mf{f}$ then multiplying by $\mf{f}^{-1}$ shows $\mf{f}^{-1} \subseteq \mc{O}_{K}$ and hence $\mf{f}^{-1}$ is an integral ideal. Running this argument backwards by multiplying by $\mf{f}$ proves the converse.
    \end{proof}

    Now that we have proved that the ideal group $I_{K}$ of $K$ is indeed a group, we can shown that every integral ideal factors uniquely into a product of prime integral ideals (up to reordering of the factors):

    \begin{theorem}\label{thm:unique_product_prime_ideals}
      Let $K$ be a number field. Then for every integral ideal $\mf{a}$ there exist prime integral ideals $\mf{p}_{1},\ldots,\mf{p}_{k}$ such that $\mf{a}$ factors as
      \[
        \mf{a} = \mf{p}_{1} \cdots \mf{p}_{k}.
      \]
      Moreover, this factorization is unique up to reordering of the factors.
    \end{theorem}
    \begin{proof}
      We first prove existence and then uniqueness. For existence, suppose to the contrary that $\mf{a}$ is an integral ideal that does not factor into a product of prime integral ideals and $\mf{a}$ is maximal among all such integral ideals. Necessarily $\mf{a}$ is not prime and by \cref{prop:prime_integral_ideals_are_maximal} there is some prime integral idea $\mf{p}_{1}$ for which $\mf{a} \subset \mf{p}_{1}$. Then by \cref{lem:inverse_for_prime_ideals} (ii), we have $\mf{p}_{1}^{-1}\mf{a} \subset \mc{O}_{K}$ so that $\mf{p}_{1}^{-1}\mf{a}$ is also an integral ideal. Also, \cref{lem:inverse_for_prime_ideals} (i) implies $\mf{a} \subseteq \mf{a}\mf{p}_{1}^{-1}$. Actually, $\mf{a} \subset \mf{a}\mf{p}_{1}^{-1}$ for otherwise $\mf{a} = \mf{a}\mf{p}_{1}^{-1}$ and hence $\mf{p}_{1}^{-1} = {O}_{K}$ which is impossible because $\mf{p}_{1}$ is proper. By maximality, $\mf{a}\mf{p}_{1}^{-1}$ factors into a product of prime integral ideals. That is, there exist prime integral ideals $\mf{p}_{2},\ldots,\mf{p}_{k}$ such that
      \[
        \mf{a}\mf{p}_{1}^{-1} = \mf{p}_{2},\ldots,\mf{p}_{k}.
      \]
      Hence
      \[
        \mf{a} = \mf{p}_{1},\ldots,\mf{p}_{k},
      \]
      so that $\mf{a}$ factors into a product of prime integral ideals which is a contradiction. This proves existence of such a factorization. Now we prove uniqueness. Suppose that $\mf{a}$ admits factorizations
      \[
        \mf{a} = \mf{p}_{1},\ldots,\mf{p}_{k} \quad \text{and} \quad \mf{a} = \mf{q}_{1},\ldots,\mf{q}_{\ell},
      \]
      for prime integral ideals $\mf{p}_{i}$ and $\mf{q}_{j}$ with $1 \le i \le k$ and $1 \le j \le \ell$. Since $\mf{p}_{1}$ is prime, there is some $j$ for which $\mf{q}_{j} \subseteq \mf{p}_{1}$. Without loss of generality, we may assume $\mf{q}_{1} \subseteq \mf{p}_{1}$ and \cref{prop:prime_integral_ideals_are_maximal} we have that $\mf{q}_{1} = \mf{p}_{1}$. Then
      \[
        \mf{p}_{2},\ldots,\mf{p}_{k} = \mf{q}_{2},\ldots,\mf{q}_{\ell}.
      \]
      Repeating this process, we see that $k = \ell$ and $\mf{q}_{i} = \mf{p}_{i}$ for all $i$. This proves uniqueness of the factorization.
    \end{proof}

    By \cref{thm:unique_product_prime_ideals}, for any integral ideal $\mf{a}$ there exist distinct prime integral ideal $\mf{p}_{1},\ldots,\mf{p}_{r}$ such that $\mf{a}$ admits a factorization
    \[
      \mf{a} = \mf{p}_{1}^{e_{1}} \cdots \mf{p}_{r}^{e_{r}},
    \]
    with $e_{i} \ge 1$ for all $i$, called the \textbf{prime factorization}\index{prime factorization} of $\mf{a}$ with \textbf{prime factors}\index{prime factors} $\mf{p}_{1},\ldots,\mf{p}_{r}$. Just as it is common to suppress the fundamental theorem of arithmetic and just state the prime factorization of an integer, we suppress \cref{thm:unique_product_prime_ideals} and state the prime factorization of an integral ideal. Also, as a near immediate corollary of \cref{thm:unique_product_prime_ideals}, all fractional ideal admits a factorization into a product of prime integral ideals and their inverses (up to reordering of the factors):

    \begin{corollary}\label{cor:fractional_ideal_prime_factorization}
      Let $K$ be a number field. Then for every fractional ideal $\mf{f}$ there exist prime integral ideals $\mf{p}_{1},\ldots,\mf{p}_{k}$ and $\mf{q}_{1},\ldots,\mf{q}_{\ell}$ such that $\mf{f}$ factors as
      \[
        \mf{f} = \mf{p}_{1} \cdots \mf{p}_{k}\mf{q}_{1}^{-1},\ldots,\mf{q}_{\ell}^{-1}.
      \]
      Moreover, this factorization is unique up to reordering of the factors.
    \end{corollary}
    \begin{proof}
      If $\mf{f}$ is a fractional ideal, then there exists a nonzero $\d \in \mc{O}_{K}$ and an integral ideal $\mf{a}$ such that
      \[
        \mf{f} = \frac{1}{\d}\mf{a}.
      \]
      In particular, $\mf{a}$ and $\d\mc{O}_{K}$ are integral ideals such that $\d\mc{O}_{K}\mf{f} = \mf{a}$. By \cref{thm:unique_product_prime_ideals}, $\mf{a}$ and $\d\mc{O}_{K}$ admit unique factorizations
      \[
        \mf{a} = \mf{p}_{1} \cdots \mf{p}_{k} \quad \text{and} \quad \d\mc{O}_{K} = \mf{q}_{1},\ldots,\mf{q}_{\ell},
      \]
      up to reordering of the factors. Hence
      \[
        \mf{q}_{1},\ldots,\mf{q}_{\ell}\mf{f} = \mf{p}_{1} \cdots \mf{p}_{k},
      \]
      which is equivalent to the factorization for $\mf{f}$.
    \end{proof}

    We will now discuss applications of the Chinese remainder theorem in the context of integral ideals. With it we can prove some interesting results. Suppose $\mf{a}$ is an integral ideal with prime factorization
    \[
      \mf{a} = \mf{p}_{1}^{e_{1}} \cdots \mf{p}_{r}^{e_{r}}.
    \]
    Then the integral ideals $\mf{p}_{1}^{e_{1}},\ldots,\mf{p}_{r}^{e_{r}}$ are pairwise relatively prime so that the Chinese remainder theorem gives an isomorphism
    \[
      \mc{O}_{K}/\mf{a} \cong \bigop_{1 \le i \le r}\mc{O}_{K}/\mf{p}_{i}^{e_{i}}.
    \]
    In particular, for any $\a_{i} \in \mc{O}_{K}$ for all $i$, there exists a unique $\a \in \mc{O}_{K}$ such that
    \[
      \a \equiv \a_{i} \pmod{\mf{p}_{i}^{e_{i}}},
    \]
    for all $i$. We can now show that any fractional ideal is generated by at most two elements:

    \begin{corollary}\label{cor:fractional_ideal_generated_by_two_elements}
      Let $K$ be a number field. Then any fractional ideal $\mf{f}$ is generated by at most two elements.
    \end{corollary}
    \begin{proof}
      We first prove the claim for an integral ideal $\mf{a}$. Let $\a \in \mf{a}$ be nonzero and let $\mf{p}_{1},\ldots,\mf{p}_{r}$ be the prime factors of $\a\mc{O}_{K}$. As $\a\mc{O}_{K} \subseteq \mf{a}$, the prime factorization of $\mf{a}$ is
      \[
        \mf{a} = \mf{p}_{1}^{e_{1}} \cdots \mf{p}_{r}^{e_{r}},
      \]
      with $e_{i} \ge 0$ for $1 \le i \le r$. By uniqueness of the prime factorization of integral ideals, $\mf{p}_{i}^{e_{i}+1} \subset \mf{p}_{i}^{e_{i}}$ for all $i$. Thus there exist nonzero $\b_{i} \in \mf{p}_{i}^{e_{i}}-\mf{p}_{i}^{e_{i}+1}$ for all $i$. Since $\mf{p}_{1}^{e_{1}+1},\ldots,\mf{p}_{r}^{e_{r}+1}$ are pairwise relatively prime, the Chinese remainder theorem implies that there exists $\b \in \mc{O}_{K}$ with 
      \[
        b \equiv \b_{i} \tmod{\mf{p}_{i}^{e_{i}+1}},
      \]
      for all $i$. As $\b_{i} \in \mf{p}_{i}^{e_{i}}$ for all $i$, we have $\b \in \mf{a}$ and hence $\b\mc{O}_{K} \subseteq \mf{a}$. But as $\b \notin \mf{p}_{i}^{e_{i}+1}$ for all $i$, we see that $\b\mc{O}_{K}\mf{a}^{-1}$ is necessarily an integral ideal relatively prime to $\a\mc{O}_{K}$. This means
      \[
        \b\mc{O}_{K}\mf{a}^{-1}+\a\mc{O}_{K} = \mc{O}_{K},
      \]
      and hence
      \[
        \b\mc{O}_{K}+\a\mf{a} = \mf{a}.
      \]
      But as $\a,\b \in \mf{a}$, we have $\b\mc{O}_{K}+\a\mf{a} \subseteq \b\mc{O}_{K}+\a\mc{O}_{K} \subseteq \mf{a}$ and so
      \[
        \b\mc{O}_{K}+\a\mc{O}_{K} = \mf{a}.
      \]
      This shows that $\mf{a}$ is generated by at most two elements. Now suppose $\mf{f}$ is a fractional ideal. Then there exists a nonzero $\d \in \mc{O}_{K}$ and an integral ideal $\mf{a}$ such that
      \[
        \mf{f} = \frac{1}{\d}\mf{a}.
      \]
      Since $\mf{a}$ is generated by at most two elements, say $\a$ and $\b$, we have
      \[
        \mf{f} = \frac{\a}{\d}\mc{O}_{K}+\frac{\b}{\d}\mc{O}_{K},
      \]
      and so $\mf{f}$ is also generated by at most two elements as well.
    \end{proof}

    \cref{cor:fractional_ideal_generated_by_two_elements} shows that while the ring of integers $\mc{O}_{K}$ of $K$ may not be a principal ideal domain, it is not far off from one since we every integral ideal needs at most two generators. We will give a more refined interpretation of this when discussing quotients of the ideal group $I_{K}$. For now, we deduce some more properties of the norm of integral ideals and extend this notion to fractional ideals as well. We will need a useful proposition:

    \begin{proposition}\label{prop:isomorphism_of_quotient_by_prime_integral_ideals}
      Let $K$ be a number field. Then for any prime integral ideal $\mf{p}$ and $n \ge 0$, we have an isomorphism
      \[
        \mc{O}_{K}/\mf{p} \cong \mf{p}^{n}/\mf{p}^{n+1},
      \]
      as $\mc{O}_{K}$-modules.
    \end{proposition}
    \begin{proof}
      By the uniqueness of the factorization of integral ideals, there exists $\b \in \mf{p}^{n}-\mf{p}^{n+1}$. Now consider the homomorphism
      \[
        \phi:\mc{O}_{K} \to \mf{p}^{n}/\mf{p}^{n+1} \qquad \a \to \a\b \pmod{\mf{p}^{n+1}}.
      \]
      By the first isomorphism theorem, it suffices to show $\ker\phi = \mf{p}$ and that $\phi$ is surjective. Let us first show $\ker\phi = \mf{p}$. As $\b \in \mf{p}^{n}$, it is obvious that $\mf{p} \subseteq \ker\phi$. Conversely, suppose $\a \in \mc{O}_{K}$ is such that $\phi(\a) = 0$. Then $\a\b \in \mf{p}^{n+1}$, and as $\b \in \mf{p}^{n}-\mf{p}^{n+1}$ we must have $\a \in \mf{p}$. It follows that $\ker\phi = \mf{p}$. We now show that $\phi$ is surjective. Let $\g \in \mf{p}^{n}$ be a representative of a class in $\mf{p}^{n}/\mf{p}^{n+1}$. As $\b \in \mf{p}^{n}$, we have $\b\mc{O}_{K} \subseteq \mf{p}^{n}$. But since $\b \notin \mf{p}^{n+1}$, we see that $\b\mc{O}_{K}\mf{p}^{-n}$ is necessarily an integral ideal relatively prime to $\mf{p}^{n+1}$. As $\mf{p}^{n+1}$ and $\b\mc{O}_{K}\mf{p}^{-n}$ are relatively prime, the Chinese remainder theorem implies that we can find a unique $\a \in \mc{O}_{K}$ such that
      \[
        \a \equiv \g \pmod{\mf{p}^{n+1}} \quad \text{and} \quad \a \equiv 0 \tmod{\b\mc{O}_{K}\mf{p}^{-n}}.
      \]
      The second condition implies $\a \in \b\mc{O}_{K}\mf{p}^{-n}$. As $\g \in \mf{p}^{n}$ and $\a$ and $\g$ differ by an element in $\mf{p}^{n+1} \subset \mf{p}^{n}$, we have that $\a \in \b\mc{O}_{K}\mf{p}^{-n} \cap \mf{p}^{n} = \b\mc{O}_{K}$ where the equality holds because the intersection of ideals is equal to their product if the ideals are relatively prime. Thus $\frac{\a}{\b} \in \mc{O}_{K}$ and hence
      \[
        \phi\left(\frac{\a}{\b}\right) = \a \equiv \g \tmod{\mf{p}^{n+1}}.
      \]
      This shows $\phi$ is surjective completing the proof.
    \end{proof}

    Now we can show that the norm of an integral ideal is completely multiplicative:

    \begin{proposition}\label{prop:ideal_norm_is_multiplicative}
      Let $K$ be a number field and let $\mf{a}$ and $\mf{b}$ be integral ideals. Then
      \[
        \Norm(\mf{a}\mf{b}) = \Norm(\mf{a})\Norm(\mf{b}).
      \]
    \end{proposition}
    \begin{proof}
      First suppose $\mf{a}$ and $\mf{b}$ are relatively prime. Then the Chinese remainder theorem implies
      \[
        \mc{O}_{K}/\mf{a}\mf{b} \cong \mc{O}_{K}/\mf{a} \op \mc{O}_{K}/\mf{b},
      \]
      and hence $|\mc{O}_{K}/\mf{a}\mf{b}| = |\mc{O}_{K}/\mf{a}||\mc{O}_{K}/\mf{b}|$ so that $\Norm(\mf{a}\mf{b}) = \Norm(\mf{a})\Norm(\mf{b})$. It now suffices to show $\Norm(\mf{p}^{n}) = \Norm(\mf{p})^{n}$ for all prime integral ideals $\mf{p}$ and $n \ge 0$. We will prove this by induction. The base case is clear so assume that the claim holds for $n-1$. By the third isomorphism theorem, we have
      \[
        \mc{O}_{K}/\mf{p}^{n-1} \cong (\mc{O}_{K}/\mf{p}^{n})/(\mf{p}^{n-1}/\mf{p}^{n}).
      \]
      Using \cref{prop:isomorphism_of_quotient_by_prime_integral_ideals}, it follows that
      \[
        |\mc{O}_{K}/\mf{p}^{n-1}| = \frac{|\mc{O}_{K}/\mf{p}^{n}|}{|\mf{p}^{n-1}/\mf{p}^{n}|} = \frac{|\mc{O}_{K}/\mf{p}^{n}|}{|\mc{O}_{K}/\mf{p}|}.
      \]
      Thus $\Norm(\mf{p}^{n}) = \Norm(\mf{p}^{n-1})\Norm(\mf{p})$ and our induction hypothesis implies $\Norm(\mf{p}^{n}) = \Norm(\mf{p})^{n}$ as desired.
    \end{proof}

    Note that by \cref{prop:ideal_norm_is_multiplicative}, the norm is a homomorphism from the set of integral ideals into $\Z_{+}$. As the norm of the zero ideal is zero, we also have
    \[
      \Norm(\a\mf{a}) = |\Norm(\a)|\Norm(\mf{a}),
    \]
    for all $\a \in \mc{O}_{K}$ and any integral ideal $\mf{a}$ by \cref{prop:residue_of_integral_ideal_is_finite}. As last we can extend the norm to fractional ideals. Let $\mf{f}$ be a fractional ideal. By \cref{cor:fractional_ideal_prime_factorization}, there exist unique integral ideals $\mf{a}$ and $\mf{b}$ such that
    \[
      \mf{f} = \mf{a}\mf{b}^{-1}.
    \]
    For any fractional ideal $\mf{f}$, we define its \textbf{norm}\index{norm} $\Norm(\mf{f})$ by
    \[
      \Norm(\mf{f}) = \frac{\Norm(\mf{a})}{\Norm(\mf{b})}.
    \]
    In particular, $\Norm(\mf{f}) \in \mf{f}$ because every integral ideal contains its norm (as we have noted). That is, every fractional ideal contains its norm. We also have a homomorphism
    \[
      \Norm:I_{K} \to \Q^{\ast} \qquad \mf{f} \mapsto \Norm(\mf{f}),
    \]
    and we call this the \textbf{ideal norm}\index{ideal norm} of $K$. The ideal norm is completely multiplicative by \cref{prop:ideal_norm_is_multiplicative}.
  \section{Lattices \& The Different}
    Let $K$ be a number field of degree $n$. By \cref{lem:trace_is_nondegenerate}, there is a nondegenerate symmetric bilinear form on $K$ given by
    \[
      \Trace:K \x K \to \Q \qquad (\k,\l) \to \Trace(\k\l).
    \]
    We call this bilinear form the \textbf{trace form}\index{trace form} on $K$. The trace form makes $K$ into a nondegenerate inner product space over $\Q$. As any fractional ideal is a free abelian group of rank $n$, fractional ideals are complete lattices in $K$ as a vector space over $\Q$. In particular, integral ideals are also complete lattices in $K$ and thus $\mc{O}_{K}$ is a complete lattice in $K$. For a fractional ideal $\mf{f}$, note that the dual lattice $\mf{f}^{\vee}$ is
    \[
      \mf{f}^{\vee} = \{\k \in K:\text{$\Trace(\k \a) \in \Z$ for all $\a \in \mf{f}$}\}.
    \]
    We call $\mf{f}^{\vee}$ the \textbf{dual ideal}\index{dual ideal} of $\mf{f}$. The following proposition shows that the dual ideal $\mf{f}^{\vee}$ is indeed a fractional ideal:

    \begin{proposition}\label{prop:dual_lattice_is_fractional}
      Let $K$ be a number field and $\mf{f}$ be a fractional ideal. Then $\mf{f}^{\vee}$ is a fractional ideal and
      \[
        \mf{f}^{\vee} = \mf{f}^{-1}\mc{O}_{K}^{\vee}.
      \]
    \end{proposition}
    \begin{proof}
      By \cref{prop:dual_lattice_exists}, $\mf{f}$ is a finitely generated $\Z$-module. Therefore it is a finitely generated $\mc{O}_{K}$-submodule of $K$ if it is preserved under multiplication by $\mc{O}_{K}$. Let $\a \in \mc{O}_{K}$ and $\b \in \mf{f}^{\vee}$. Then we must show $\a\b \in \mf{f}^{\vee}$. To see this, observe that $\Trace(\a\b\mf{f}) \subseteq \Trace(\b\mf{f}) \subseteq \Z$ by \cref{cor:norm_and_trace_of_algebraic_integers} since $\a\mf{f} \subseteq \mf{f}$ and $\b \in \mf{f}^{\vee}$. Therefore $\a\b \in \mf{f}^{\vee}$ and hence $\mf{f}^{\vee}$ is a fractional ideal proving the first statement. To prove the second we will show containment in both directions. For the forward containment, first suppose $\a \in \mf{f}^{\vee}$ and $\b \in \mf{f}$. Then $\Trace(\a\b\mc{O}_{K}) \subseteq \Trace(\a\mf{f}) \subseteq \Z$ by \cref{cor:norm_and_trace_of_algebraic_integers} since $\b\mc{O}_{K} \subseteq \mf{f}$ and $\a \in \mf{f}^{\vee}$. Hence $\a\b \in \mc{O}_{K}^{\vee}$ so that $\mf{f}^{\vee}\mf{f} \subseteq \mc{O}_{K}^{\vee}$ and therefore $\mf{f}^{\vee} \subseteq \mf{f}^{-1}\mc{O}_{K}^{\vee}$. This proves the forward containment. For the reverse containment, suppose $\a \in \mf{f}^{-1}$ and $\b \in \mc{O}_{K}^{\vee}$. Then $\Trace(\a\b\mf{f}) \subseteq \Trace(\b\mc{O}_{K}) \subseteq \Z$ by \cref{cor:norm_and_trace_of_algebraic_integers} since $\a\mf{f} \subseteq \mc{O}_{K}$ and $\b \in \mc{O}_{K}^{\vee}$. This shows $\a\b \in \mf{f}^{\vee}$ and hence $\mf{f}^{-1}\mc{O}_{K}^{\vee} \subseteq \mf{f}^{\vee}$ proving the reverse containment and completing the proof.
    \end{proof}

    We define the \textbf{different}\index{different} $\mf{D}$ of $K$ by
    \[
      \mf{D}_{K} = (\mc{O}_{K}^{\vee})^{-1}.  
    \]
    This is an integral ideal. Indeed, first note that $\mc{O}_{K} \subseteq \mc{O}_{K}^{\vee}$ by \cref{cor:norm_and_trace_of_algebraic_integers}. It follows from \cref{prop:explicit_inverse_ideal} that $\mc{D}_{K}$ is an integral ideal and
    \[
      \mf{D}_{K} = \{\k \in K: \k\mc{O}_{K}^{\vee} \subseteq \mc{O}_{K}\}.  
    \]
    Also, by \cref{prop:dual_lattice_is_fractional} we can express the dual ideal $\mf{f}^{\vee}$ of a fractional ideal $\mf{f}$ in terms of the different as
    \[
      \mf{f}^{\vee} = \mf{f}^{-1}\mf{D}_{K}^{-1}.
    \]
    It turns out that the norm of the different is the absolute value of the discriminant:

    \begin{proposition}\label{prop:norm_of_different}
      Let $K$ be an algebraic number field of degree $n$. Then we have an isomorphism
      \[
        \mc{O}_{K}/\mf{D}_{K} \cong \mc{O}_{K}^{\vee}/\mc{O}_{K},
      \]
      as $\mc{O}_{K}$-modules. In particular,
      \[
        \Norm(\mf{D}_{K}) = |\D_{K}|.
      \]
    \end{proposition}
    \begin{proof}
      By \cref{prop:explicit_inverse_ideal}, $\mc{O}_{K} \subseteq \mf{D}_{K}^{-1}$. Then the second isomorphism theorem implies
      \[
        \mc{O}_{K}/\mf{D}_{K} \cong \mf{D}^{-1}_{K}/\mc{O}_{K} \cong \mc{O}_{K}^{\vee}/\mc{O}_{K},
      \]
      which proves the first statement. For the second, this isomorphism shows that $\Norm(\mf{D}_{K}) = |\mc{O}_{K}^{\vee}/\mc{O}_{K}|$. Now let $\a_{1},\ldots,\a_{n}$ be an integral basis for $\mc{O}_{K}$. Then $\a_{1}^{\vee},\ldots,\a_{n}^{\vee}$ is a basis for $\mc{O}_{K}^{\vee}$ and by definition of the dual basis we have
      \[
        \a_{i}^{\vee} = \sum_{1 \le j \le n}\Trace(\a_{i}\a_{j})\a_{j}.
      \]
      But then the base change matrix from $\a_{1},\ldots,\a_{n}$ to $\a_{1}^{\vee},\ldots,\a_{n}^{\vee}$ is $(\Trace(\a_{i}\a_{j}))_{i,j}$. The claim follows by \cref{prop:base_change_quotient_determinant} and the definition of $\D_{K}$.
    \end{proof}

    As a corollary, we can compute the norm of dual ideals:

    \begin{corollary}\label{cor:norm_of_different}
      Let $K$ be a number field and $\mf{f}$ be a fractional ideal. Then
      \[
        \Norm(\mf{f}^{\vee}) = \frac{\Norm(\mf{f}^{-1})}{|\D_{K}|}.
      \]
    \end{corollary}
    \begin{proof}
      This follows immediately from the second statement of \cref{prop:norm_of_different}, multiplicativity of the norm, and that $\mf{f}^{\vee} = \mf{f}^{-1}\mf{D}_{K}^{-1}$.
    \end{proof}

    We have already remarked that the different is an integral ideal and that $\mc{O}_{K} \subseteq \mc{O}_{K}^{\vee}$. Therefore we have an inclusion of complete lattices
    \[
      \mc{D}_{K} \subseteq \mc{O}_{K} \subseteq \mc{O}_{K}^{\vee}.
    \]
    What \cref{prop:norm_of_different} shows is that each complete lattice in chain has index $|\D_{K}|$ in the next one. In particular, $\mc{O}_{K}^{\vee}$ is strictly larger than $\mc{O}_{K}$ if and only if $|\D_{K}| \ge 2$. So we can think of the different $\mc{D}_{K}$ as a measure of the failure of $\mc{O}_{K}$ to be self-dual since $\Norm(\mc{D}_{K}) = 1$ if and only if $\mc{O}_{K}^{\vee} = \mc{O}_{K}$.
  \section{Ramification}
    We now discuss the factorization of prime integral ideals in number fields. First, we need to introduce the concept of prime integral ideals above primes. Let $K$ be a number field and let $\mf{p}$ be a prime integral ideal. Then $\mf{p} \cap \Z$ is a prime integral ideal of $\Q$. Indeed, it is clear that $\mf{p} \cap \Z$ is an integral ideal of $\Q$. It is proper because $1 \notin \mf{p} \cap \Z$ as $\mf{p}$ does not contain units. It is nonzero because any integral ideal contains its norm (as we have noted) and hence $\Norm(\mf{p}) \in \mf{p} \cap \Z$. To show that $\mf{p} \cap \Z$ is prime, suppose $a$ and $b$ are integers such that $ab \in \mf{p} \cap \Z$. Then $ab \in \mf{p}$ and since $\mf{p}$ is prime either $a \in \mf{p}$ or $b \in \mf{p}$. But then $a \in \mf{p} \cap \Z$ or $b \in \mf{p} \cap \Z$ as desired. We have now shown that $\mf{p} \cap \Z$ is a prime integral ideal of $\Q$. Hence
    \[
      \mf{p} \cap \Z = p\Z,
    \]
    for some prime integer $p$. Accordingly, we say that $\mf{p}$ is \textbf{above}\index{above} $p$, or equivalently, $p$ is \textbf{below}\index{below} $\mf{p}$. Moreover, if $\mf{p}$ is above $p$, then $\mf{p}$ must be a prime factor of $p\mc{O}_{K}$. Indeed, $p\Z \subseteq \mf{p}$ so that $p\mc{O}_{K} \subseteq \mf{p}$ and then the fact $\mf{p}$ is prime implies that some prime factor of $p\mc{O}_{K}$ is contained in $\mf{p}$. Since prime integral ideals are maximal by \cref{prop:prime_integral_ideals_are_maximal}, this prime factor must be $\mf{p}$ itself. We illustrate these relations by the extension

    \begin{center}
      \begin{tikzcd}
        \mf{p} \subset \mc{O}_{K} \subset K \arrow[dash]{d} \\
        p\Z \subset \Z \subset \Q.
      \end{tikzcd}
    \end{center}

    Since $\mf{p}$ and $p\Z$ are maximal in $\mc{O}_{K}$ and $\Z$ respectively by \cref{prop:prime_integral_ideals_are_maximal}, we have the residue fields $\mc{O}_{K}/\mf{p}$ and $\F_{p}$. It turns out that $\mc{O}_{K}/\mf{p}$ is a finite dimensional vector space over $\F_{p}$. To see this, consider the homomorphism
    \[
      \phi:\Z \to \mc{O}_{K}/\mf{p} \qquad a \to a \tmod{\mf{p}}.
    \]
    Now $\ker\phi = \mf{p} \cap \Z$ and hence $\ker\phi = p\Z$ since $\mf{p}$ is above $p$. By the first isomorphism theorem, $\phi$ induces an injection $\phi:\F_{p} \to \mc{O}_{K}/\mf{p}$. By \cref{prop:residue_of_integral_ideal_is_finite}, $\mc{O}_{K}/\mf{p}$ is finite and thus a finite field containing $\F_{p}$. Necessarily $\mc{O}_{K}/\mf{p}$ is a finite dimensional vector space over $\F_{p}$. Accordingly, we define the \textbf{inertia degree}\index{inertia degree} $f_{p}(\mf{p})$ of $\mf{p}$ by
    \[
      f_{p}(\mf{p}) = [\mc{O}_{K}/\mf{p}:\F_{p}].
    \]
    That is, $f_{p}(\mf{p})$ is the dimension of the residue field $\mc{O}_{K}/\mf{p}$ as a vector space over $\F_{p}$. Then we have
    \[
      \Norm(\mf{p}) = |\mc{O}_{K}/\mf{p}| = |\F_{p}|^{f_{p}(\mf{p})} = p^{f_{p}(\mf{p})}.
    \]
    In particular, the norm of a prime integral ideal is a power of the prime below it. As we have already noted, $\mf{p}$ is a prime factor of $p\mc{O}_{K}$. The \textbf{ramification index}\index{ramification index} $e_{p}(\mf{p})$ of $\mf{p}$ is the positive integer such that $p\mc{O}_{K}\mf{p}^{-e_{p}(\mf{p})}$ is relatively prime to $\mf{p}$. If $p\mc{O}_{K}$ has prime factors $\mf{p}_{1},\ldots,\mf{p}_{r}$, then the prime factorization of $p\mc{O}_{K}$ is
    \[
      p\mc{O}_{K} = \mf{p}_{1}^{e_{p}(\mf{p}_{1})} \cdots \mf{p}_{r}^{e_{p}(\mf{p}_{r})}.
    \]
    We say that $p$ is \textbf{ramified}\index{ramified} if $e_{p}(\mf{p}_{i}) \ge 2$ for some $i$ and \textbf{unramified}\index{unramified} otherwise. In particular,
    \[
      p\mc{O}_{K} = \mf{p}_{1} \cdots \mf{p}_{r},
    \]
    if and only if $p$ is unramified. We also say $p$ is \textbf{split}\index{split} if $p\mc{O}_{K}$ is not prime. The degree of a number field is connected to the inertia degree and ramification index via the following proposition:

    \begin{proposition}\label{prop:inertia_ramification_relation}
      Let $K$ be a number field of degree $n$ and let $p$ be a prime. Suppose $p\mc{O}_{K}$ has prime factorization
      \[
        p\mc{O}_{K} = \mf{p}_{1}^{e_{p}(\mf{p}_{1})} \cdots \mf{p}_{r}^{e_{p}(\mf{p}_{r})}.
      \]
      Then
      \[
        n = \sum_{1 \le i \le r}e_{p}(\mf{p}_{i})f_{p}(\mf{p}_{i}).
      \]
    \end{proposition}
    \begin{proof}
      Since $p$ is an integer and $K$ is of degree $n$, on the one hand
      \[
        \Norm(p\mc{O}_{K}) = \Norm(p) = p^{n}.
      \]
      On the other hand, complete multiplicativity of the ideal norm implies
      \[
        \Norm(p\mc{O}_{K}) = \Norm(\mf{p}_{1})^{e_{p}(\mf{p}_{1})} \cdots \Norm(\mf{p}_{r})^{e_{p}(\mf{p}_{r})} = p^{e_{p}(\mf{p}_{1})f_{p}(\mf{p}_{1})} \cdots p^{e_{p}(\mf{p}_{r})f_{p}(\mf{p}_{r})}.
      \]
      Thus
      \[
        p^{n} = p^{e_{p}(\mf{p}_{1})f_{p}(\mf{p}_{1})} \cdots p^{e_{p}(\mf{p}_{r})f_{p}(\mf{p}_{r})},
      \]
      and the claim follows upon comparing exponents.
    \end{proof}

    We now describe some special cases of how $p\mc{O}_{K}$ may factor. If $r = n$, we say $p$ is \textbf{totally split}\index{totally split} and so $e_{p}(\mf{p}) = f_{p}(\mf{p}) = 1$ for all $\mf{p}$ above $p$ by \cref{prop:inertia_ramification_relation}. Equivalently, $p$ is totally split if and only if the number of prime integral ideal above $p$ is equal to the degree of $K$. If $r = 1$, then there is exactly one prime integral ideal $\mf{p}$ above $p$ and so
    \[
      p\mc{O}_{K} = \mf{p}^{e_{p}(\mf{p})}.
    \]
    If $e_{p}(\mf{p}) = 1$, so that $p$ does not ramify, we say $p$ is \textbf{inert}\index{inert} and so $f_{p}(\mf{p}) = n$ by \cref{prop:inertia_ramification_relation}. Thus $p$ is inert if and only if $p\mc{O}_{K}$ is prime. If $e_{p}(\mf{p}) \ge 2$, then $p$ ramifies and we say $p$ is \textbf{totally ramified}\index{totally ramified} if $e_{p}(\mf{p}) = n$ so that $f_{p}(\mf{p}) = 1$ by \cref{prop:inertia_ramification_relation}. Equivalently, $p$ is totally ramified if and only if it is the power of a prime integral ideal with power equal to the degree of $K$. The ramification of primes is intimately connected to the discriminant of a number field as the following theorem shows:

    \begin{theorem}\label{thm:ramification_division_equivalence}
      Let $K$ be a number field. Then $p$ is ramified if and only if $p$ divides $|\D_{K}|$.
    \end{theorem}
    \begin{proof}
      Let $p$ be a prime and suppose $p\mc{O}_{K}$ has prime factorization
      \[
        p\mc{O}_{K} = \mf{p}_{1}^{e_{p}(\mf{p}_{1})} \cdots \mf{p}_{r}^{e_{p}(\mf{p}_{r})},
      \]
      Now let $\a_{1},\ldots,\a_{n}$ be an integral basis for $K$ and let $\conj{\a} \in \mc{O}_{K}/p\mc{O}_{K}$ denote the reduction of $\a \in \mc{O}_{K}$ modulo $p$. Then $\conj{\a_{1}},\ldots,\conj{\a_{n}}$ is a basis for $\mc{O}_{K}/p\mc{O}_{K}$ as a vector space over $\F_{p}$. Moreover, the matrix for $T_{\conj{\a}}$ is obtained from $T_{\a}$ by reducing the coefficients modulo $p$. These two facts together give
      \[
        \D_{K} = \disc_{K/\Q}(\a_{1},\ldots,\a_{n}) \equiv \disc_{(\mc{O}_{K}/p\Z)/\F_{p}}(\conj{\a_{1}},\ldots,\conj{\a_{n}}) \pmod{p}.
      \]
      Recall that $\disc_{(\mc{O}_{K}/p\Z)/\F_{p}}(\conj{\a_{1}},\ldots,\conj{\a_{n}})$ is an element of $\F_{p}$. Then as $\disc_{\F_{p}}(\mc{O}_{K}/p\mc{O}_{K})$ is equivalent to $\disc_{(\mc{O}_{K}/p\Z)/\F_{p}}(\conj{\a_{1}},\ldots,\conj{\a_{n}})$ up to elements of $(\F_{p}^{\ast})^{2}$, it must be the case that $p$ divides $|\D_{K}|$ if and only if $\disc_{\F_{p}}(\mc{O}_{K}/p\mc{O}_{K}) = 0$. By the Chinese remainder theorem,
      \[
        \mc{O}_{K}/p\mc{O}_{K} \cong \bigop_{1 \le i \le r}\mc{O}_{K}/\mf{p}_{i}^{e_{p}(\mf{p}_{i})},
      \]
      and so \cref{prop:discriminant_and_direct_sums} further implies
      \[
         \D_{K} = \prod_{1 \le i \le r}\disc_{\F_{p}}(\mc{O}_{K}/\mf{p}_{i}^{e_{p}(\mf{p}_{i})}).
      \]
      Hence $p$ divides $|\D_{K}|$ if and only if $\disc_{\F_{p}}(\mc{O}_{K}/\mf{p}_{i}^{e_{p}(\mf{p}_{i})}) = 0$ for some $i$. It is now sufficient to show that $\disc_{\F_{p}}(\mc{O}_{K}/\mf{p}^{e_{p}(\mf{p})}) = 0$ for any prime integral ideal $\mf{p}$ above $p$ if and only if $e_{p}(\mf{p}) \ge 2$. First suppose $e_{p}(\mf{p}) \ge 2$. We will prove $\disc_{\F_{p}}(\mc{O}_{K}/\mf{p}^{e_{p}(\mf{p})}) = 0$. By the uniqueness of the factorization of integral ideals, there exists a nonzero $\a_{1} \in \mf{p}^{e_{p}(\mf{p})-1}-\mf{p}^{e_{p}(\mf{p})}$. Then $\a_{1}^{2} \in \mf{p}^{2(e_{p}(\mf{p})-1)} \subseteq \mf{p}^{e_{p}(\mf{p})}$ because $e_{p}(\mf{p}) \ge 2$. By construction, $\conj{\a_{1}} \in \mc{O}_{K}/\mf{p}^{e_{p}(\mf{p})}$ is nonzero and such that $\conj{\a_{1}}^{2} = 0$. Since $\mc{O}_{K}/\mf{p}^{e_{p}(\mf{p})}$ is an $n$ dimensional vector space over $\F_{p}$, there exists a basis of the form $\conj{\a_{1}},\ldots,\conj{\a_{m}}$. Now
      \[
        \Trace_{(\mc{O}_{K}/\mf{p}^{e_{p}(\mf{p})})/\F_{p}}(\conj{\a_{1}}\conj{\a_{j}}) = 0,
      \]
      for $1 \le j \le n$ because $T_{\conj{\a_{1}}\conj{\a_{i}}}^{2}$ is the zero operator (as $\conj{\a_{1}}^{2} = 0$) and hence all of its eigenvalues are zero. But then the first row of $(\Trace_{(\mc{O}_{K}/\mf{p}^{e_{p}(\mf{p})})/\F_{p}}(\conj{\a_{i}}\conj{\a_{j}}))_{i,j}$ is zero and hence $\disc_{\F_{p}}(\mc{O}_{K}/\mf{p}^{e_{p}(\mf{p})}) = 0$. Now suppose $e_{p}(\mf{p}) = 1$. We will prove $\disc_{\F_{p}}(\mc{O}_{K}/\mf{p}) \neq 0$. Recall that $\mc{O}_{K}/\mf{p}$ is a field and a vector space over $\F_{p}$ of dimension $f_{p}(\mf{p})$. Thus $(\mc{O}_{K}/\mf{p})/\F_{p}$ it is a finite separable extension. Hence $\disc_{\F_{p}}(\mc{O}_{K}/\mf{p})$ is nonzero by \cref{prop:discriminant_not_zero}. We have now shown that $\disc_{\F_{p}}(\mc{O}_{K}/\mf{p}^{e_{p}(\mf{p})}) = 0$ if and only if $e_{p}(\mf{p}) \ge 2$ which completes the proof.
    \end{proof}

    As an immediate corollary, we see that only finitely many primes can ramify:

    \begin{corollary}
      Let $K$ be a number field. Then finitely many primes ramify in $K$.
    \end{corollary}
    \begin{proof}
      There are only finitely many prime divisors of $|\D_{K}|$. Hence finitely many primes ramify by \cref{thm:ramification_division_equivalence}. 
    \end{proof}

    There is also another important corollary which shows that the prime factors of $\mf{D}_{K}$ correspond exactly to the ramified primes:

    \begin{corollary}
      Let $K$ be a number field. If $\mf{p}$ is a prime factor of $\mf{D}_{K}$, then $\mf{p}$ lies over a ramified prime $p$.
    \end{corollary}
    \begin{proof}
      By \cref{prop:norm_of_different,thm:ramification_division_equivalence}, $p$ is ramified if and only if $p \mid \Norm(\mc{D}_{K})$. By multiplicativity of the ideal norm and the prime factorization, a ramified prime $p$ must divide $\Norm(\mf{p})$ for some prime factor $\mf{p}$ of $\mc{D}_{K}$. But then $\mf{p}$ is a prime integral ideal above the ramified prime $p$.
    \end{proof}

    There is no general way to see how a prime $p$ factors for an arbitrary number field $K$. However, in the case that the ring of integers is monogenic we can describe the factorization explicitly via the \textbf{Dedekind-Kummer theorem}\index{Dedekind-Kummer theorem}:

    \begin{theorem}[Dedekind-Kummer theorem]
      Let $K$ be a monogenic number field where $\mc{O}_{K} = \Z[\a]$ for $\a \in \mc{O}_{K}$ and let $p$ be a prime. Let $m_{\a}(x)$ be the minimal polynomial for $\a$ and let $\conj{m_{\a}}(x)$ be its reduction modulo $p$. Also let
      \[
        \conj{m_{\a}}(x) = \conj{m_{r}}(x)^{e_{r}} \cdots \conj{m_{r}}(x)^{e_{r}}
      \]
      with $\conj{m_{i}}(x) \in \F_{p}[x]$ and $e_{i} \ge 0$, be the prime factorization of $\conj{m_{\a}}(x)$ in $\F_{p}[x]$. Let $m_{i}(x) \in \Z[x]$ be any lift of $\conj{m_{i}}(x)$ and set
      \[
        \mf{p}_{i} = p\mc{O}_{K}+m_{i}(\a)\mc{O}_{K},
      \]
      for all $i$. Then $\mf{p}_{i}$ is a prime integral ideal for all $i$ and
      \[
        p\mc{O}_{K} = \mf{p}_{1}^{e_{1}} \cdots \mf{p}_{r}^{e_{r}},
      \]
      is the prime factorization of $p\mc{O}_{K}$.
    \end{theorem}
    \begin{proof}
      Since $m_{\a}(x)$ is the minimal polynomial for $\a$, we have an isomorphism $\Z[\a] \cong \Z[x]/m_{\a}(x)\Z[x]$ where the inverse isomorphism is given by evaluation at $\a$. Then we have the chain of isomorphism
      \[
        \mc{O}_{K}/p\mc{O}_{K} \cong (\Z[x]/m_{\a}(x)\Z[x])/(p(\Z[x]/m_{\a}(x)\Z[x])) \cong \Z[x]/(p\Z[x]+m_{\a}(x)\Z[x]) \cong \F_{p}[x]/\conj{m_{\a}}(x)\F_{p}[x],
      \]
      where the second and third isomorphisms follow by taking $\Z[x]/(p\Z[x]+m_{\a}(x)\Z[x])$ and reducing $\Z[x]$ modulo $m_{\a}(x)$ or $p$ respectively. Therefore the inverse isomorphism is given by sending any representative $\conj{f}(x)$ of a class in $\F_{p}[x]/\conj{m_{\a}}(x)\F_{p}[x]$ to a lift $f(x) \in \Z[x]$ and then to $\conj{f(\a)}$ where $\conj{f(\a)}$ is $f(\a)$ modulo $p\mc{O}_{K}$. Now set $A = \F_{p}[x]/\conj{m_{\a}}(x)\F_{p}[x]$. Then the Chinese remainder theorem gives an isomorphism
      \[
        A \cong \bigop_{1 \le i \le r}\F_{p}[x]/\conj{m_{i}}(x)^{e_{i}}\F_{p}[x].
      \]
      As $\conj{m_{i}}(x)$ is irreducible, $\conj{m_{i}}(x)\F_{p}[x]$ is maximal and hence $\F_{p}[x]/\conj{m_{i}}(x)\F_{p}[x]$ is a field. By the third isomorphism theorem, $\conj{m_{i}}(x)\F_{p}[x]/\conj{m_{i}}(x)^{e_{i}}\F_{p}[x]$ is a maximal ideal of $\F_{p}[x]/\conj{m_{i}}(x)^{e_{i}}\F_{p}[x]$. It follows that the maximal ideals of $A$ are precisely $\conj{m_{i}}(x)A$ and we have an isomorphism
      \[
        A/\conj{m_{i}}(x)A \cong \F_{p}[x]/\conj{m_{i}}(x)\F_{p}[x],
      \]
      for all $i$. Via the isomorphism $\mc{O}_{K}/p\mc{O}_{K} \cong A$ described above, the maximal ideals of $\mc{O}_{K}/p\mc{O}_{K}$ are exactly $\conj{m_{i}(\a)}(\mc{O}_{K}/p\mc{O}_{K})$. We now show that the $\mf{p}_{i}$ are prime. To see this, consider the surjective homomorphism
      \[
        \pi:\mc{O}_{K} \to \mc{O}_{K}/p\mc{O}_{K} \qquad \a \to \a \pmod{p\mc{O}_{K}}.
      \]
      Then the image of $\mf{p}_{i}$ under $\pi$ is $\conj{m_{i}(\a)}(\mc{O}_{K}/p\mc{O}_{K})$. As this ideal is maximal and hence prime, the preimage $\mf{p}_{i}$ is prime too. Moreover, the $\mf{p}_{i}$ are all distinct since the $\conj{m_{i}(\a)}\mc{O}_{K}/p\mc{O}_{K}$ are which are all distinct because the $\conj{m_{i}}(x)A$ are (using the isomorphism $\mc{O}_{K}/p\mc{O}_{K} \cong A$). In particular, they are also relatively prime. By construction, $\mf{p}_{i} \subseteq p\mc{O}_{K}$ so that the $\mf{p}_{i}$ are prime factors of $p\mc{O}_{K}$. These are the only prime factors of $p\mc{O}_{K}$ because the image of any prime integral ideal under $\pi$ and contained in $p\mc{O}_{K}$ must be a maximal ideal of $\mc{O}_{K}/p\mc{O}_{K}$, by \cref{prop:prime_integral_ideals_are_maximal} and the fourth isomorphism theorem, and every maximal ideal is one of the $\conj{m_{i}(\a)}(\mc{O}_{K}/p\mc{O}_{K})$. Together, all of this means that $p\mc{O}_{K}$ admits the prime factorization
      \[
        p\mc{O}_{K} = \mf{p}_{1}^{e_{p}(\mf{p}_{1})} \cdots \mf{p}_{r}^{e_{p}(\mf{p}_{r})},
      \]
      for some ramification indices $e_{p}(\mf{p}_{i})$ for all $i$. We will be done if we can show that the ramification indices satisfy $e_{p}(\mf{p}_{i}) = e_{i}$. To accomplish this, observe that we have an isomorphism
      \[
        \mc{O}_{K}/\mf{p}_{i} \cong (\mc{O}_{K}/p\mc{O}_{K})/(\conj{m_{i}(\a)}(\mc{O}_{K}/p\mc{O}_{K})) \cong \F_{p}[x]/\conj{m_{i}}(x)\F_{p}[x],
      \]
      where the first isomorphism follow by taking $\mc{O}_{K}/\mf{p}_{i}$ and reducing $\mc{O}_{K}$ modulo $p$ and the second isomorphism follows from $\mc{O}_{K}/p\mc{O}_{K} \cong A$ and that the image of the maximal ideal $\conj{m_{i}(\a)}(\mc{O}_{K}/p\mc{O}_{K})$ under this isomorphisms is $\conj{m_{i}}(x)A$. Now $\F_{p}[x]/\conj{m_{i}}(x)\F_{p}[x]$ is a vector space over $\F_{p}$ (as it contains $\F_{p}$) of degree $\deg(\conj{m_{i}}(x))$. Hence the inertia degree $f_{p}(\mf{p}_{i})$ of $\mf{p}_{i}$ satisfies $f_{p}(\mf{p}_{i}) = \deg(\conj{m_{i}}(x))$. The ideal $\conj{m_{i}}(x)^{e_{i}}A$ under the isomorphism $A \cong \mc{O}_{K}/p\mc{O}_{K}$ is the ideal $\conj{m_{i}(\a)}^{e_{i}}(\mc{O}_{K}/p\mc{O}_{K})$. As the image of $\mf{p}_{i}$ under $\pi$ is $\conj{m_{i}(\a)}(\mc{O}_{K}/p\mc{O}_{K})$, we have that $\mf{p}_{i}^{e_{i}}$ is contained in the preimage of $\conj{m_{i}(\a)}^{e_{i}}(\mc{O}_{K}/p\mc{O}_{K})$ under $\pi$. As $\conj{m_{\a}(\a)}(\mc{O}_{K}/p\mc{O}_{K}) = 0$ is the zero ideal, it follows that
      \[
        p\mc{O}_{K} = \pi^{-1}(0) \supseteq \mf{p}_{1}^{e_{1}} \cdots \mf{p}_{r}^{e_{r}}.
      \]
      Since the $\mf{p}_{i}$ are prime, we have $e_{p}(\mf{p}_{i}) \le e_{i}$ for all $i$. By \cref{prop:inertia_ramification_relation} then gives
      \[
        n = \sum_{1 \le i \le r}e_{p}(\mf{p}_{i})f_{p}(\mf{p}_{i}) \le \sum_{1 \le i \le r}e_{i}f_{p}(\mf{p}_{i}) \le \sum_{1 \le i \le r}e_{i}\deg(\conj{m_{i}}(x)) \le n,
      \]
      where the last equality follows by the prime factorization of $\conj{m_{\a}}(x)$ and that $\deg(\conj{m_{\a}}(x)) = \deg(m_{\a}(x))$ because $m_{\a}(x)$ is monic. This shows that $e_{p}(\mf{p}_{i}) = e_{i}$ for all $i$ which completes the proof.
    \end{proof}

    Lastly, we want to show that the number of integral ideals of a given norm is relatively small. Indeed, let $a_{K}(m)$ denote the number of integral ideals of norm $m$. Because the norm is multiplicative so is $a_{K}(m)$. Moreover, we have the following result:

    \begin{proposition}\label{equ:ideals_of_fixed_norm_bound}
      Let $K$ be a number field of degree $n$. Then $a_{K}(m) \le \s_{0}(m)^{n}$.
    \end{proposition}
    \begin{proof}
      Let $\mf{a}$ be an integral ideal of norm $m$. First suppose $m = p^{k}$ for some prime $p$ and $k \ge 0$. As there are at most $n$ prime integral ideals $\mf{p}_{1},\ldots,\mf{p}_{n}$ above $p$ with inertia degrees $f_{p}(\mf{p}_{1}),\ldots,f_{p}(\mf{p}_{1})$ respectively, we have
      \[
        \Norm(\mf{a}) = p^{e_{1}f_{p}(\mf{p}_{1})} \cdots p^{e_{n}f_{\mf{p}_{n}}},
      \]
      for some integers $0 \le e_{i} \le k$ for $1 \le i \le n$. Therefore the number of possibilities is equivalent to the number of solutions
      \[
        e_{1}f_{p}(\mf{p}_{1})+\cdots+e_{n}f_{\mf{p}_{n}} = k,
      \]
      which is at most $\s_{0}(p^{k})^{n} = (k+1)^{n}$. This proves the claim in the case $m$ is a prime power. By multiplicativity of $a_{K}(m)$ and the divisor function, it follows that the number of integral ideals of norm $m$ is at most $\s_{0}(m)^{n}$ as desired.
    \end{proof}
  \section{Minkowski Space}
    Let $K$ be number field of degree $n$ and let $\s$ be a $\Q$-embedding of $K$ into $\conj{\Q}$. Then either $\s$ is real or complex and if it is complex it has a paired $\Q$-embedding $\conj{\s}$ given by the conjugate of $\s$. Accordingly, let $r_{1}$ and $2r_{2}$ be the number of real and complex $\Q$-embeddings respectively. We call the pair $(r_{1},r_{2})$ the \textbf{signature}\index{signature} of $K$ and it satisfies the relation
    \[
      n = r_{1}+2r_{2}.
    \]
    Setting
    \[
      K_{\C} = \C^{n},
    \]
    we see that $K_{\C}$ is a $\C$-algebra and also a complex Hilbert space with respect to $\<\cdot,\cdot\>_{K_{\C}}$ which we take to be the standard complex inner product. We denote the associated Lebesgue measure by $d\l_{K_{\C}}$. We define the \textbf{canonical embedding}\index{canonical embedding} $j$ of $K$ to be the $\Q$-embedding
    \[
      j:K \to K_{\C} \qquad \k = (\s(\k))_{\s},
    \]
    where $\s$ runs over the $n$ distinct $\Q$-embeddings of $K$ into $\conj{\Q}$. Consider the conjugation map
    \[
      F:\C \to \C \qquad z \to \conj{z}.
    \]
    This induces an automorphism
    \[
      F:K_{\C} \to K_{\C} \qquad (z_{\s})_{\s} \to (\conj{z_{\conj{\s}}})_{\s},
    \]
    that is clearly an involution. The inner product $\<\cdot,\cdot\>_{K_{\C}}$ is also $F$-equivariant since any $\mathbf{z},\mathbf{w} \in K_{\C}$ satisfy
    \[
      \<F(\mathbf{z}),F(\mathbf{z})\>_{K_{\C}} = \<(\conj{z_{\conj{\s}}})_{\s},(\conj{w_{\conj{\s}}})_{\s}\>_{K_{\C}} = \sum_{\s}\conj{z_{\conj{\s}}w_{\conj{\s}}} = \conj{\sum_{\s}z_{\s}w_{\s}} = F(\<\mathbf{z},\mathbf{w}\>_{K_{\C}}),
    \]
    where in the third equality we have used the fact that the complex $\Q$-embeddings come in conjugate pairs. On $K_{\C}$ we also have linear maps
    \[
      \Trace_{K_{\C}}((z_{\s})_{\s}) = \sum_{\s}z_{\s} \quad \text{and} \quad \Norm_{K_{\C}}((z_{\s})_{\s}) = \prod_{\s}z_{\s},
    \]
    and clearly induce homomorphisms
    \[
      \Trace_{K_{\C}}:K_{\C} \to \C \quad \text{and} \quad \Norm_{K_{\C}}:K_{\C}^{\ast} \to \C^{\ast}.
    \]
    The composition of $j$ with $\Trace_{K_{\C}}$ and $\Norm_{K_{\C}}$ are $\Trace$ and $\Norm$ respectively since
    \[
      \Trace_{K_{\C}}(j(\k)) = \sum_{\s}\s(\k) = \Trace(\k) \quad \text{and} \quad \Norm_{K_{\C}}(j(\k)) = \prod_{\s}\s(\k) = \Norm(\k),
    \]
    where the last equality in each chain follow by \cref{prop:formulas_for_trace_and_norm}. We now define the \textbf{Minkowski space}\index{Minkowski space} $K_{\R}$ of $K$ by
    \[
      K_{\R} = \{(z_{\s})_{\s} \in K_{\C}:F((z_{\s})_{\s}) = (z_{\s})_{\s}\}.
    \]
    In other words, $K_{\R}$ consists of all of the $F$-invariant points of $K_{\C}$. That is, $\mathbf{z} \in K_{\R}$ if and only if $F(\mathbf{z}) = \mathbf{z}$ or equivalently $z_{\conj{\s}} = \conj{z_{\s}}$ for all $\s$. In particular, $j(K) \subset K_{\R}$ because $\conj{\s}(\k) = \conj{\s(\k)}$ by definition of $\conj{\s}$. We denote the restriction of the inner product $\<\cdot,\cdot\>_{K_{\C}}$ on $K_{\C}$ to $K_{\R}$ by $\<\cdot,\cdot\>_{K_{\R}}$. Note that $K_{\R}$ is an $\R$-algebra. Moreover, the inner product $\<\cdot,\cdot\>_{K_{\R}}$ turns $K_{\R}$ into a real Hilbert space. Indeed, for any $\mathbf{z},\mathbf{w} \in K_{\R}$ the conjugate symmetry and $F$-equivariance of the inner product together give
    \[
      \conj{\<\mathbf{z},\mathbf{w}\>} = F(\<\mathbf{w},\mathbf{z}\>) = \<F(\mathbf{z}),F(\mathbf{w})\> = \<\mathbf{z},\mathbf{w}\>,
    \]
    so that $\<\mathbf{z},\mathbf{w}\> \in \R$ is real. Accordingly, we call $\<\cdot,\cdot\>_{K_{\R}}$ the \textbf{Minkowski inner product}\index{Minkowski inner product}. We denote the restriction of the Lebesgue measure $d\l_{\C}$ to $K_{\R}$ by $d\l_{K_{\R}}$ which is also the Lebesgue measure associated to $\<\cdot,\cdot\>_{K_{\R}}$. We call $d\l_{K_{\R}}$ the \textbf{Minkowski measure}\index{Minkowski measure}. Lastly, we denote the restrictions of $\Trace_{K_{\C}}$ and $\Norm_{K_{\C}}$ to $K_{\R}$ by $\Trace_{K_{\R}}$ and $\Norm_{K_{\R}}$ respectively and call these maps the \textbf{Minkowski trace}\index{Minkowski trace} and \textbf{Minkowski norm}\index{Minkowski norm} respectively. We also have homomorphisms
    \[
      \Trace_{K_{\R}}:K_{\R} \to \R \quad \text{and} \quad \Norm_{K_{\R}}:K_{\R}^{\ast} \to \R^{\ast},
    \]
    $\mathbf{z} \in K_{\R}$ if and only if $z_{\conj{\s}} = \conj{z_{\s}}$ for all $\s$. As $j(K) \subset K_{\R}$, the compositions of $j$ with the Minkowski trace and Minkowski norm are the field trace and field norm respectively. We can now give a more explicit description of $K_{\R}$ and to do this we setup some notation. Let $\rho$ run over the real $\Q$-embeddings and let $\tau$ run over a complete set of representatives of the pairs of complex $\Q$-embeddings. For any $\Q$-embedding $\s$, let $N_{\s} = 1,2$ according to if $\s$ is real or complex respectively. So $N_{\rho} = 1$ and $N_{\tau} = 2$. As $K_{\R}$ consists of exactly the $F$-invariant points of $K_{\C}$, we have
    \[
      K_{\R} = \{(z_{\s})_{\s} \in K_{\C}:\text{$z_{\rho} \in \R$ and $z_{\conj{\tau}} = \conj{z_{\tau}}$ for all $\rho$ and $\tau$}\}.
    \]
    We now describe an explicit isomorphism from the Minkowski space and $\R^{n}$:
    
    \begin{proposition}\label{prop:Minkowski_space_isomorphism}
      Let $K$ be a number field of degree $n$ and signature $(r_{1},r_{2})$. Also let $\s$ run over the $n$ distinct $\Q$-embeddings of $K$ into $\conj{\Q}$, $\rho$ run over all such real $\Q$-embeddings, and $\tau$ run over a complete set of representatives of all such pairs of complex $\Q$-embeddings. Then there is an isomorphism
      \[
        K_{\R} \to \R^{n} \qquad z_{\s} \to x_{\s} = \begin{cases} z_{\s} & \text{if $\s = \rho$}, \\ \Re(z_{\s}) & \text{if $\s = \tau$}, \\ \Im(z_{\s}) & \text{if $\s = \conj{\tau}$}. \end{cases}
      \]
      In particular, $K_{\R}$ is a $n$-dimensional vector space over $\R$. Moreover, the inner product $\<\cdot,\cdot\>$ on $\R^{n}$ induced by the Minkowski inner product is given by
      \[
        \<\mathbf{x},\mathbf{x}'\> = \sum_{\s}N_{\s}x_{\s}x'_{\s},
      \]
      for any $\mathbf{x},\mathbf{x}' \in \R^{n}$.
    \end{proposition}
    \begin{proof}
      This map is an isomorphism since it is invertible and linear in each component. Since there are $n$ such $\Q$-embeddings $\s$ we see that $K_{\R}$ is an $n$-dimensional vector space over $\R$. We will now prove the statement about the inner product. Let $(z_{\s})_{\s}$ and $(z'_{\s})_{\s}$ be elements of $K_{\R}$ and let $(x_{\s})_{\s}$ and $(x'_{\s})_{\s}$ be the corresponding elements in $\R^{n}$. If $\s = \rho$, then
      \[
        x_{\rho} = z_{\rho} \quad \text{and} \quad x'_{\rho} = z'_{\rho},
      \]
      and thus
      \[
        x_{\rho}x'_{\rho} = z_{\rho}\conj{z'_{\rho}}.
      \]
      If $\s = \tau$, then
      \[
        x_{\tau} = \Re(z_{\tau}), \quad x_{\conj{\tau}} = \Im(z_{\tau}), \quad x'_{\tau} = \Re(z'_{\tau}), \text{and} \quad x'_{\conj{\tau}} = \Im(z'_{\tau}),
      \]
      and hence
      \[
        2(x_{\tau}x'_{\tau}+x_{\conj{\tau}}x'_{\conj{\tau}}) = 2(\Re(z_{\tau})\Re(z'_{\tau})+\Im(z_{\tau})\Im(z'_{\tau})) = 2\Re(z_{\tau}\conj{z'_{\tau}}) = z_{\tau}\conj{z'_{\tau}}+z_{\conj{\tau}}\conj{z'_{\conj{\tau}}}.
      \]
      This proves the claim about the inner product.
    \end{proof}
    
    Define the \textbf{Minkowski embedding}\index{Minkowski embedding} $\s_{K}$ of $K$ by
    \[
      \s_{K}:K \to \R^{n} \qquad \k \to (\rho_{1}(\k),\ldots,\rho_{r_{1}}(k),\Re(\tau_{1}(\k)),\Im(\tau_{1}(\k)),\ldots,\Re(\tau_{r_{2}}(\k)),\Im(\tau_{r_{2}}(\k))),
    \]
    where $\rho_{1},\ldots,\rho_{r_{1}}$ are the real $\Q$-embeddings of $K$ into $\conj{\Q}$ and $\tau_{1},\ldots,\tau_{r_{2}}$ are representatives of pairs of complex $\Q$-embeddings of $K$ into $\conj{\Q}$. The Minkowski embedding $\s_{K}$ is then a $\Q$-embedding of $K$ into $\R^{n}$ since it is the composition of the canonical embedding $j$ (whose image under $K$ is in $K_{\R}$ as we have noted) and the isomorphism established by \cref{prop:Minkowski_space_isomorphism}. It is also independent of the choice of representatives $\tau_{1},\ldots,\tau_{r_{2}}$ since the complex $\Q$-embeddings occur in conjugate pairs. As $j$ is a $\Q$-embedding and any fractional ideal $\mf{f}$ is a complete lattice, $j(\mf{f})$ is a complete lattice in $K_{\R}$. We now determine the covolume of $j(\mf{f})$:

    \begin{proposition}\label{prop:covolume_of_fractional_ideal_under_j}
      Let $K$ be a number field with signature $(r_{1},r_{2})$. Then $V_{j(\mf{f})}$ is the absolute value of the determinant of any embedding matrix for $\mf{f}$. In particular,
      \[
        V_{j(\mf{f})} = \Norm(\mf{f})\sqrt{|\D_{K}|},
      \]
      and
      \[
        V_{j(\mc{O}_{K})} = \sqrt{|\D_{K}|}.
      \]
    \end{proposition}
    \begin{proof}
      The last statement follows from the first two by taking $\mf{f} = \mc{O}_{K}$ so it suffices to prove the first two statements. Let $\k_{1},\ldots,\k_{n}$ be a basis for $\mf{f}$ and let $\s_{1},\ldots,\s_{n}$ be the $n$ distinct $\Q$-embedding of $K$ into $\conj{\Q}$. Then the associated generator matrix $P$ for $j(\mf{f})$ is given by
      \[
        P = \begin{pmatrix} \s_{1}(\k_{1}) & \cdots & \s_{n}(\k_{n}) \\ \vdots & & \vdots & \\ \s_{n}(\k_{1}) & \cdots & \s_{n}(\k_{n}) \end{pmatrix} = M(\k_{1},\ldots,k_{n}),
      \]
      which is an embedding matrix for $\mf{f}$. Hence
      \[
        V_{j(\mf{f})} = |\det(M(\k_{1},\ldots,\k_{n}))|,
      \]
      proving the first statement. We will be done if we can show
      \[
        |\det(M(\k_{1},\ldots,\k_{n}))| = \Norm(\mf{f})|\det(M(\a_{1},\ldots,\a_{n}))|,
      \]
      for any integral basis $\a_{1},\ldots,\a_{n}$, since $|\det(M(\a_{1},\ldots,\a_{n}))| = \sqrt{|\D_{K}|}$. As $\mf{f}$ is a fractional ideal, there exists a nonzero $\d \in \mc{O}_{K}$ and an integral ideal $\mf{a}$ such that
      \[
        \mf{f} = \frac{1}{\d}\mf{a}.
      \]
      Then $\d\k_{1},\ldots,\d\k_{n}$ is a basis for $\mf{a}$. Now 
      \[
        |\det(M(\d\k_{1},\ldots,\d\k_{n}))| = \Norm(\mf{a})|\det(M(\a_{1},\ldots,\a_{n}))|,
      \]
      by \cref{prop:base_change_quotient_determinant} since $\Norm(\mf{a})$ is the absolute value of the determinant of the base change matrix from $\k_{1},\ldots,\k_{n}$ to $\d\k_{1},\ldots,\d\k_{n}$ (from the definition of the norm). Similarly,
      \[
        |\det(M(\d\k_{1},\ldots,\d\k_{n}))| = |\Norm(\d)||\det(M(\k_{1},\ldots,\k_{n}))|,
      \]
      by \cref{prop:base_change_quotient_determinant} because $|\Norm(\d)|$ is the absolute value of the determinant of the base change matrix from $\k_{1},\ldots,\k_{n}$ to $\d\k_{1},\ldots,\d\k_{n}$ (since $\Norm(\d)$ is the determinant of $T_{\d}$). As $\Norm(\mf{f}) = \frac{\Norm(\mf{a})}{|\Norm(\d)|}$ (because $\Norm(\mf{a}) = \Norm(\d\mf{f}) = |\Norm(\d)|\Norm(\mf{a})$ using \cref{prop:residue_of_integral_ideal_is_finite}), these two identities for $|\det(M(\d\k_{1},\ldots,\d\k_{n}))|$ together imply the claim.
    \end{proof}
    
    Now as $\s_{K}$ is also a $\Q$-embedding, $\s_{K}(\mf{f})$ is a complete lattice in $\R^{n}$. As a corollary of \cref{prop:covolume_of_fractional_ideal_under_j}, we can determine the covolume of $\s_{K}(\mf{f})$:
    
    \begin{corollary}\label{cor:covolume_of_fractional_ideal_under_canonical_embedding}
      Let $K$ be a number field with signature $(r_{1},r_{2})$. Then
      \[
        V_{\s_{K}(\mf{f})} = \Norm(\mf{f})\frac{\sqrt{|\D_{K}|}}{2^{r_{2}}}.
      \]
      In particular,
      \[
        V_{\s_{K}(\mc{O}_{K})} = \frac{\sqrt{|\D_{K}|}}{2^{r_{2}}}.
      \]
    \end{corollary}
    \begin{proof}
      The second statement follows from the first by taking $\mf{f} = \mc{O}_{K}$ so it suffices to prove the first statement. Let $\k_{1},\ldots,\k_{n}$ be a basis for $\mf{f}$, $\rho_{1},\ldots,\rho_{r_{1}}$ be the real $\Q$-embeddings of $K$ into $\conj{\Q}$, and $\tau_{1},\ldots,\tau_{r_{2}}$ be a complete set of representatives of pairs of complex $\Q$-embeddings of $K$ into $\conj{\Q}$. Then the associated generator matrix $P$ for $\s_{K}(\mf{f})$ is
      \[
        P = \begin{pmatrix} \rho_{1}(\k_{1}) & \cdots & \rho_{r_{1}}(\k_{1}) & \Re(\tau_{1}(\k_{1})) & \Im(\tau_{1}(\k_{1})) & \cdots & \Re(\tau_{r_{2}}(\k_{1})) & \Im(\tau_{r_{2}}(\k_{1})) \\ \vdots & & \vdots & \vdots & \vdots & & \vdots & \vdots \\ \rho_{1}(\k_{n}) & \cdots & \rho_{r_{1}}(\k_{n}) & \Re(\tau_{1}(\k_{n})) & \Im(\tau_{1}(\k_{n})) & \cdots & \Re(\tau_{r_{2}}(\k_{n})) & \Im(\tau_{r_{2}}(\k_{n})) \end{pmatrix}^{t}.
      \]
      By \cref{prop:covolume_of_fractional_ideal_under_j} we are done if the absolute value of the determinant of this matrix is $2^{-r_{2}}$ times the determinate of an embedding matrix for $\mf{f}$. To show this, first add an $i$ multiple of the imaginary columns to their corresponding real columns and then apply the identity $\Im(z) = \frac{z-\conj{z}}{2i}$ to the imaginary columns to obtain
      \[
        P' = \begin{pmatrix} \rho_{1}(\k_{1}) & \cdots & \rho_{r_{1}}(\k_{1}) & \tau_{1}(\k_{1}) & \frac{\tau_{1}(\k_{1})-\conj{\tau_{1}}(\k_{1})}{2i} & \cdots & \tau_{r_{2}}(\k_{1}) & \frac{\tau_{r_{2}}(\k_{1})-\conj{\tau_{r_{2}}}(\k_{1})}{2i} \\ \vdots & & \vdots & \vdots & \vdots & & \vdots & \vdots \\ \rho_{1}(\k_{n}) & \cdots & \rho_{r_{1}}(\k_{n}) & \tau_{1}(\k_{n}) & \frac{\tau_{1}(\k_{n})-\conj{\tau_{1}}(\k_{n})}{2i} & \cdots & \tau_{r_{2}}(\k_{n}) & \frac{\tau_{r_{2}}(\k_{n})-\conj{\tau_{r_{2}}}(\k_{n})}{2i} \end{pmatrix}^{t}.
      \]
      Since $P'$ differs from $P$ by column addition, their determinants are the same. Multiplying the imaginary columns of $P'$ by $-2i$ and then adding the corresponding columns to annihilate the negative terms results in
      \[
        P'' = \begin{pmatrix} \rho_{1}(\k_{1}) & \cdots & \rho_{r_{1}}(\k_{1}) & \tau_{1}(\k_{1}) &\conj{\tau_{1}}(\k_{1}) & \cdots & \tau_{r_{2}}(\k_{1}) & \conj{\tau_{r_{2}}}(\k_{1}) \\ \vdots & & \vdots & \vdots & \vdots & & \vdots & \vdots \\ \rho_{1}(\k_{n}) & \cdots & \rho_{r_{1}}(\k_{n}) & \tau_{1}(\k_{n}) & \conj{\tau_{1}}(\k_{n}) & \cdots & \tau_{r_{2}}(\k_{n}) & \conj{\tau_{r_{2}}}(\k_{n}) \end{pmatrix}^{t}.
      \]
      As $P''$ differs from $P'$ by column addition and column scaling of which there were $r_{2}$ many of factor $-2i$, the determinant of $P''$ is $(-2i)^{-r_{2}}$ that of $P'$. Altogether,
      \[
        V_{\mf{f}} = |\det(P)| = |\det(P')| = |(-2i)^{-r_{2}}\det(P'')| = 2^{-r_{2}}|\det(P'')|.
      \]
      Since the complex $\Q$-embeddings occur in conjugate pairs and $\k_{1},\ldots,\k_{n}$ is a basis for $K$, we see that $P'' = M(\k_{1},\ldots,\k_{n})$ is an embedding matrix for $\mf{f}$.
    \end{proof}
  \section{The Class Number \& Dirichlet's Unit Theorem}
    Let $K$ be a number field. We will discuss the structure of two important groups associated to $K$: the ideal class group and the unit group. Recall that the ideal group $I_{K}$ is the group of fractional ideals of $K$. We let $P_{K}$ denote the subgroup of $I_{K}$ of principal ideals $\a\mc{O}_{K}$ for nonzero $\a \in K$. Since $I_{K}$ is abelian, $P_{K}$ is normal. The \textbf{ideal class group}\index{ideal class group} $\Cl(K)$ of $K$ is defined to be the quotient group
    \[
      \Cl(K) = I_{K}/P_{K},
    \]
    of fractional ideals modulo principal ideals. We call an element of $\Cl(K)$ an \textbf{ideal class}\index{ideal class} of $K$. The \textbf{class number}\index{class number} $h_{K}$ of $K$ is defined by
    \[
      h_{K} = |\Cl(K)|.
    \]
    The \textbf{unit group}\index{unit group} of $K$ is defined to be $\mc{O}_{K}^{\ast}$. That is, the unit group is the group of units in the ring of integers of $K$. By abuse of language, we call any element $\mc{O}_{K}^{\ast}$ a \textbf{unit}\index{unit} of $K$. That is, a unit in $K$ is precisely an algebraic integer that is invertible in the ring of integers. Note that $\mc{O}_{K}^{\ast}$ is closed under conjugation because $\Norm(\a) = \Norm(\conj{\a})$ as a consequence of \cref{prop:formulas_for_trace_and_norm}. By \cref{cor:unit_if_and_only_if_absolute_value_norm_1}, we can express the unit group as
    \[
      \mc{O}_{K}^{\ast} = \{\e \in \mc{O}_{K}:\Norm(\e) = \pm 1\}.
    \]
    The ideal class group and the unit group of $K$ are related via the exact sequence

    \begin{center}
      \begin{tikzcd}
        1 \arrow{r} & \mc{O}_{K}^{\ast} \arrow{r} & K^{\ast} \arrow{r}{\cdot\mc{O}_{K}} & I_{K} \arrow{r} & \Cl(K) \arrow{r} & 1,
      \end{tikzcd}
    \end{center}

    where the middle map takes any $\k \in K^{\ast}$ to its associated principal ideal $\k\mc{O}_{K}$. Thinking of this map as passing from numbers in $K^{\ast}$ to fractional ideals in $I_{K}$, exactness means that unit group is measuring the contraction (how many numbers are annihilated) taking place during this process while the class group is measuring the expansion (how many fractional ideal are created).
    \subsection*{The Class Number}
      The class number is a measure of how much the ring of integers $\mc{O}_{K}$ fails to be a principal ideal domain. Indeed, if $\mc{O}_{K}$ is a principal ideal domain then every integral ideal is principal and hence every fractional ideal is too (because every fractional ideal $\mf{f}$ is of the form $\frac{1}{\d}\mf{a}$ for some integral ideal $\mf{a}$ and nonzero $\d \in \mc{O}_{K}$). But then $\Cl(K)$ is the trivial group an hence $h_{K} = 1$. Conversely, if $h_{K} = 1$ then every fractional ideal is principal and hence every integral ideal is too so that $\mc{O}_{K}$ is a principal ideal domain. In short, $\mc{O}_{K}$ is a principal ideal domain if and only if $h_{K} = 1$. We will show that the class number is finite:

      \begin{theorem}\label{equ:finitness_of_class_number}
        Let $K$ be a number field of degree $n$ and signature $(r_{1},r_{2})$. Also, let $X \subseteq \R^{n}$ be a compact convex symmetric set and set $M = \max_{\mathbf{x} \in X}\left(\prod_{1 \le i \le n}|x_{i}|\right)$. Then every ideal class contains an integral ideal $\mf{a}$ satisfying
        \[
          \Norm(\mf{a}) \le \frac{2^{r_{1}+r_{2}}M}{\Vol(X)}\sqrt{|\D_{K}|}.
        \]
        Moreover, the ideal class group $\Cl(K)$ is finite so that the class number $h_{K}$ is too.
      \end{theorem}
      \begin{proof}
        Let $\mf{f}$ be a fractional ideal, and set
        \[
          \l^{n} = 2^{n}\frac{V_{\s_{K}(\mf{f}^{-1})}}{\Vol(X)},
        \]
        for any $n \ge 1$. Then by construction,
        \[
          \Vol(\l X) = \l^{n}\Vol(X) = 2^{n}V_{\s_{K}(\mf{f}^{-1})}.
        \]
        By Minkowski's lattice point theorem, there exists a nonzero $\a \in \mf{f}^{-1}$ such that $\s_{K}(\a) \in \s_{K}(\mf{f}^{-1})$ and $\s_{K}(\a) \in \l X$. Since $\a \in \mf{f}^{-1}$, $\a\mf{f} \subseteq \mc{O}_{K}$ so that $\a\mf{f}$ is an integral ideal in the same ideal class as $\mf{f}$. Now let $\s$ run over the $n$ distinct $\Q$-embeddings of $K$ into $\conj{K}$. Since the ideal norm is completely multiplicative, we have
        \[
          \Norm(\a\mf{f}) = |\Norm(\a)|\Norm(\mf{f}) = \left|\prod_{\s}\s(\a)\right|\Norm(\mf{f}) \le \l^{n}M\Norm(\mf{f}),
        \]
        where in the first equality we have applied \cref{prop:residue_of_integral_ideal_is_finite}, in the second we have used \cref{prop:formulas_for_trace_and_norm}, and the inequality follows since $\s_{K}(\a) \in \l X$. This inequality, our choice of $\l^{n}$, and \cref{cor:covolume_of_fractional_ideal_under_canonical_embedding} together give
        \[
          \Norm(\a\mf{f}) \le \l^{n}M\Norm(\mf{f}) = 2^{n}MN(\mf{f})\frac{V_{\s_{K}(\mf{f}^{-1})}}{\Vol(X)} = 2^{n}M\frac{\sqrt{|\D_{K}|}}{2^{r_{2}}\Vol(X)} = \frac{2^{r_{1}+r_{2}}M}{\Vol(X)}\sqrt{|\D_{K}|},
        \]
        which proves the first statement since the fractional ideal $\mf{f}$ was arbitrary. We now prove that the class group is finite. By what we have just proved, we can find a complete set of representatives of $\Cl(K)$ consisting of integral ideals of bounded norm. Since the ideal norm is completely multiplicative, the prime factors of these representatives have bounded norm as well. As we have seen, the norm of a prime integral ideal is exactly the prime $p$ below it. Thus the norms of these prime factors are bounded primes $p$. As there are finitely many prime integral ideals above any prime $p$ (because $p\mc{O}_{K}$ factors into a product of prime integral ideals and these are exactly the prime integral ideals above $p$), it follows that these representatives have finitely many prime factors. Altogether this means that there are finitely many representatives. Hence $\Cl(K)$ is finite and so the class number $h_{K}$ is too.
      \end{proof}

      We would like to obtain an explicit bound in \cref{equ:finitness_of_class_number} by making a choice for the set $X$. To obtain a bound that is not too large, we need to ensure that the volume of $X$ is large while the constant $M$ is small. The following lemma dictates our choice of $X$ and computes its volume:

      \begin{lemma}\label{lem:Minkowski_bound_lemma}
        Suppose $n$ is a positive integer and write $n = r_{1}+2r_{2}$ for some nonnegative integers $r_{1}$ and $r_{2}$. Let $X \subset \R^{n}$ to be the compact convex symmetric set given by
        \[
          X = \left\{\mathbf{x} \in \R^{n}:\sum_{1 \le i \le r_{1}}|x_{i}|+2\sum_{\substack{1 \le j \le r_{2} \\ j \equiv 1 \tmod{2}}}\sqrt{x_{r_{1}+j}^{2}+x_{r_{1}+j+1}^{2}} \le n\right\}.
        \]
        Then
        \[
          \Vol(X) = \frac{n^{n}}{n!}2^{r_{1}}\left(\frac{\pi}{2}\right)^{r_{2}}.
        \]
      \end{lemma}
      \begin{proof}
        Making the change of variables $x_{r_{1}+j} \to u_{j}\sin(\t_{j})$ and $x_{r_{1}+j+1} \to u_{j}\cos(\t_{j})$ for all $j$ gives
        \[
          \Vol(X) = \int_{X'}u_{1} \cdots u_{r_{2}}\,dx_{1} \cdots dx_{r_{1}}\,du_{1}\t_{1} \cdots du_{r_{2}}\t_{r_{2}},
        \]
        where
        \[
          X' = \left\{(x_{1},\ldots,x_{r_{1}},u_{1},\t_{1},\ldots,u_{r_{2}},\t_{r_{2}}):\sum_{1 \le i \le r_{1}}|x_{i}|+2\sum_{1 \le j \le r_{2}}u_{j} \le n\right\}.
        \]
        Since the integrand is independent of the $\t_{j}$, we have
        \[
          \Vol(X) = (2\pi)^{r_{2}}\int_{X'}u_{1} \cdots u_{r_{2}}\,dx_{1} \cdots dx_{r_{1}}\,du_{1} \cdots du_{r_{2}}.
        \]
        Making the change of variables $u_{j} \to \frac{u_{j}}{2}$ for all $j$ and using the fact that the integrand is symmetric in the $x_{i}$ for all $i$ gives
        \begin{equation}\label{equ:Minkowski_bound_lemma_1}
          \Vol(X) = 2^{r_{1}}\left(\frac{\pi}{2}\right)^{r_{2}}\int_{X''}u_{1} \cdots u_{r_{2}}\,dx_{1} \cdots dx_{r_{1}}\,du_{1} \cdots du_{r_{2}},
        \end{equation}
        where
        \[
          X'' = \left\{(x_{1},\ldots,x_{r_{1}},u_{1},\ldots,u_{r_{2}}):\sum_{1 \le i \le r_{1}}x_{i}+\sum_{1 \le j \le r_{2}}u_{j} \le n\right\}.
        \]
        To compute the remaining integral, for nonnegative integers $\ell$ and $k$ and $t \ge 0$, we let
        \[
          X''_{\ell,k}(t) = \left\{(x_{1},\ldots,x_{\ell},u_{1},\ldots,u_{k}):\sum_{1 \le i \le \ell}x_{i}+\sum_{1 \le j \le k}u_{j} \le t\right\},
        \]
        and set 
        \[
          I_{\ell,k}(t) = \int_{X''_{\ell,k}(t)}u_{1} \cdots u_{\ell}\,dx_{1} \cdots dx_{n}\,du_{1} \cdots du_{k}.
        \]
        Then we have to compute $I_{r_{1},r_{2}}(n)$. To this end, the change of variables $x_{i} \to tx_{i}$ and $u_{j} \to tu_{j}$ for all $i$ and $j$ gives
        \begin{equation}\label{equ:Minkowski_bound_lemma_2}
          I_{\ell,k}(t) = t^{\ell+2k}I_{\ell,k}(1).
        \end{equation}
        Now note that the condition
        \[
          \sum_{1 \le i \le \ell}x_{i}+\sum_{1 \le j \le k}u_{j} \le t,
        \]
        is equivalent to
        \[
          \sum_{1 \le i \le \ell-1}x_{i}+\sum_{1 \le j \le k}u_{j} \le t-x_{i}.
        \]
        This fact together with Fubini's theorem and \cref{equ:Minkowski_bound_lemma_2} give
        \[
          I_{\ell,k}(1) = \int_{0}^{1}I_{\ell-1,k}(1-x_{\ell})\,dx_{\ell} = \int_{0}^{1}(1-x_{\ell})^{\ell-1+2k}I_{\ell-1,k}(1)\,dx_{\ell} = \frac{1}{\ell+2k}I_{\ell-1,k}(1).
        \]
        Repeating this procedure $\ell-1$ times results in
        \begin{equation}\label{equ:Minkowski_bound_lemma_3}
          I_{\ell,k}(1) = \frac{1}{(\ell+2k) \cdots (2k+1)}I_{0,k}(1).
        \end{equation}
        Similarly, the condition
        \[
          \sum_{1 \le j \le k}u_{j} \le t,
        \]
        is equivalent to
        \[
          \sum_{1 \le j \le k-1}u_{j} \le t-u_{k}.
        \]
        This fact together with Fubini's theorem, \cref{equ:Minkowski_bound_lemma_2}, and \cref{prop:integral_reprepsentation_for_beta_function} give
        \[
          I_{0,k}(1) = \int_{0}^{1}u_{k}I_{0,k-1}(1-u_{k})\,du_{k} = \int_{0}^{1}u_{k}(1-u_{k})^{2k-2}I_{0,k-1}(1)\,du_{k} = B(1,2k-1)I_{0,k-1}(1) = \frac{1}{2k}I_{0,k-1}(1).
        \]
        Repeating this procedure $k-1$ times results in
        \begin{equation}\label{equ:Minkowski_bound_lemma_4}
          I_{0,k}(1) = \frac{1}{k!},
        \end{equation}
        since $I_{0,0}(1) = 1$. Combining \cref{equ:Minkowski_bound_lemma_2,equ:Minkowski_bound_lemma_3,equ:Minkowski_bound_lemma_4} we find that
        \[
          I_{\ell,k}(t) = t^{\ell+2k}\frac{1}{(\ell+2k)!}.
        \]
        In particular, $I_{r_{1},r_{2}}(n) = \frac{n^{n}}{n!}$ and from \cref{equ:Minkowski_bound_lemma_1} we obtain
        \[
          \Vol(X) = \frac{n^{n}}{n!}2^{r_{1}}\left(\frac{\pi}{2}\right)^{r_{2}},
        \]
        as desired.
      \end{proof}

      Observe that the set $X$ in \cref{lem:Minkowski_bound_lemma} just consists of those points in $\R^{n}$ whose induced norm corresponding to the induced Minkowski inner product is at most $n$ (recall \cref{prop:Minkowski_space_isomorphism}). We can now obtain an explicit bound in \cref{equ:finitness_of_class_number} known as the \textbf{Minkowski bound}\index{Minkowski bound}:

      \begin{theorem}[Minkowski bound]
        Let $K$ be a number field of degree $n$ and signature $(r_{1},r_{2})$. Then every ideal class contains an integral ideal $\mf{a}$ satisfying
        \[
          \Norm(\mf{a}) \le \left(\frac{4}{\pi}\right)^{r_{2}}\frac{n!}{n^{n}}\sqrt{|\D_{K}|}.
        \]
      \end{theorem}
      \begin{proof}
        Let $X$ be given by
        \[
          X = \left\{\mathbf{x} \in \R^{n}:\sum_{1 \le i \le r_{1}}|x_{i}|+2\sum_{\substack{1 \le j \le r_{2} \\ j \equiv 1 \tmod{2}}}\sqrt{x_{r_{1}+j}^{2}+x_{r_{1}+j+1}^{2}} \le n\right\}.
        \]
        Then \cref{equ:finitness_of_class_number,lem:Minkowski_bound_lemma} together give
        \[
          \Norm(\mf{a}) \le M\left(\frac{4}{\pi}\right)^{r_{2}}\frac{n!}{n^{n}}\sqrt{|\D_{K}|},
        \]
        where $M = \max_{\mathbf{x} \in X}\left(\prod_{1 \le \ell \le n}|x_{\ell}|\right)$. But for all $\mathbf{x} \in X$, the arithmetic-geometric mean inequality gives
        \[
          \left(\prod_{1 \le \ell \le n}|x_{\ell}|\right)^{\frac{1}{n}} \le \frac{1}{n}\sum_{1 \le \ell \le n}|x_{\ell}| \le 1,
        \]
        where the second inequality holds by the definition of $X$. Hence $M \le 1$ and this completes the proof.
      \end{proof}

      As a corollary we can obtain a lower bound for the discriminant of a number field and show that every number field other than $\Q$ has at least one ramified prime:

      \begin{corollary}
        Let $K$ be a number field of degree $n$. Then
        \[
          |\D_{K}| \ge \left(\frac{\pi}{4}\right)^{\frac{n}{2}}\frac{n^{n}}{n!}.
        \]
        In particular, every number field of degree at least $2$ contains at least one ramified prime.
      \end{corollary}
      \begin{proof}
        Since the norm of every integral ideal is at least $1$, $\pi < 4$, and $r_{2}$ is at most $n$, the desired inequality follows immediately from Minkowski's bound. Now suppose $n \ge 2$. In the case $n = 2$, the lower bound is larger than $1$ so that $|\D_{K}|$ is at least $2$ for every quadratic number field. As $n^{n} \ge n!$ for all $n \ge 1$ (which easily follows by induction), $\left(\frac{\pi}{4}\right)^{\frac{n}{2}}\frac{n^{n}}{n!}$ is an increasing function in $n$. Therefore $|\D_{K}| \ge 2$ for all $n \ge 2$ so that $|\D_{K}|$ has a prime divisor. Then \cref{thm:ramification_division_equivalence} implies that at least one prime is ramified in $K$.
      \end{proof}

      Generally speaking, the class number $h_{K}$ is one of the most difficult pieces of arithmetic data about $K$ to compute. For example, it is still unknown if there are infinitely many number fields of class number $1$ (that is, number fields such that their ring of integers are principal ideal domains).
    \subsection*{Dirichlet's Unit Theorem}
      Let $K$ be a number field of degree $n$ and signature $(r_{1},r_{2})$. We define the \textbf{rank}\index{rank} $r_{K}$ of $K$ to be
      \[
        r_{K} = r_{1}+r_{2}-1.
      \]
      Another very important piece of arithmetic data about a number field $K$ other than its class number is the structure of $\mc{O}_{K}^{\ast}$. Let $\W$ denote the group of all roots of unity. We will set $\mu(K) = \mc{O}_{K}^{\ast} \cap \W$ so that $\mu(K)$ is the subgroup of $\mc{O}_{K}^{\ast}$ consisting of all of the roots of unity in $K$. Clearly $\{\pm 1\} \subseteq \mu(K)$. In fact, $\mu(K)$ is finite since any root of unity in $K$ is a root of $x^{n}-1$ and thus an $n$-th root of unity. We set
      \[
        w_{K} = |\mu(K)|.
      \]
      Our goal will be to show that $\mc{O}_{K}^{\ast}$ is a direct product of $\mu(K)$ and a free abelian group of rank $r_{K}$. Determining that the rank of the free group is exactly $r_{K}$ will be the most difficult part of the proof. We will require a map on $K^{\ast}$ that transitions between the field trace and the field norm. Let $\rho_{1},\ldots,\rho_{r_{1}}$ be the real $\Q$-embeddings of $K$ into $\conj{\Q}$ and let $\tau_{1},\ldots,\tau_{r_{2}}$ be a complete set of representatives of pairs of complex $\Q$-embeddings of $K$ into $\conj{\Q}$. First consider the map
      \[
        \ell:K_{\R}^{\ast} \to \R^{r_{K}+1} \qquad (\log|z_{\rho_{1}}|,\ldots,\log|z_{\rho_{r_{1}}}|,\log|z_{\tau_{1}}|^{2},\ldots,\log|z_{\tau_{r_{2}}}|^{2}).
      \]
      This map is independent of the choice of representatives $\tau_{1},\ldots,\tau_{r_{2}}$ because $z_{\conj{\tau}} = \conj{z_{\tau}}$ for $\mathbf{z} \in K_{\R}$.
      We define the \textbf{logarithmic embedding}\index{logarithmic embedding} $\log_{K}$ of $K$ by
      \[
        \log_{K}:K^{\ast} \to \R^{r_{K}+1} \qquad \k \to (\log|\rho_{1}(\k)|,\ldots,\log|\rho_{r_{1}}(\k)|,\log|\tau_{1}(\k)|^{2},\ldots,\log|\tau_{r_{2}}(\k)|^{2}).
      \]
      Then $\log_{K}$ is just the restriction of $j$ to $K^{\ast}$ composed with $\ell$. Since $\ell$ is a homomorphism and $j$ is a $\Q$-embedding, $\log_{K}$ is a homomorphism. We distinguish the subsets
      \[
        S = \{\mathbf{x} \in  \R_{+}^{r_{K}+1}:\Norm_{\R^{r_{K}+1}/\R}(\mathbf{x}) = 1\} \quad \text{and} \quad H = \{\mathbf{x} \in \R^{r_{K}+1}:\Trace_{\R^{r_{K}+1}/\R}(\mathbf{x}) = 0\},
      \]
      called the \textbf{norm-one hypersurface}\index{norm-one hypersurface} and \textbf{trace-zero hyperplane}\index{trace-zero hyperplane} of $\R^{r_{K}+1}$ respectively. Note that $H$ is an $r_{K}$-dimensional subspace of $\R^{r_{K}+1}$. We will also make use of the subset
      \[
        U = \{\mathbf{z} \in K_{\R}:\Norm_{K_{\R}}(\mathbf{z}) = \pm 1\}.
      \]
      Let $\l$ denote the restriction of $\log_{K}$ to $\mc{O}_{K}^{\ast}$ and set
      \[
        \L = \log_{K}(\mc{O}_{K}^{\ast}),
      \]
      so that $\L$ is the image of $\l$. We call $\L$ the \textbf{unit lattice}\index{unit lattice} of $K$. It is not immediately obvious that $\L$ is a lattice, but we will show this and more. Observe that $\ell$ takes $U$ into $H$ since $\Trace_{\R^{r_{K}+1}/\R}(\ell(\mathbf{z})) = \log|\Norm_{K_{\R}}(\mathbf{z})| = 1$. In particular, $\L \subset H$ since $j(\mc{O}_{K}^{\ast}) \subset U$. All of this data can be collected into the following commutative diagram:

      \begin{center}
        \begin{tikzcd}
          \mc{O}_{K}^{\ast} \arrow{d} \arrow{r}{j} \arrow[bend left]{rr}{\log_{K}} & U \arrow{d} \arrow{r}{\ell} & H \arrow{d} \\
          K^{\ast} \arrow{d}{\Norm} \arrow{r}{j} & K_{\R} \arrow{d}{\Norm_{K_{\R}}}^{\ast} \arrow{r}{\ell} & \R^{r_{K}+1} \arrow{d}{\Trace_{\R^{r_{K}+1}/\R}} \\
          \Q^{\ast} \arrow{r} & \R^{\ast} \arrow{r}{\log|\cdot|} & \R.
        \end{tikzcd}
      \end{center}
      
      We first show that the logarithmic embedding fits into an exact sequence:

      \begin{proposition}\label{prop:exact_sequence_for_Dirichlets_unit_theorem}
        Let $K$ be a number field. Then the sequence

        \begin{center}
          \begin{tikzcd}
            1 \arrow{r} & \mu(K) \arrow{r} & \mc{O}_{K}^{\ast} \arrow{r}{\l} & \L \arrow{r} & 0,
          \end{tikzcd}
        \end{center}

        is exact.
      \end{proposition}
      \begin{proof}
        Exactness of this sequence means that $\mu(K)$ is the kernel of $\l$. If $\w \in \mu(K)$, then $|\w| = 1$ and it follows that $\l(\w) = 0$. Therefore $\ker\l$ contains $\mu(K)$. To see that this is all of $\ker\l$, suppose $\e \in \mc{O}_{K}^{\ast}$ is such that $\l(\e) = 0$. But then every component of $j(\e)$ is has absolute value $1$ and therefore belongs to a bounded subset of the Minkowski space $K_{\R}$. Since $\mc{O}_{K}^{\ast}$ is a subgroup of $\mc{O}_{K}$ and $j(\mc{O}_{K})$ is a complete lattice in $K_{\R}$ (as we have already remarked), $j(\mc{O}_{K}^{\ast})$ is a lattice in $K_{\R}$. But then $j(\e)$ belongs to a discrete set by \cref{prop:lattice_if_and_only_if_discrete_subgroup}. Together, $j(\e)$ belongs to a discrete and bounded set and hence is necessarily finite. Since $j$ is a $\Q$-embedding, it follows that the subgroup $\ker\l$ of $\mc{O}_{K}^{\ast}$ contains finitely many elements and hence only roots of unity because $\ker\l \subset K \subset \C$. Thus $\ker\l = \mu(K)$.
      \end{proof}

      Our aim now is to show that the unit lattice $\L$ is a a free abelian group of rank $r_{K}$. For this, we will require a lemma:

      \begin{lemma}\label{lem:finitely_many_elements_of_fixed_norm}
        Let $K$ be a number field. There are finitely many elements in $\mc{O}_{K}$ of a given norm up to multiplication by units.
      \end{lemma}
      \begin{proof}
        Recall that the norm of an algebraic integer is an integer by \cref{cor:norm_and_trace_of_algebraic_integers} and that the elements of norm $\pm1$ are exactly the units by \cref{cor:unit_if_and_only_if_absolute_value_norm_1}. Therefore it suffices to prove the claim for norm $n \ge 2$ (the norm is only zero for zero itself). Further recall that $\mc{O}_{K}/n\mc{O}_{K}$ is finite by \cref{prop:residue_of_integral_ideal_is_finite}. Therefore, it suffices to show that in each coset there is at most one element of norm $n$ up to multiplication by units. To show this, suppose $\a$ and $\b$ are two representatives in the same class are are of norm $n$. Writing $\a = \b+n\g$ for some $n\g \in n\mc{O}_{K}$, we have
        \[
          \frac{\a}{\b} = 1+\frac{n}{\b}\g = 1+\frac{\Norm(\b)}{\b}\g,
        \]
        which is an element of $\mc{O}_{K}$ because $\frac{\Norm(\b)}{\b}$ is since $N(\b) \in \b\mc{O}_{K}$ as any integral ideal contains it norm. Hence $\frac{\a}{\b} \in \mc{O}_{K}$, and interchanging the roles of $\a$ and $\b$ shows that $\frac{\b}{\a} \in \mc{O}_{K}$ too. But then $\frac{\a}{\b}$ is a unit in $\mc{O}_{K}$ and thus $\a$ and $\b$ differ up to multiplication by a unit.
      \end{proof}

      Recall that $\L \subset H$. We will show $\L$ is a lattice in $H$, actually a complete lattice, and compute its rank as a free abelian group:

      \begin{theorem}\label{thm:unit_group_complete_lattice}
        Let $K$ be a number field of degree $n$ and signature $(r_{1},r_{2})$. Then the unit lattice $\L$ is a complete lattice in the trace-zero hyperplane $H$ of $\R^{r_{K}+1}$. In particular, $\L$ is a free abelian group of rank $r_{K}$.
      \end{theorem}
      \begin{proof}
        Throughout, let $\s$ run over the $n$ distinct $\Q$-embeddings of $K$ into $\conj{\Q}$, $\rho$ run over all such real $\Q$-embeddings, and $\tau$ run over a complete set of representatives of all such pairs of complex $\Q$-embeddings. We first prove $\L$ is a lattice in $H$. Since $\l$ is a homomorphism (because $\log_{K}$ is), $\L$ is a subgroup of $H$. So by \cref{prop:lattice_if_and_only_if_discrete_subgroup}, $\L$ is a lattice if and only if it is discrete. In particular, we will show that for any $c > 0$, the bounded region
        \[
          X = \{\mathbf{x} \in \R^{r_{K}+1}:\text{$|x_{\rho}| \le c$ and $|x_{\tau}| \le 2c$ for all $\rho$ and $\tau$}\},
        \]
        contains only finitely many points of $\L$. The preimage of $X$ under $\ell$ is
        \[
          \ell^{-1}(X) = \{\mathbf{z} \in K_{\R}:\text{$e^{-c} \le |z_{\s}| \le e^{c}$ for all $\s$}\},
        \]
        and hence it contains finitely many points of $j(\mc{O}_{K}^{\ast})$ because this is a subset of the lattice $j(\mc{O}_{K})$. It follows that $X$ contains finitely many points of $\L$ (as the preimage of $\mathbf{x}$ in $\R^{n}$ under $\ell$ contains $2^{n}$ points of $K_{\R}$) so that $\L$ is discrete and thus a lattice. We will now show that $\L$ is a complete lattice in $H$ and since $H$ is an $r_{K}$-dimensional vector space over $\R$, this will also prove the claim about the rank of $\L$. By \cref{prop:complete_lattice_if_and_only_if_bounded_translates_cover} it suffices to show that there is a bounded subset $M$ of the trace-zero hyperplane $H$ whose translates by $\L$ cover $H$. Actually, since $\ell$ is surjective it suffices to construct a bounded subset $T$ of $U$ such that
        \[
          U = \bigcup_{\e \in \mc{O}_{K}^{\ast}}j(\e)T.
        \]
        Indeed, if such $T$ exists then any $\mathbf{z} \in T$ satisfies $|\Norm_{K_{\R}}(\mathbf{z})| = \prod_{\s}|z_{\s}| = 1$ and hence each $z_{\s}$ is bounded above and away from zero because $T$ is bounded. Setting $M = \ell(T)$, it follows that $M$ is also bounded (because $\log|z|$ is continuous) and
        \[
          H = \bigcup_{\l}(M+\l).
        \]
        It now suffices to construct such a subset $T$. For every $\s$, fix constants $c_{\s} > 0$ satisfying
        \[
          c_{\s} = c_{\conj{\s}} \quad \text{and} \quad \prod_{\s}c_{\s} > \left(\frac{2}{\pi}\right)^{r_{2}}\sqrt{|D_{K}|},
        \]
        and set $C = \prod_{\s}c_{\s}$. Now consider the bounded subset
        \[
          Z = \{\mathbf{z} \in K_{\R}:\text{$|z_{\s}| < c_{\s}$ for all $\s$}\}.
        \]
        For any $\mathbf{w} \in U$, we have
        \[
          \mathbf{w}Z = \{\mathbf{z} \in K_{\R}:\text{$|z_{\s}| < |w_{\s}|c_{\s}$ for all $\s$}\},
        \]
        and $\prod_{\s}|w_{\s}|c_{\s} = \Norm_{K_{\R}}(\mathbf{w})C = C$ so that $\mathbf{w}Z$ is also bounded. By \cref{prop:Minkowski_space_isomorphism}, the volume of $\mathbf{w}Z$ is $2^{r_{2}}$ times the volume of
        \[
          X = \{\mathbf{x} \in \R^{n}:\text{$|x_{\rho}| < c_{\rho}$ and $x_{\tau}^{2}+x_{\conj{\tau}}^{2} < c_{\tau}^{2}$ for all $\rho$ and $\tau$}\},
        \]
        which is $\prod_{\rho}(2c_{\rho})\prod_{\tau}(\pi c_{\tau}^{2}) = C2^{r_{1}}\pi^{r_{2}}$ because $X$ is the product of $r_{1}$ many intervals each of length $2c_{\rho}$ and $r_{2}$ many disks each of of radius $c_{\tau}$. Thus $\Vol(\mathbf{w}Z) = C2^{r_{K}+1}\pi^{r_{2}}$. By \cref{prop:covolume_of_fractional_ideal_under_j}, $V_{j(\mc{O}_{K})} = \sqrt{|D_{K}|}$ and our choice of $C$ gives
        \[
          \Vol(\mathbf{w}Z) > 2^{n}V_{j(\mc{O}_{K})}.
        \]
        Since $j(\mc{O}_{K})$ is a complete lattice in $K_{\R}$, Minkowski's lattice point theorem implies that there exists some nonzero $\a \in \mc{O}_{K}$ such that $j(\a) \in \mathbf{w}Z$. Now by \cref{lem:finitely_many_elements_of_fixed_norm}, there exist finitely many nonzero elements $\a_{1},\ldots,\a_{m}$ of $\mc{O}_{K}$ such that every $\a \in \mc{O}_{K}$ with $0 < \Norm(\a) \le C$ is equal to $\a_{i}$ for some $1 \le i \le m$ by multiplying by a unit. Set
        \[
          T = U \cap \left(\bigcup_{1 \le i \le m}j(\a_{i})^{-1}Z\right).
        \]
        Then $T$ is a bounded subset of $U$ since $Z$ is a bounded subset of $K_{\R}$ (and thus the $j(\a_{i})^{-1}Z$ are too). We now claim that
        \[
          U = \bigcup_{\e \in \mc{O}_{K}^{\ast}}j(\e)T.
        \]
        Indeed, since $\mathbf{w}^{-1} \in U$ for any $\mathbf{w} \in U$  we have shown implies that there exists a nonzero $\a \in \mc{O}_{K}$ such that $j(\a) \in \mathbf{w}^{-1}Z$. Hence $j(\a) = \mathbf{w}^{-1}\mathbf{z}$ for some $\mathbf{z} \in Z$. But as
        \[
          |\Norm(\a)| = |\Norm_{K_{\R}}(j(\a))| = |\Norm_{K_{\R}}(\mathbf{w}^{-1}\mathbf{z})| = |\Norm_{K_{\R}}(\mathbf{z})| < C,
        \]
        it follows that there exists an $\a_{i}$ and $\e \in \mc{O}_{K}^{\ast}$ such that $\a_{i} = \a\e$. Writing $\mathbf{w} = j(\a)^{-1}\mathbf{z}$ (recall that $K_{\R}$ is commutative), we have 
        \[
          \mathbf{w} = j(\a)^{-1}\mathbf{z} = j(\a_{i}\e^{-1})^{-1}\mathbf{z} = j(\e)j(\a_{i})^{-1}\mathbf{z},
        \]
        where the last equality holds because $j$ is a $\Q$-embedding. As $\mathbf{w},j(\e) \in U$, we see that $j(\a_{i})^{-1}\mathbf{z} \in U$ and thus $j(\a_{i})^{-1}\mathbf{z} \in T$. But then $\mathbf{w} \in j(\e)T \subset U$ as desired.
      \end{proof}

      By \cref{thm:unit_group_complete_lattice}, there exist elements $\e_{1},\ldots,\e_{r_{K}}$ of $\mc{O}_{K}^{\ast}$ such that $\l(\e_{1}),\ldots,\l(\e_{r_{K}})$ is a basis for the unit lattice $\L$ by taking the preimage under $j$ of any basis for $\L$. We say that $\e_{1},\ldots,\e_{r_{K}}$ are a \textbf{system of fundamental units}\index{system of fundamental units} of $K$ and we call any such element a \textbf{fundamental unit}\index{fundamental unit} for $K$. The structure theorem for $\mc{O}_{K}^{\ast}$ known as \textbf{Dirichlet's unit theorem}\index{Dirichlet's unit theorem} says that any unit of $K$ is a product of a root of unity in $K$ and powers of fundamental units:

      \begin{theorem}[Dirichlet's unit theorem]
        Let $K$ be a number field of signature $(r_{1},r_{2})$. Then
        \[
          \mc{O}_{K}^{\ast} \cong \mu(K) \x \Z^{r_{K}}.
        \]
        In particular, if $\e_{1},\ldots,\e_{r_{K}}$ is a system of fundamental units for $K$, then any unit $\e$ of $K$ is of the form
        \[
          \e = \w\e_{1}^{\nu_{1}} \cdots \e_{r_{K}}^{\nu_{r_{K}}},
        \]
        for some $\w \in \mu(K)$ and $\nu_{i} \in \Z$ for $1 \le i \le r_{K}$.
      \end{theorem}
      \begin{proof}
        By \cref{prop:exact_sequence_for_Dirichlets_unit_theorem} we have an exact sequence

        \begin{center}
          \begin{tikzcd}
            1 \arrow{r} & \mu(K) \arrow{r} & \mc{O}_{K}^{\ast} \arrow{r}{\l} & \L \arrow{r} & 0,
          \end{tikzcd}
        \end{center}

        and by \cref{thm:unit_group_complete_lattice} we know that $\L$ is a free abelian group of rank $r_{K}$. Let $\e_{1},\ldots,\e_{r_{K}}$ be a system of fundamental units for $K$ and let $E$ be the subgroup of $\mc{O}_{K}^{\ast}$ generated by them. Then $\l$ induces an isomorphism between $E$ and $\L$ so that $\mu(K) \cap E = \{1\}$ because the sequence is exact. Therefore $\mc{O}_{K}^{\ast} \cong \mu(K) \x E$. Since $E \cong \Z^{r_{K}}$ (because $\L$ is) and any element of $E$ is of the form $\e_{1}^{\nu_{1}} \cdots \e_{r_{K}}^{\nu_{r_{K}}}$ with $\nu_{i} \in \Z$ for $1 \le i \le r_{K}$, the proof is complete.
      \end{proof}

      We will now discuss the covolume $V_{\L}$ of the complete lattice $\L$ (by \cref{thm:unit_group_complete_lattice}). Let $\e_{1},\ldots,\e_{r_{K}}$ be a system of fundamental units for $K$. Then $\l(\e_{1}),\ldots,\l(\e_{r_{K}})$ is a basis for $\L$. Setting
      \[
        \l_{0} = \frac{1}{\sqrt{r_{K}+1}}\mathbf{1},
      \]
      we see that $\l_{0}$ is a unit vector in $\R^{r_{K}+1}$ since $||\mathbf{1}|| = r_{K}+1$ and is orthogonal to $H$ because $\Trace_{\R^{r_{K}+1}/\R}(\l_{0}) = \sqrt{r_{K}+1}$ is nonzero. As $\l_{0}$ is orthogonal to $\L \subset H$, $\l_{0},\l(\e_{1}),\ldots,\l(\e_{r_{K}})$ is a basis for the complete lattice $\L' = \Z\l_{0}+\L$ in $\R^{r_{K}+1}$. Since $\l_{0}$ is a unit vector, the volume of the fundamental domain for $\L'$ in $\R^{r_{K}+1}$ is equal to the volume of the fundamental domain for $\L$ in $\H$. By \cref{prop:covolume_equals_volume_of_fundamental_domain}, the corresponding covolumes are equal which is to say $V_{\L} = V_{\L'}$. So it suffices to compute $V_{\L'}$. The generator matrix $P$ for $\L'$ associated to the basis $\l_{0},\l(\e_{1}),\ldots,\l(\e_{r_{K}})$ is given by
      \[
        P = \begin{pmatrix} \frac{1}{\sqrt{r_{K}+1}} & \l(\e_{1})_{1} & \cdots & \l(\e_{r_{K}})_{1} \\ \vdots & \vdots & & \vdots \\ \frac{1}{\sqrt{r_{K}+1}} & \l(\e_{1})_{r_{K}+1} & \cdots & \l(\e_{r_{K}})_{r_{K}+1} \end{pmatrix}.
      \]
      Adding all of the rows to a fixed row results in
      \[
        P' = \begin{pmatrix} \frac{1}{\sqrt{r_{K}+1}} & \l(\e_{1})_{1} & \cdots & \l(\e_{r_{K}})_{1} \\ \vdots & \vdots & & \vdots \\ \sqrt{r_{K}+1} & 0 & & 0 \\ \vdots & \vdots & & \vdots \\ \frac{1}{\sqrt{r_{K}+1}} & \l(\e_{1})_{r_{K}+1} & \cdots & \l(\e_{r_{K}})_{r_{K}+1} \end{pmatrix},
      \]
      because $\l(\e) \in H$ for all $\e \in \mc{O}_{K}^{\ast}$. As $P'$ differs from $P$ be row addition, their determinants are the same. Cofactor expanding along the row with all zeros except the first entry, and that this row is arbitrary, shows that
      \begin{equation}\label{equ:covolume_of_unit_lattice}
        V_{\L} = \sqrt{r_{K}+1}R_{K},
      \end{equation}
      where $R_{K}$ is the absolute value of the determinant of any rank $r_{K}$ minor of
      \[
        \begin{pmatrix} \l(\e_{1})_{1} & \cdots & \l(\e_{r_{K}})_{1} \\ \vdots & & \vdots \\ \l(\e_{1})_{r_{K}+1} & \cdots & \l(\e_{r_{K}})_{r_{K}+1}  \end{pmatrix}.
      \]
      We call $R_{K}$ the \textbf{regulator}\index{regulator} of $K$. Since $V_{\L}$ is independent of the choice of basis, the regulator $R_{K}$ is independent of any choice of a system of fundamental units for $K$. Moreover, since $H$ is a real inner product space we see that the regulator is roughly a measure of the density of the fundamental units in $K$ (recall \cref{prop:covolume_equals_volume_of_fundamental_domain}). The smaller the regulator the more dense the fundamental units are.
  \section{Quadratic Number Fields}
    We will now classify and discuss the structure of quadratic number fields. We first show that quadratic number fields are exactly those where we adjoint the square-root of a fundamental discriminant:

    \begin{proposition}\label{prop:classification_of_quadratic_number_fields}
      Every quadratic number field $K$ is of the form $K = \Q(\sqrt{d})$ for some square-free integer $d$ other than $0$ or $1$.
    \end{proposition}
    \begin{proof}
      Suppose $K$ is a quadratic number field. In particular, $K/\Q$ is separable so by the primitive element theorem there exists $\t \in K$ such that $K = \Q(\t)$. The minimal polynomial $m_{\t}(x)$ of $\t$ is of the form
      \[
        m_{\t}(x) = x^{2}+ax+b,
      \]
      for $a,b \in \Q$. Then the quadratic formula gives
      \[
        \t = -\frac{a}{2}\pm\frac{\sqrt{q}}{2},
      \]
      where $q = a^{2}-4b \in \Q$. Clearly $q \neq 0$ and $q \neq 1$ for otherwise $\t \in \Q$. It follows that $K = \Q(\sqrt{q})$. Write $q = \frac{n}{m}$ for relatively prime $n,m \in \Z$ and set $d = m^{2}q = nm \in \Z$. Then $d$ is square-free, $d \neq 0$, and $d \neq 1$. Moreover, $\sqrt{d} = m\sqrt{q}$ so that $K = \Q(\sqrt{d})$. 
    \end{proof}

    From \cref{prop:classification_of_quadratic_number_fields}, we see that the $d$ for a quadratic number field $\Q(\sqrt{d})$ satisfies $d \equiv 1,2,3 \tmod{4}$ (otherwise $d$ is not square-free). Moreover, any element of a quadratic number field is of the form $a+b\sqrt{d}$ with $a,b \in \Q$ and for some square-free $d$ other than $0$ or $1$. We say that a quadratic number field $\Q(\sqrt{d})$ is \textbf{real}\index{real} if $d > 0$ and \textbf{imaginary}\index{imaginary} if $d < 0$. Now $\Q(\sqrt{d})$ is real or imaginary according to if $\sqrt{d}$ is real or purely imaginary so that the two $\Q$-embeddings $\s_{1}$ and $\s_{2}$ of $\Q(\sqrt{d})$ into $\C$ are
    \[
      \s_{1}(a+b\sqrt{d}) = a+b\sqrt{d} \quad \text{and} \quad \s_{2}(a+b\sqrt{d}) = a-b\sqrt{d},
    \]
    because the roots of the minimal polynomial for $\sqrt{d}$ are $\pm\sqrt{d}$. In particular, the signature is $(2,0)$ or $(0,1)$ according to if $\Q(\sqrt{d})$ is real or imaginary. In either case, \cref{prop:formulas_for_trace_and_norm} shows that the trace and norm of $\k = a+b\sqrt{d} \in \Q(\sqrt{d})$ are given by
    \[
      \Trace(\k) = 2a \quad \text{and} \quad \Norm(\k) = a^{2}-b^{2}d.
    \]
    We will now begin describing the ring of integers, discriminant, and the factorization of primes in $\Q(\sqrt{d})$. The ring of integers has a particularly simple description since it is monogenic as the following proposition shows:
    
    \begin{proposition}\label{prop:ring_of_integers_quadratic}
      Let $\Q(\sqrt{d})$ be a quadratic number field. Then $\Q(\sqrt{d})$ is monogenic and
      \[
        \mc{O}_{\Q(\sqrt{d})} = \begin{cases} \Z\left[\frac{1+\sqrt{d}}{2}\right] & \text{if $d \equiv 1 \tmod{4}$}, \\ \Z[\sqrt{d}] & \text{if $d \equiv 2,3 \tmod{4}$}. \end{cases}
      \]
    \end{proposition}
    \begin{proof}
      Let $\a = a+b\sqrt{d} \in \Q(\sqrt{d})$ be an algebraic integer. If $b = 0$, then $\a \in \Q$ and since the only elements of $\Q$ that are algebraic integers are the integers themselves we must have that $\a$ is an integer. Now suppose $b \neq 0$. Then the minimal polynomial of $\a$ is
      \[
        m_{\a}(x) = x^{2}+2ax+(a^{2}-b^{2}d) = (x-(a+b\sqrt{d}))(x-(a-b\sqrt{d})).
      \]
      As $\a$ is an algebraic integer, $2a \in \Z$ and $a^{2}-b^{2}d \in \Z$ (note that these are the trace and norm of $\a$ respectively). In particular, $(2a)^{2}+(2b)^{2}d \in \Z$ and hence $(2b)^{2} \in \Z$ is as well. But as $b \in \Q$, it must be the case that $2b \in \Z$. If $2a = n+1$ is odd then $n$ is even. We compute
      \[
        a^{2}-b^{2}d = \left(\frac{n+1}{2}\right)^{2}-b^{2}d = \frac{n^{2}+2n+1+4b^{2}d}{4},
      \]
      and since the right-hand side must be an integer $b \notin \Z$. For if $b \in \Z$, the numerator of the right-hand side is equivalent to $1$ modulo $4$ because $n$ is even. As $2b \in \Z$ it follows that $2b$ must be odd so set $2b = m+1$ with $m$ even. Again, we compute
      \[
        a^{2}-b^{2}d = \left(\frac{n+1}{2}\right)^{2}-\left(\frac{m+1}{2}\right)^{2}d = \frac{n^{2}+2n+1-d(m^{2}+2m+1)}{4},
      \]
      and since the right-hand side must be an integer the numerator must be divisible by $4$. As $n$ and $m$ are even, this is equivalent to $d \equiv 1 \tmod{4}$. So we have shown $2a$ or $2b$ is odd if and only if $d \equiv 1 \tmod{4}$. Thus if $d \equiv 1 \tmod{4}$, we have $a = \frac{a'}{2}$ and $b = \frac{b'}{2}$ for some $a',b' \in \Z$ and hence $\a \in \Z\left[\frac{1+\sqrt{d}}{2}\right]$. Otherwise, $d \equiv 2,3 \tmod{4}$ (because $d$ is square-free) so that $2a$ and $2b$ are both even, $a,b \in \Z$, and therefore $\a \in \Z[\sqrt{d}]$. We have now shown that $\mc{O}_{\Q(\sqrt{d})} \subseteq \Z\left[\frac{1+\sqrt{d}}{2}\right]$ and $\mc{O}_{\Q(\sqrt{d})} \subseteq \Z[\sqrt{d}]$ according to if $d \equiv 1 \tmod{4}$ or $d \equiv 2,3 \tmod{4}$ respectively. For the reverse containment, just note that $\sqrt{d}$ is an algebraic integer since its minimal polynomial $m_{\sqrt{d}}(x)$ is
      \[
        m_{\sqrt{d}}(x) = x^{2}\pm d,
      \]
      according to if $d < 0$ or $d > 0$. The reverse containment now follows by \cref{prop:algebraic_integer_if_finitely_generated} and that all integers are algebraic integers.
    \end{proof}

    It follows from \cref{prop:ring_of_integers_quadratic} that
    \[
      1,\frac{1+\sqrt{d}}{2} \quad \text{and} \quad 1,\sqrt{d},
    \]
    are integral bases for $\mc{O}_{\Q(\sqrt{d})}$ according to if $d \equiv 1 \tmod{4}$ or $d \equiv 2,3 \tmod{4}$ respectively. Let us now show that the discriminants quadratic number fields are exactly the fundamental discriminants $D$ other than $1$:

    \begin{proposition}\label{prop:discriminant_quadratic}
      Let $\Q(\sqrt{d})$ be a quadratic number field. Then
      \[
        \D_{\Q(\sqrt{d})} = \begin{cases} d & \text{if $d \equiv 1 \tmod{4}$}, \\ 4d & \text{if $d \equiv 2,3 \tmod{4}$}. \end{cases}
      \]
      In particular, the discriminants quadratic number fields are exactly the fundamental discriminants other than $1$.
    \end{proposition}
    \begin{proof}
      Let $\s_{1}$ and $\s_{2}$ be the two $\Q$-embeddings of $\Q(\sqrt{d})$ into $\C$ where $\s_{1}$ is the identity and $\s_{2}$ is given by sending $\sqrt{d}$ to its conjugate. If $d \equiv 1 \tmod{4}$, an integral basis for $\mc{O}_{\Q(\sqrt{d})}$ is $1,\frac{1+\sqrt{d}}{2}$. In this case, the embedding matrix is
      \[
        M\left(1,\frac{1+\sqrt{d}}{2}\right) = \begin{pmatrix} 1 & \frac{1+\sqrt{d}}{2} \\ 1 & \frac{1-\sqrt{d}}{2} \end{pmatrix},
      \]
      and thus $\D_{\Q(\sqrt{d})} = d$. If $d \equiv 2,3 \tmod{4}$, an integral basis for $\mc{O}_{\Q(\sqrt{d})}$ is $1,\sqrt{d}$. In this case, the embedding matrix is
      \[
        M(1,\sqrt{d}) = \begin{pmatrix} 1 & \sqrt{d} \\ 1 & -\sqrt{d} \end{pmatrix},
      \]
      and hence $\D_{\Q(\sqrt{d})} = 4d$. This proves the first statement and the second statement is clear since $d$ is square-free and not $0$ or $1$.
    \end{proof}

    We will now discuss the factorization of a prime $p$ in a quadratic number field $\Q(\sqrt{d})$. Since $\Q(\sqrt{d})$ is a degree $2$ extension, \cref{prop:inertia_ramification_relation} implies that $p$ is ramified if and only if it is totally ramified and if $p$ is split but not ramified then it is totally split. In other words, there are three possible cases for how $p\mc{O}_{\Q(\sqrt{d})}$ factors:
    \[
      p\mc{O}_{\Q(\sqrt{d})} = \mf{p}, \quad p\mc{O}_{\Q(\sqrt{d})} = \mf{p}^{2}, \quad \text{and} \quad p\mc{O}_{\Q(\sqrt{d})} = \mf{p}\mf{q},
    \]
    according to if $p$ is inert, totally ramified, or totally split. Since $\Q(\sqrt{d})$ is monogenic by \cref{prop:ring_of_integers_quadratic}, we can describe the factorization using the Dedekind-Kummer theorem and connect it to the quadratic character $\chi_{\D_{\Q(\sqrt{d})}}$ given by the fundamental discriminant $\D_{\Q(\sqrt{d})}$:

    \begin{proposition}\label{prop:factorization_of_primes_quadratic}
      Let $\Q(\sqrt{d})$ be a quadratic number field and let $\chi_{\D_{\Q(\sqrt{d})}}$ be the quadratic character given by the fundamental discriminant $\D_{\Q(\sqrt{d})}$. Then for any prime $p$, we have
      \[
        \chi_{\D_{\Q(\sqrt{d})}}(p) = \begin{cases} 1 & \text{if $p$ is split}, \\ -1 & \text{if $p$ is inert}, \\ 0 & \text{if $p$ is ramified}. \end{cases}
      \]
    \end{proposition}
    \begin{proof}
      By \cref{thm:ramification_division_equivalence}, $p$ is ramified if and only if $p$ divides $|\D_{\Q(\sqrt{d})}|$ but this is exactly when $\chi_{\D_{\Q(\sqrt{d})}}(p) = 0$. Therefore it suffices to prove the cases when $p$ is split and inert. First suppose $d \equiv 1 \tmod{4}$ so that $\mc{O}_{\Q(\sqrt{d})} = \Z\left[\frac{1+\sqrt{d}}{2}\right]$ and $\D_{\Q(\sqrt{d})} = d$ by \cref{prop:ring_of_integers_quadratic,prop:discriminant_quadratic}. The minimal polynomial $m_{\frac{1+\sqrt{d}}{2}}(x)$ for $\frac{1+\sqrt{d}}{2}$ is
      \[
        m_{\frac{1+\sqrt{d}}{2}}(x) = x^{2}-x+\frac{1-d}{4},
      \]
      where $\frac{1-d}{4} \in \Z$ because $d \equiv 1 \tmod{4}$. The reduction of $m_{\frac{1+\sqrt{d}}{2}}(x)$ modulo $p$ is either irreducible, factors into two distinct linear factors, or is a square, and Dedekind-Kummer theorem implies that this is equivalent to $p$ being inert, split, or ramified accordingly because the prime factorization is unique. First suppose $p \neq 2$. Then from the quadratic formula, $m_{\frac{1+\sqrt{d}}{2}}(x)$ reduces modulo $p$ as
      \[
        m_{\frac{1+\sqrt{d}}{2}}(x) \equiv \left(x-\frac{1+\sqrt{d}}{2}\right)\left(x-\frac{1-\sqrt{d}}{2}\right) \pmod{p},
      \]
      if and only if the roots $\frac{1\pm\sqrt{d}}{2}$ are elements of $\F_{p}$ and is otherwise irreducible. As $p \neq 2$, these factors are distinct. Moreover, $\frac{1\pm\sqrt{d}}{2}$ is an element of $\F_{p}$ if and only if $d$ is a square modulo $p$ and hence $p$ is split or inert according to if $\chi_{d}(p) = \pm1$. Now suppose $p = 2$. Since $m_{\frac{1+\sqrt{d}}{2}}(x)$ has a nonzero linear term with an odd coefficient, it reduces modulo $2$ as
      \[
        m_{\frac{1+\sqrt{d}}{2}}(x) \equiv x(x-1) \tmod{2},
      \]
      if and only if $\frac{1-d}{4} \equiv 0 \tmod{2}$ and is otherwise irreducible. Clearly these factors are distinct. Now observe $\frac{1-d}{4} \equiv 0 \tmod{2}$ is equivalent to $d \equiv 1 \tmod{8}$ provided $d > 0$ and $d \equiv 7 \tmod{8}$ provided $d < 0$ and thus $p$ is split or inert according to if $\chi_{d}(2) = \pm1$. This completes the argument in the case $d \equiv 1 \tmod{4}$. Now suppose $d \equiv 2,3 \tmod{4}$ so that $\mc{O}_{\Q(\sqrt{d})} = \Z[\sqrt{d}]$ and $\D_{\Q(\sqrt{d})} = 4d$ by \cref{prop:ring_of_integers_quadratic,prop:discriminant_quadratic}. The minimal polynomial $m_{\sqrt{d}}(x)$ for $\sqrt{d}$ is
      \[
        m_{\sqrt{d}}(x) = x^{2}-d.
      \]
      As $\D_{\Q(\sqrt{d})} = 4d$, we see that $2$ is ramified and therefore we may assume $p \neq 2$. Similarly, the reduction of $m_{\sqrt{d}}(x)$ modulo $p$ is either irreducible, factors into two distinct linear factors, or is a square, and Dedekind-Kummer theorem implies that this is equivalent to $p$ being inert, split, or ramified accordingly because the prime factorization is unique. As $p \neq 2$, the quadratic formula implies that $m_{\sqrt{d}}(x)$ reduces modulo $p$ as
      \[
        m_{\sqrt{d}}(x) \equiv (x-\sqrt{d})(x+\sqrt{d}) \pmod{p},
      \]
      if and only if the roots $\pm\sqrt{d}$ are elements of $\F_{p}$. As $p \neq 2$, these factors are distinct. Moreover, $\sqrt{d}$ is an element of $\F_{p}$ if and only if $d$ and hence $4d$ are squares modulo $p$ so that $p$ is split or inert according to if $\chi_{4d}(p) = \pm1$. This completes the verification in the case $d \equiv 2,3 \tmod{4}$.
    \end{proof}

    From \cref{prop:factorization_of_primes_quadratic}, the factorization of primes in $\Q(\sqrt{d})$ is controlled by the quadratic character $\chi_{\D_{\Q(\sqrt{d})}}$ attached to the fundamental discriminant $\D_{\Q(\sqrt{d})}$. In other words, the factorization of $p$ depends completely upon if $\D_{\Q(\sqrt{d})}$ is a square modulo $p$. While splitting of primes can be explicitly described for quadratic number fields, the class number is a significantly more difficult problem. The \textbf{class number problem}\index{class number problem} was originally introduced by Gauss and aims to classify all quadratic number fields of a given class number:

    \begin{problem}[Class number problem]
      For a fixed $n \ge 1$, classify all quadratic number fields $\Q(\sqrt{d})$ of class number $n$.
    \end{problem}

    Some progress has been made toward the class number problem. In 1801, Gauss found nine imaginary quadratic numbers fields of class number $1$ (see \cite{gauss1801disquisitiones}). They are listed according to $d$ as follows:
    \[
      d  \in \{-1,-2,-3,-7,-11,-19,-43,-67,-163\}.
    \]
    Gauss also conjectured that these are the only imaginary quadratic numbers fields of class number $1$. An argument was presented by Heegner in 1952 (see \cite{heegner1952diophantische}) which was correct up to some minor flaws. Baker and Stark both independently gave independent proofs in the mid 1960's (see \cite{baker1967linear,stark1967complete}) resulting in the following theorem which solves the class number problem for imaginary quadratic number fields in the case $n = 1$:

    \begin{theorem}
      If $\Q(\sqrt{d})$ is an imaginary quadratic number field of class number $1$, then
      \[
        d \in \{-1,-2,-3,-7,-11,-19,-43,-67,-163\}.
      \]
      Equivalently, an imaginary quadratic number field $\Q(\sqrt{d})$ has class number $1$ if and only if
      \[
        \D_{\Q(\sqrt{d})} \in \{-3,-4,-7,-8,-11,-19,-43,-67,-163\}.
      \]
    \end{theorem}

    As for real quadratic fields, we know much less. In the same 1801 paper of Gauss (see \cite{gauss1801disquisitiones}), he conjectured that there should be infinitely many real quadratic fields and that the class number should remain unbounded:

    \begin{conjecture}
      There are infinitely many real quadratic fields $\Q(\sqrt{d})$ that have class number $1$. Moreover,
      \[
        \lim_{d \to \infty}h(d) = \infty.
      \]
    \end{conjecture}

    While the class number problem remains quite out of reach, the structure of the unit group is much easier to classify. Write $\mu(d) = \mu(\Q(\sqrt{d}))$ and $w_{d} = w_{\Q(\sqrt{d})}$. In fact, by Dirichlet's unit theorem we only need to understand the roots of unity $\mu_{d}$ of $\Q(\sqrt{d})$. In all but two cases, $\mu(d) = \<-1\>$:

    \begin{proposition}
      Let $\Q(\sqrt{d})$ be a quadratic number field. Then
      \[
        \mu(d) = \begin{cases} \<i\> & \text{if $d = -1$}, \\ \<\w_{6}\> & \text{if $d = -3$}, \\ \<-1\> & \text{otherwise}, \end{cases} \quad \text{and} \quad w_{d} = \begin{cases} 4 & \text{if $d = -1$}, \\ 6 & \text{if $d = -3$}, \\ 2 & \text{otherwise}, \end{cases}
      \]
      where $\w_{6}$ is primitive $6$-th root of unity. In particular,
      \[
        \mc{O}_{\Q(\sqrt{d})}^{\ast} = \mu(d) \x \<\e\> \quad \text{or} \quad \mc{O}_{\Q(\sqrt{d})}^{\ast} = \mu(d),
      \]
      where $\e$ is a fundamental unit, according to if $d > 0$ or $d < 0$.
    \end{proposition}
    \begin{proof}
        First suppose $d > 0$. Then $\Q(\sqrt{d}) \subset \R$ and thus $\mu(d) = \<-1\>$ since these are the only roots of unity in $\R$ and clearly they are in $\Q(\sqrt{d})$. Now suppose $d < 0$. Then $\Q(\sqrt{d})$ is imaginary and its signature is $(0,1)$. By \cref{cor:unit_if_and_only_if_absolute_value_norm_1}, $\a \in \mc{O}_{\Q(\sqrt{d})}$ is a unit if and only if the norm of $\a$ is $\pm 1$. Actually, since $d < 0$ the definition of the norm shows that the norm is always nonnegative. Hence $\a$ is a unit if and only if its norm is $1$. First suppose $d \equiv 2,3 \tmod{4}$. Then \cref{prop:ring_of_integers_quadratic} implies
      \[
        \a = a+b\sqrt{d},
      \]
      for some $a,b \in \Z$, and $\a$ is a unit if and only if
      \[
        \Norm(\a) = a^{2}-b^{2}d = a^{2}+b^{2}|d| = 1.
      \]
      Since $|d| \equiv d \equiv 2,3 \tmod{4}$, this happens if and only if $b = 0$ unless $d = -1$. In the former case, $d < 0$ and $\a = a$ is a unit if and only if $a^{2} = 1$ which is to say that $\a = \pm 1$. In the latter case, $d = -1$ and $\a = a+bi$ with $b \neq 0$ (for otherwise we are in the former case) is a unit if and only if $a^{2}+b^{2} = 1$ which means $a = \pm1$ and $b = 0$ or $a = 0$ and $b = \pm 1$ so that $\a$ runs over the $4$-th roots of unity. Altogether, we have shown that $\mu(d) = \<-1\>$ provided $d \equiv 2,3 \tmod{4}$ unless $d = -1$ in which case $\mu(-1) = \<i\>$. Now suppose $d \equiv 1 \tmod{4}$. Then \cref{prop:ring_of_integers_quadratic} implies
      \[
        \a = a+b\frac{1+\sqrt{d}}{2} = \frac{2a+b}{2}+\frac{b}{2}\sqrt{d},
      \]
      for some $a,b \in \Z$, and $\a$ is a unit if and only if
      \[
        \Norm(\a) = \frac{4a^{2}+4ab+b^{2}}{4}-\frac{b^{2}}{4}d = a^{2}+ab+(1+|d|)\frac{b^{2}}{4} = 1.
      \]
      Since $|d| \equiv d \equiv 1 \tmod{4}$, this happens if and only if $b = 0$ or $d = -3$ (if $b \neq 0$ then $a^{2}+ab+(1+|d|)\frac{b^{2}}{4} > 1$ for such $d$ unless $d = -3$). In the former case, $\a = a$ is a unit if and only if $a^{2} = 1$ which means $\a = \pm1$. In the latter case, $\a = a+b\frac{1+\sqrt{-3}}{2}$ is a unit if and only if $a^{2}+ab+b^{2} = 1$ which happens if $a = \pm 1$ and $b = 0$, $a = 0$ and $b = \pm 1$, $a = 1$ and $b = -1$, or $a = -1$ and $b = 1$ so that $\a$ runs over the $6$-th roots of unity. This shows $\mu(d) = \<-1\>$ provided $d \equiv 1 \tmod{4}$ unless $d = -3$ in which case $\mu(-3) = \<\w_{6}\>$. This proves the claim about $\mu(d)$ in all cases and the statement about $w_{d}$ follows immediately. To prove the last statement, the signature of $\Q(\sqrt{d})$ is $(2,0)$ or $(0,1)$ according to if $d > 0$ or $d < 0$. Applying Dirichlet's unit theorem completes the proof.
    \end{proof}
