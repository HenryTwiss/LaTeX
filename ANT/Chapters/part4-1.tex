\chapter{The Theory of Sieves}
  Sieves are an important tool in analytic number theory because they allow for the estimation of the size of of a sifted sequence of numbers from some initial sequence. In practice, one is usually sifting out only those indices relatively prime to some fixed integer and up to some prescribed size. In the following, we introduce sieves in some generality.
  \section{The Language of Sieves}
    Let $\mc{A} = (a_{n})_{n \ge 1}$ be a nonnegative sequence and $\mc{P}$ be a set of primes. We call $\mc{A}$ the \textbf{sifting sequence}\index{sifting sequence}, $\mc{P}$ the \textbf{sifting range}\index{sifting range}, and any $p \in \mc{P}$ a \textbf{sifting prime}\index{sifting prime}. For any integer $d \ge 1$, let $\mc{A}_{d}$ be the subsequence consisting of those terms $a_{n}$ with $n \equiv 0 \tmod{d}$. Define the sum $S(x;\mc{A})$ by
    \[
      S(x;\mc{A}) = \sum_{\substack{n \le x}}a_{n},
    \]
    for $x \ge 0$.  Moreover, we define the function $P(z)$ by
    \[
      P(z) = \prod_{\substack{p \in \mc{P} \\ p < z}}p,
    \]
    for $z \ge 2$ and call $z$ the \textbf{sifting level}\index{sifting level}. In other words, $P(z)$ is the product of the sifting primes in the sifting range up to $z$. We define the corresponding \textbf{sifting function}\index{sifting function} $S(x,z;\mc{A})$ by
    \[
      S(x,z;\mc{A}) = \sum_{\substack{n \le x \\ (n,P(z)) = 1}}a_{n},
    \]
    for $x \ge 0$ and $z \ge 2$. Equivalently, $S(x,z;\mc{A})$ consists of only those terms $a_{n}$ in $S(x;\mc{A})$ whose indices $n$ are not divisible by any sifting prime. Thus we have removed those terms $a_{n}$ with $n \equiv 0 \tmod{p}$ for some sifting prime $p$ up to $z$ (this is equivalent to $p \mid P(z)$). The objective of any particular sieve is to produce sharp upper or lower bounds for the sifting function $S(x,z;\mc{A})$. That is, we want to estimate the sum of elements $a_{n}$ of the sifting sequence $\mc{A}$ whose indices $n$ are relatively prime to all sifting primes in the sifting range $\mc{P}$ up to the sifting level $z$. We being by deriving a useful relation for the sifting function that will motivate the construction of sieves. Applying \cref{prop:Mobius_dirac_delta} to $S(x,z;\mc{A})$ to remove the condition $(n,P(z)) = 1$ gives
    \[
      S(x,z;\mc{A}) = \sum_{n \le x}\sum_{d \mid (n,P(z))}\mu(d)a_{n},
    \]
    and upon interchanging the two sums we obtain \textbf{Legendre's identity}\index{Legendre's identity}:
    \[
      S(x,z;\mc{A}) = \sum_{d \mid P(z)}\mu(d)S(x;\mc{A}_{d}).
    \]
    In terms of Legendre's identity, the usefulness of sieves comes from replacing the M\"obius function with weights that essentially serve as a truncation of the M\"obius function. More precisely, we replace $\mu(d)$ with a weighting factor $\l_{d}$ coming from a real sequence $\L = (\l_{d})_{d \ge 1}$ satisfying $\l_{d} = 0$ unless $d$ is square-free, $d \mid P(z)$, and $d < D$ for some $D \ge 1$. We will also let $\l$ represent the arithmetic function $\l(d) = \l_{d}$. We call $\L$ a \textbf{sieve}\index{sieve}, $\l_{d}$ a \textbf{sieve weight}\index{sieve weight}, and the minimal such $D$ the \textbf{sieve level}\index{sieve level} of $\L$. We also define the \textbf{sifting variable}\index{sifting variable} $s$ by
    \[
      s = \frac{\log(D)}{\log(z)}.
    \]
    That is, $s$ measures the size of the sieve level relative to the sifting level on a logarithmic scale. We then define the \textbf{sieving function}\index{sieving function} $S^{\L}(x,z;\mc{A})$ by
    \[
      S^{\L}(x,z;\mc{A}) = \sum_{d \mid P(z)}\l_{d}S(x;\mc{A}_{d}),
    \]
    for $x > 0$ and $z \ge 2$. Expanding $S(x;\mc{A}_{d})$, we can write
    \[
      S^{\L}(x,z;\mc{A}) = \sum_{n \le x}a_{n}\sum_{d \mid (n,P(z))}\l_{d}.
    \]
    Now set
    \[
      \t_{n}^{0} = \sum_{d \mid (n,P(z))}\mu(d) \quad \text{and} \quad \t_{n} = \sum_{d \mid (n,P(z))}\l_{d}.
    \]
    We will also let $\t^{0}$ and $\t$ represent the arithmetic functions $\t^{0}(n) = \t_{n}^{0}$ and $\t(n) = \t_{n}$ respectively. Equivalently, we can express $\t_{n}^{0}$ and $\t_{n}$ in terms of the Dirichlet convolutions (see \cref{append:Arithmetic_Functions}) $\t^{0} = \mu \ast \mathbf{1}$ and $\t = \l \ast \mathbf{1}$ respectively. Note that $\t_{n}^{0}$ and $\t_{n}$ (and hence $\t^{0}$ and $\t$ as well) both depend on the sifting level $z$, but we suppress this dependence from the notation. In any case, we have
    \[
      S^{\L}(x,z;\mc{A}) = \sum_{n \le x}a_{n}\t_{n}. 
    \]
    We say that $\L$ is an \textbf{upper sieve}\index{upper sieve} if the sieving function $S^{\L}(x,z;\mc{A})$ is an upper bound for the sifting function $S(x,z;\mc{A})$. From the definition of the sifting function, $\L$ will be an upper sieve if and only if $\t_{n} \ge \t_{n}^{0}$. Analogously, we say that $\L$ is a \textbf{lower sieve}\index{lower sieve} if the sieving function $S^{\L}(x,z;\mc{A})$ is a lower bound for the sifting function $S(x,z;\mc{A})$. Similarly, $\L$ will be a lower sieve if and only if $\t_{n} \le \t_{n}^{0}$. We will often optimize the choice of sieve weights such that the lower or upper bound is as tight as possible. When we wish to distinguish upper and lower sieves, we denote them by $\L^{\pm} = (\l_{d}^{\pm})_{d \ge 1}$ respectively. Moreover, we write
    \[
      S^{\pm}(x,z;\mc{A}) = \sum_{d \mid P(z)}\l_{d}^{\pm}S(x;\mc{A}_{d}) \quad \text{and} \quad \t_{n}^{\pm} = \sum_{d \mid (n,P(z))}\l_{d}^{\pm},
    \]
    respectively. Then we have the upper and lower bounds
    \[
      S^{-}(x,z;\mc{A}) \le S(x,z;\mc{A}) \le S^{+}(x,z;\mc{A}),
    \]
    provided
    \begin{equation}\label{equ:upper_lower_sieve_theta_relation}
      \t_{n}^{-} \le \t_{n}^{0} \le \t_{n}^{+}.
    \end{equation}
    We can also compose sieves to form new sieves from old ones. To explain the construction, let $\L' = (\l'_{d})_{d \ge 1}$ and $\L'' = (\l''_{d})_{d \ge 1}$ be two sieves of levels $D'$ and $D''$ respectively. Also let $\t' = \l' \ast \mathbf{1}$ and $\t'' = \l'' \ast \mathbf{1}$. Then we define the \textbf{composite sieve}\index{composite sieve} $\L = \L'\L''$ of $\L'$ and $\L''$ by
    \[
      \l_{d} = \sum_{\substack{ d_{1},d_{2} \mid d \\ [d_{1},d_{2}] = d}}\l'_{d_{1}}\l''_{d_{2}},
    \]
    for $d \ge 1$. Clearly $\L$ is a sieve of level $D'D''$. Moreover, summing over pairs $(d_{1},d_{2})$ of divisors of $n$ is the same as summing over triples $(d_{1},d_{2},d)$ of divisors of $n$ with $[d_{1},d_{2}] = d$, we see that
    \[
      \t = \l \ast \mathbf{1} = (\l' \ast \mathbf{1})(\l'' \ast \mathbf{1}) = \t'\t''.
    \]
    From this chain and \cref{equ:upper_lower_sieve_theta_relation} it follows that the composition of an upper and lower sieve is a lower sieve while the composition of two upper or two lower sieves is an upper sieve.
  \section{Estimating the Sifting Function}
    Ultimately, our aim is to estimate the sifting function in terms of upper or lower sieving functions. In order to achieve this, we require an additional assumption about the sums $S(x;\mc{A}_{d})$. In particular, we assume that there exists a multiplicative arithmetic function $g$ with $g(1) = 1$, $0 \le g(d) < 1$ for all $d > 1$ where $g(d) = 0$ unless $d$ is square-free and the primes dividing $d$ belong to $\mc{P}$, satisfies
    \begin{equation}\label{equ:prod_assumption_density_function_1}
      \prod_{w \le p < z}(1-g(p))^{-1} \le K\left(\frac{\log(z)}{\log(w)}\right)^{\k},
    \end{equation}
    for constants $K > 1$ and $\k \ge 0$ and all $w$ and $z$ with $z > w \ge 2$, and such that  
    \begin{equation}\label{equ:d_multiple_sifting_function_estimate}
      S(x;\mc{A}_{d}) = g(d)M(x;\mc{A})+r_{d}(x;\mc{A}),
    \end{equation}
    for some smooth functions $M(x;\mc{A})$ and $r_{d}(x;\mc{A})$. We call the function $g$ a \textbf{density function}\index{density function} and the constant $\k$ the \textbf{sieve dimension}\index{sieve dimension}. Using Legendre's identity, we can write
    \[
      S(x,z;\mc{A}) = M(x;\mc{A})\sum_{d \mid P(z)}\mu(d)g(d)+\sum_{d \mid P(z)}\mu(d)r_{d}(x;\mc{A}).
    \]
    Moreover, if we define functions $V(z)$ and $R(x,z;\mc{A})$ by
    \[
      V(z) = \sum_{d \mid P(z)}\mu(d)g(d) \quad \text{and} \quad R(x,z;\mc{A}) = \sum_{d \mid P(z)}\mu(d)r_{d}(x;\mc{A}),
    \]
    for $x > 0$ and $z \ge 2$, then we can further write
    \[
      S(x,z;\mc{A}) = M(x;\mc{A})V(z)+R(x,z;\mc{A}).
    \]
    As $g$ is multiplicative, the definition of the M\"obius function allows us to express $V(z)$ as a product:
    \begin{equation}\label{equ:V_product_formula}
      V(z) = \prod_{p \mid P(z)}(1-g(p)).
    \end{equation}
    In particular, since $g(p) = 0$ if $p \notin \mc{P}$, \cref{equ:prod_assumption_density_function_1} can be expressed in the form
    \begin{equation}\label{equ:prod_assumption_density_function_2}
      \frac{V(w)}{V(z)} \le K\left(\frac{\log(z)}{\log(w)}\right)^{\k}.
    \end{equation}
    Since the M\"obius function changes sign, it is difficult to estimate $R(x,z;\mc{A})$ beyond trivial bounds. We can do much better with a sieve $\L$. In this case, the definition of the sieving function gives
    \[
      S_{d}^{\L}(x,z;\mc{A}) = M(x;\mc{A})\sum_{d \mid P(z)}\l_{d}g(d)+\sum_{d \mid P(z)}\l_{d}r_{d}(x;\mc{A}).
    \]
    Defining functions $V^{\L}(z)$ and $R^{\L}(x,z;\mc{A})$ by
     \[
      V^{\L}(z) = \sum_{d \mid P(z)}\l_{d}g(d) \quad \text{and} \quad R^{\L}(x,z;\mc{A}) = \sum_{d \mid P(z)}\l_{d}r_{d}(x;\mc{A}),
    \]
    for $x > 0$ and $z \ge 2$, we can further write
    \[
      S^{\L}(x,z;\mc{A}) = M(x;\mc{A})V^{\L}(z)+R^{\L}(x,z;\mc{A}).
    \]
    For upper or lower sieves $\L^{\pm}$, we instead write
     \[
      V^{\pm}(z) = \sum_{d \mid P(z)}\l_{d}^{\pm}g(d) \quad \text{and} \quad R^{\pm}(x,z;\mc{A}) = \sum_{d \mid P(z)}\l_{d}^{\pm}r_{d}(x;\mc{A}),
    \]
    respectively. Therefore, estimates for the sieving function $S^{\L}(x,z;\mc{A})$ reduce to estimates for $M(x;\mc{A})$, $V^{\L}(z)$, and $R^{\L}(x,z;\mc{A})$. In order for \cref{equ:d_multiple_sifting_function_estimate} to be useful, the functions $M(x;\mc{A})$ and $r_{d}(x;\mc{A})$ should be such that we know the order of magnitude of $M(x;\mc{A})$ and that $r_{d}(x;\mc{A})$ is of smaller order of magnitude. In this case, it suffices to estimate $V^{\L}(z)$, and $R^{\L}(x,z;\mc{A})$. For $R^{\L}(x,z;\mc{A})$, we will usually discard possible cancellation from the individual terms $\l_{d}r_{d}(x;\mc{A})$ and use the trivial bound
    \[
      R^{\L}(x,z;\mc{A}) \le |R^{\L}|(x,z;\mc{A}),
    \]
    where
    \[
      |R^{\L}|(x,z;\mc{A}) = \sum_{d \mid P(z)}|\l_{d}r_{d}(x;\mc{A})|.
    \]
    In order to obtain estimates for $V^{\L}(z)$, we express it in a more useful form that involves $V(z)$. For this, we define multiplicative arithmetic functions $h$ and $j$ defined by
    \[
      h(p^{r}) = \frac{g(p^{r})}{(1-g(p^{r}))} \quad \text{and} \quad j(p^{r}) = \frac{1}{(1-g(p^{r}))},
    \]
    for all primes $p$ and $r \ge 0$. Moreover, these two formulas imply
    \[
      j(p^{r}) = \frac{h(p^{r})}{g(p^{r})} = 1+h(p^{r}).
    \]
    We call $h$ the \textbf{relative density function}\index{relative density function}. In particular, $j = h \ast \mathbf{1}$. Now as $\t = \l \ast \mathbf{1}$, the M\"obius inversion formula (see \cref{append:The_Mobius_Function}) implies $\l = \t \ast \mu$ so that
    \[
      V^{\L}(z) = \sum_{d \mid P(z)}\sum_{e \mid d}\t_{e}\mu\left(\frac{d}{e}\right)g(d).
    \]
    Making the change of variables $d \to ed$ and noting that $(d,e) = 1$ because $P(z)$ is square-free, we compute
    \begin{align*}
      V^{\L}(z) &= \sum_{de \mid P(z)}\t_{e}\mu(d)g(de) \\
      &= \sum_{e \mid P(z)}\t_{e}g(e)\prod_{p \mid \frac{P(z)}{e}}(1-g(p)) \\
      &= \sum_{e \mid P(z)}\t_{e}h(e)\prod_{p \mid P(z)}(1-g(p)),
    \end{align*}
    where the second line holds by the multiplicativity of $g$ and the definition of the M\"obius function. Defining the function $G^{\L}(z)$ by
    \[
      G^{\L}(z) = \sum_{d \mid P(z)}\t_{d}g(d),
    \]
    for $z \ge 2$, \cref{equ:V_product_formula} further implies that
    \[
      V^{\L}(z) = G^{\L}(z)V(z).
    \]
    Therefore estimates for $V^{\L}(z)$ reduce to estimates for $G^{\L}(z)$ and $V(z)$.