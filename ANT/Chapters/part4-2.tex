\chapter{Types of \texorpdfstring{$L$}{L}-functions}
  We discuss a variety of $L$-functions: the Riemann zeta function, $L$-functions attached to Dirichlet characters, and Hecke $L$-functions. In the case of Hecke $L$-functions, we also describe a method of Rankin and Selberg for constructing new $L$-functions from old ones.
  \section{The Riemann Zeta Function}
    \subsection*{The Definition \& Euler Product}
      The \textbf{Riemann zeta function}\index{Riemann zeta function} $\z(s)$ is defined by the following Dirichlet series:
      \[
        \z(s) = \sum_{n \ge 1}\frac{1}{n^{s}}.
      \]
      This is the prototypical example of a Dirichlet series as all the coefficients are $1$. We will see that $\z(s)$ is a primitive Selberg class $L$-function. As the coefficients are uniformly bounded and completely multiplicative, $\z(s)$ is locally absolutely uniformly convergent for $\s > 1$ and admits the following degree $1$ Euler product by \cref{prop:Dirichlet_series_Euler_product}:
      \[
        \z(s) = \prod_{p}(1-p^{-s})^{-1}.
      \]
      The local factor at $p$ is
      \[
        \z_{p}(s) = (1-p^{-s})^{-1},
      \]
      with local root $1$. As the degree of $\z(s)$ is $1$, it will necessarily be primitive once we show it is Selberg class.
    \subsection*{The Integral Representation: Part I}
      We want to find an integral representation for $\z(s)$. To do this, consider the function
      \[
        \w(z) = \sum_{n \ge 1}e^{\pi in^{2}z},
      \]
      defined for $z \in \H$. It is locally absolutely uniformly convergent in this region by Weierstrass $M$-test. Moreover, we have
      \[
        \w(z) = O\left(\sum_{n \ge 1}e^{-\pi n^{2}y}\right) = O(e^{-\pi y}),
      \]
      where the second equality holds because each term is of smaller order than the next so that the series is bounded by a constant times the first term. It follows that $\w(z)$ exhibits exponential decay. Now consider the following Mellin transform:
      \[
        \int_{0}^{\infty}\w(iy)y^{\frac{s}{2}}\,\frac{dy}{y}.
      \]
      By the exponential decay of $\w(z)$, this integral is locally absolutely uniformly convergent for $\s > 1$ and hence defines an analytic function there. Then we compute
      \begin{align*}
        \int_{0}^{\infty}\w(iy)y^{\frac{s}{2}}\,\frac{dy}{y} &= \int_{0}^{\infty}\sum_{n \ge 1}e^{-\pi n^{2}y}y^{\frac{s}{2}}\,\frac{dy}{y} \\
        &= \sum_{n \ge 1}\int_{0}^{\infty}e^{-\pi n^{2}y}y^{\frac{s}{2}}\,\frac{dy}{y} && \text{FT} \\
        &= \sum_{n \ge 1}\frac{1}{\pi^{\frac{s}{2}}n^{s}}\int_{0}^{\infty}e^{-y}y^{\frac{s}{2}}\,\frac{dy}{y} && \text{$y \mapsto \frac{y}{\pi n^{2}}$} \\
        &= \frac{\G\left(\frac{s}{2}\right)}{\pi^{\frac{s}{2}}}\sum_{n \ge 1}\frac{1}{n^{s}} \\
        &= \frac{\G\left(\frac{s}{2}\right)}{\pi^{\frac{s}{2}}}\z(s).
      \end{align*}
      Therefore we have an integral representation
      \begin{equation}\label{equ:integral_representation_zeta_1}
        \z(s) = \frac{\pi^{\frac{s}{2}}}{\G\left(\frac{s}{2}\right)}\int_{0}^{\infty}\w(iy)y^{\frac{s}{2}}\,\frac{dy}{y}.
      \end{equation}
      Unfortunately, we cannot proceed until we obtain a functional equation for $\w(z)$. So we will make a detour and come back to the integral representation after.
    \subsection*{The Jacobi Theta Function}
      The \textbf{Jacobi theta function}\index{Jacobi theta function} $\vt(z)$ is defined by
      \[
        \vt(z) = \sum_{n \in \Z}e^{2\pi in^{2}z},
      \]
      for $z \in \H$. It is locally absolutely uniformly convergent in this region by the Weierstrass $M$-test. Moreover,
      \[
        \vt(z)-1 = O\left(\sum_{n \in \Z-\{0\}}e^{-2\pi n^{2}y}\right) = O(e^{-2\pi y}),
      \]
      where the second equality holds because each term is of smaller order than the $n = \pm 1$ terms so that the series is bounded by a constant times the order of these terms. In particular, $\vt(z)-1$ exhibits exponential decay. The relationship to $\w(z)$ is given by
      \[
        \w(z) = \frac{\vt\left(\frac{z}{2}\right)-1}{2}.
      \]
      The essential fact we will need is a functional equation for the Jacobi theta function:

      \begin{theorem}\label{thm:functional_equation_Jacobi_theta}
        For $z \in \H$,
        \[
          \vt(z) = \frac{1}{\sqrt{-2iz}}\vt\left(-\frac{1}{4z}\right).
        \]
      \end{theorem}
      \begin{proof}
        We will apply the Poisson summation formula to
        \[
          \vt(z) = \sum_{n \in \Z}e^{2\pi in^{2}z}.
        \]
        To do this, we compute the Fourier transform of the summand and by the identity theorem it suffices to verify this for $z = iy$ with $y > 0$. So set
        \[
          f(x) = e^{-2\pi x^{2}y}.
        \]
        Then $f(x)$ is of Schwarz class. By \cref{prop:Fourier_transform_of_exponential_single_variable}, we have
        \[
          (\mc{F}f)(t) = \frac{e^{-\frac{\pi t^{2}}{2y}}}{\sqrt{2y}}.
        \]
        By the Poisson summation formula and the identity theorem, we have
        \[
          \vt(z) = \sum_{n \in \Z}e^{2\pi in^{2}z} = \sum_{t \in \Z}\frac{e^{-\frac{\pi t^{2}}{-2iz}}}{\sqrt{-2iz}} = \frac{1}{\sqrt{-2iz}}\sum_{t \in \Z}e^{-\frac{\pi t^{2}}{-2iz}} = \frac{1}{\sqrt{-2iz}}\sum_{t \in \Z}e^{2\pi it^{2}\left(-\frac{1}{4z}\right)} = \frac{1}{\sqrt{-2iz}}\vt\left(-\frac{1}{4z}\right).
        \]
      \end{proof}

      We will use \cref{thm:functional_equation_Jacobi_theta} to analytically continue $\z(s)$.
    \subsection*{The Integral Representation: Part II}
      Returning to the Riemann zeta function, we split the integral in \cref{equ:integral_representation_zeta_1} into two pieces by writing
      \begin{equation}\label{equ:symmetric_integral_zeta_split}
        \int_{0}^{\infty}\w(iy)y^{\frac{s}{2}}\,\frac{dy}{y} = \int_{0}^{1}\w(iy)y^{\frac{s}{2}}\,\frac{dy}{y}+\int_{1}^{\infty}\w(iy)y^{\frac{s}{2}}\,\frac{dy}{y}.
      \end{equation}
      The idea now is to rewrite the first piece in the same form and symmetrize the result as much as possible. We being by performing a change of variables $y \mapsto \frac{1}{y}$ to the first piece to obtain
      \[
        \int_{1}^{\infty}\w\left(\frac{i}{y}\right)y^{-\frac{s}{2}}\,\frac{dy}{y}
      \]
      Now we compute
      \begin{align*}
        \w\left(\frac{i}{y}\right) &= \w\left(-\frac{1}{iy}\right) \\
        &= \frac{\vt\left(-\frac{1}{2iy}\right)-1}{2} \\
        &= \frac{\sqrt{y}\vt\left(\frac{iy}{2}\right)-1}{2} && \text{\cref{thm:functional_equation_Jacobi_theta}} \\
        &= \sqrt{y}\w(iy)+\frac{\sqrt{y}}{2}-\frac{1}{2}.
      \end{align*}
      This chain implies that our first piece can be expressed as
      \[
        \int_{1}^{\infty}\left(\sqrt{y}\w(iy)+\frac{\sqrt{y}}{2}-\frac{1}{2}\right)y^{-\frac{s}{2}}\,\frac{dy}{y},
      \]
      which is further equivalent to
      \[
        \int_{1}^{\infty}\w(iy)y^{\frac{1-s}{2}}\,\frac{dy}{y}-\frac{1}{s(1-s)},
      \]
      because the integral over the last two pieces is $\frac{1}{1-s}-\frac{1}{s} = -\frac{1}{s(1-s)}$. Substituting this result back into \cref{equ:symmetric_integral_zeta_split} and combining with \cref{equ:integral_representation_zeta_1} yields the integral representation
      \begin{equation}\label{equ:integral_representation_zeta_final}
        \z(s) = \frac{\pi^{\frac{s}{2}}}{\G\left(\frac{s}{2}\right)}\left[-\frac{1}{s(1-s)}+\int_{1}^{\infty}\w(iy)y^{\frac{1-s}{2}}\,\frac{dy}{y}+\int_{1}^{\infty}\w(iy)y^{\frac{s}{2}}\,\frac{dy}{y}\right].
      \end{equation}
      This integral representation will give analytic continuation. To see this, first observe that everything outside the brackets is entire. Moreover, the integrands exhibit exponential decay and therefore the integrals are locally absolutely uniformly convergent on $\C$. The fractional term is holomorphic except for simple poles at $s = 0$ and $s = 1$. The meromorphic continuation to $\C$ follows with possible simple poles at $s = 0$ and $s = 1$. There is no pole at $s = 0$. Indeed, $\G\left(\frac{s}{2}\right)$ has a simple pole at $s = 0$ and so its reciprocal has a simple zero. This cancels the corresponding simple pole of $-\frac{1}{s(1-s)}$ so that $\z(s)$ has a removable singularity and thus is holomorphic at $s = 0$. At $s = 1$, $\G\left(\frac{s}{2}\right)$ is nonzero and so $\z(s)$ has a simple pole. Therefore $\z(s)$ has meromorphic continuation to all of $\C$ with a simple pole at $s = 1$.
    \subsection*{The Functional Equation}
      An immediate consequence of applying the symmetry $s \mapsto 1-s$ to \cref{equ:integral_representation_zeta_final} is the following functional equation:
      \[
        \frac{\G\left(\frac{s}{2}\right)}{\pi^{\frac{s}{2}}}\z(s) = \frac{\G\left(\frac{1-s}{2}\right)}{\pi^{\frac{1-s}{2}}}\z(1-s).
      \]
      We identify the gamma factor as
      \[
        \g(s,\z) = \pi^{-\frac{s}{2}}\G\left(\frac{s}{2}\right),
      \]
      with $\k = 0$ the only local root at infinity. Clearly it satisfies the required bounds. The conductor is $q(\z) = 1$ so no primes ramify. The completed Riemann zeta function is
      \[
        \L(s,\z) = \pi^{-\frac{s}{2}}\G\left(\frac{s}{2}\right)\z(s),
      \]
      with functional equation
      \[
        \L(s,\z) = \L(1-s,\z).
      \]
      This is the functional equation of $\z(s)$ and in this case is just a reformulation of the previous functional equation. From it we find that the root number is $\e(\z) = 1$ and that $\z(s)$ is self-dual. We can now show that the order of $\z(s)$ is $1$. As there is only a simple pole at $s = 1$, multiply by $(s-1)$ to clear the polar divisor. As the integrals in \cref{equ:integral_representation_zeta_final} are locally absolutely uniformly convergent, computing the order amounts to estimating the gamma factor. Since the reciprocal of the gamma function is of order $1$, we have
      \[
        \frac{1}{\g(s,\z)} \ll_{\e} e^{|s|^{1+\e}}.
      \]
      Thus the reciprocal of the gamma factor is also of order $1$. It follows that
      \[
        (s-1)\z(s) \ll_{\e} e^{|s|^{1+\e}}.
      \]
      This shows $(s-1)\z(s)$ is of order $1$, and thus $\z(s)$ is as well after removing the polar divisor. We now compute the residue of $\z(s)$ at $s = 1$:

      \begin{proposition}\label{prop:zeta_residue}
        \[
          \Res_{s = 1}\z(s) = 1.
        \]
      \end{proposition}
      \begin{proof}
        The only term in \cref{equ:integral_representation_zeta_final} contributing to the pole is $-\frac{\pi^{\frac{s}{2}}}{\G\left(\frac{s}{2}\right)}\frac{1}{s(1-s)}$. Observe that
        \[
          \lim_{s \to 1}\frac{\pi^{\frac{s}{2}}}{\G\left(\frac{s}{2}\right)} = 1,
        \]
        because $\G\left(\frac{1}{2}\right) = \sqrt{\pi}$. Therefore
        \[
          \Res_{s = 1}\z(s) = \Res_{s = 1}\left(-\frac{\pi^{\frac{s}{2}}}{\G\left(\frac{s}{2}\right)}\frac{1}{s(1-s)}\right) = \lim_{s \to 1}\left(\frac{\pi^{\frac{s}{2}}}{\G\left(\frac{s}{2}\right)}\frac{1}{s}\right) = 1.
        \]
      \end{proof}

      We summarize all of our work into the following theorem:

      \begin{theorem}\label{thm:zeta_Selberg}
        $\z(s)$ is a primitive Selberg class $L$-function. For $\s > 1$, it has a degree $1$ Euler product given by
        \[
          \z(s) = \prod_{p}(1-p^{-s})^{-1}.
        \]
        Moreover, it admits meromorphic continuation to $\C$, possesses the functional equation
        \[
          \pi^{-\frac{s}{2}}\G\left(\frac{s}{2}\right)\z(s) = \L(s,\z) = \L(1-s,\z),
        \]
        and has a simple pole at $s = 1$ of residue $1$.
      \end{theorem}

      Lastly, we note that by virtue of the functional equation we can also compute $\z(0)$. Indeed, since $\Res_{s = 1}\z(s) = 1$, we have
      \[
        \lim_{s \to 1}(s-1)\L(s,\z) = \Res_{s = 1}\z(s)\lim_{s \to 1}\pi^{-\frac{s}{2}}\G\left(\frac{s}{2}\right) = 1.
      \]
      In other words, $\L(s,\z)$ has a simple pole at $s = 1$ with residue $1$ too. Since the completed Riemann zeta function is completely symmetric as $s \mapsto 1-s$, it has a simple pole at $s = 0$ with residue $1$. Hence
      \[
        1 = \lim_{s \to 1}(s-1)\L(1-s,\z) = \Res_{s = 1}\G\left(\frac{1-s}{2}\right)\lim_{s \to 1}\pi^{-\frac{1-s}{2}}\z(1-s) = -2\z(0),
      \]
      because $\Res_{s = 0}\G(s) = 1$. Therefore $\z(0) = -\frac{1}{2}$.
  \section{Dirichlet \texorpdfstring{$L$}{L}-functions}
    \subsection*{The Definition \& Euler Product}
      To every Dirichlet character $\chi$ there is an associated $L$-function. Throughout we will let $m$ denote the modulus and $q$ the conductor of $\chi$ respectively. The \textbf{Dirichlet $L$-series}\index{Dirichlet $L$-series} (respectively \textbf{Dirichlet $L$-function}\index{Dirichlet $L$-function} if it is an $L$-function) $L(s,\chi)$ attached to the Dirichlet character $\chi$ is defined by the following Dirichlet series:
      \[
        L(s,\chi) = \sum_{n \ge 1}\frac{\chi(n)}{n^{s}}.
      \]
      Since $\chi(n) = 0$ if $(n,m) > 1$, the above sum can be restricted to all positive integers relatively prime to $m$. We will see that $L(s,\chi)$ is a Selberg class $L$-function if $\chi$ is primitive and of conductor $q > 1$ (in the case $q = 1$, $L(s,\chi) = \z(s)$). From now we make this assumption about $\chi$. As the coefficients are uniformly bounded and $\chi$ is completely multiplicative, $L(s,\chi)$ is locally absolutely uniformly convergent for $\s > 1$ and admits the following degree $1$ Euler product by \cref{prop:Dirichlet_series_Euler_product}:
      \[
        L(s,\chi) = \prod_{p}(1-\chi(p)p^{-s})^{-1} = \prod_{p \nmid q}(1-\chi(p)p^{-s})^{-1},
      \]
      where the second equality holds because if $p \mid q$ we have $\chi(p) = 0$. The local factor at $p$ is
      \[
        L_{p}(s,\chi) = 1 \quad \text{or} \quad L_{p}(s,\chi) = (1-\chi(p)p^{-s})^{-1},
      \]
      with local root $0$ or $\chi(p)$ respectively and according to if $p \mid q$ or not. As the degree of $L(s,\chi)$ is $1$, it will necessarily be primitive once we show it is Selberg class.
    \subsection*{The Integral Representation: Part I}
      The integral representation for $L(s,\chi)$ is deduced in a similar way as for $\z(s)$. However, it will depend on if $\chi$ is even or odd. To handle both cases simultaneously let $\d_{\chi} = 0,1$ according to whether $\chi$ is even or odd. In other words,
      \[
        \d_{\chi} = \frac{\chi(1)-\chi(-1)}{2}.
      \]
      We also have $\chi(-1) = (-1)^{\d_{\chi}}$. Note that $\d_{\chi}$ takes the same value for both $\chi$ and $\cchi$. To find an integral representation for $L(s,\chi)$, consider the function
      \[
        \w_{\chi}(z) = \sum_{n \ge 1}\chi(n)n^{\d_{\chi}}e^{\pi in^{2}z},
      \]
      defined for $z \in \H$. It is locally absolutely uniformly convergent in this region by the Weierstrass $M$-test. Moreover, we have
      \[
        \w_{\chi}(z) = O\left(\sum_{n \ge 1}ne^{-\pi n^{2}y}\right) = O(e^{-\pi y}),
      \]
      where the second equality holds because each term is of smaller order than the next so that the series is bounded by a constant times the first term. Hence $\w_{\chi}(z)$ exhibits exponential decay. Now consider the following Mellin transform:
      \[
        \int_{0}^{\infty}\w_{\chi}(iy)y^{\frac{s+\d_{\chi}}{2}}\,\frac{dy}{y}.
      \]
      By the exponential decay of $w_{\chi}$, this integral is locally absolutely uniformly convergent for $\s > 1$ and hence defines an analytic function there. Then we compute
      \begin{align*}
        \int_{0}^{\infty}\w_{\chi}(iy)y^{\frac{s+\d_{\chi}}{2}}\,\frac{dy}{y} &= \int_{0}^{\infty}\sum_{n \ge 1}\chi(n)n^{\d_{\chi}}e^{-\pi n^{2}y}y^{\frac{s+\d_{\chi}}{2}}\,\frac{dy}{y} \\
        &= \sum_{n \ge 1}\int_{0}^{\infty}\chi(n)n^{\d_{\chi}}e^{-\pi n^{2}y}y^{\frac{s+\d_{\chi}}{2}}\,\frac{dy}{y} && \text{FT} \\
        &= \sum_{n \ge 1}\frac{\chi(n)}{\pi^{\frac{s+\d_{\chi}}{2}}n^{s}}\int_{0}^{\infty}e^{-y}y^{\frac{s+\d_{\chi}}{2}}\,\frac{dy}{y} && \text{$y \mapsto \frac{y}{\pi n^{2}}$} \\
        &= \frac{\G\left(\frac{s+\d_{\chi}}{2}\right)}{\pi^{\frac{s+\d_{\chi}}{2}}}\sum_{n \ge 1}\frac{\chi(n)}{n^{s}} \\
        &= \frac{\G\left(\frac{s+\d_{\chi}}{2}\right)}{\pi^{\frac{s+\d_{\chi}}{2}}}L(s,\chi).
      \end{align*}
      Therefore we have an integral representation
      \begin{equation}\label{equ:integral_representation_Dirichlet_L-functions_1}
        L(s,\chi) = \frac{\pi^{\frac{s+\d_{\chi}}{2}}}{\G\left(\frac{s+\d_{\chi}}{2}\right)}\int_{0}^{\infty}\w_{\chi}(iy)y^{\frac{s+\d_{\chi}}{2}}\,\frac{dy}{y},
      \end{equation}
      and just as for the Riemann zeta function, we need to find a functional equation for $\w_{\chi}(z)$ before we can proceed.
    \subsection*{The Dirichlet Theta Function}
      The \textbf{Dirichlet theta function}\index{Dirichlet theta function} $\vt_{\chi}(z)$ attached to the character $\chi$, is defined by
      \[
        \vt_{\chi}(z) = \sum_{n \in \Z}\chi(n)n^{\d_{\chi}}e^{2\pi in^{2}z},
      \]
      for $z \in \H$. It is locally absolutely uniformly convergent in this region by the Weierstrass $M$-test. Moreover,
      \[
        \vt_{\chi}(z) = O\left(\sum_{n \in \Z}ne^{-2\pi n^{2}y}\right) = O(e^{-2\pi y}),
      \]
      where the second equality holds because each term is of smaller order than the $n = \pm 1$ terms so that the series is bounded by a constant times the order of these terms. In particular, $\vt_{\chi}(z)$ exhibits exponential decay. The relationship to $\w_{\chi}(z)$ is given by
      \[
        \w_{\chi}(z) = \frac{\vt_{\chi}\left(\frac{z}{2}\right)}{2}.
      \]
      This is a slightly less complex relationship than the analog for the Jacobi theta function because assuming $q > 1$ means $\chi(0) = 0$. The essential fact we will need is a functional equation for the Dirichlet theta function:

      \begin{theorem}\label{thm:functional_equation_Dirichlet_theta}
        Let $\chi$ be a primitive Dirichlet character of conductor $q > 1$. For $z \in \H$,
        \[
          \vt_{\chi}(z) = \frac{\e_{\chi}}{i^{\d_{\chi}}(-2qiz)^{\frac{1}{2}+\d_{\chi}}}\vt_{\cchi}\left(-\frac{1}{4q^{2}z}\right).
        \]
      \end{theorem}
      \begin{proof}
        Since $\chi$ is $q$-periodic and $\vt_{\chi}(z)$ is absolutely convergent, we can write
        \[
          \vt_{\chi}(z) = \sum_{a \tmod{q}}\chi(a)\sum_{m \in \Z}(mq+a)^{\d_{\chi}}e^{2\pi i(mq+a)^{2}z}.
        \]
        Set
        \[
          I_{a}(z) = \sum_{m \in \Z}(mq+a)^{\d_{\chi}}e^{2\pi i(mq+a)^{2}z}.
        \]
        We will apply the Poisson summation formula to $I_{a}(z)$. To do this, we compute the Fourier transform of the summand and by the identity theorem it suffices to verify this for $z = iy$ with $y > 0$. So set
        \[
          f(x) = (xq+a)^{\d_{\chi}}e^{-2\pi(xq+a)^{2}y}.
        \]
        Then $f(x)$ is of Schwarz class. By \cref{prop:Fourier_transform_properties} (i)-(iv) and \cref{prop:Fourier_transform_of_exponential_single_variable}, we have
        \[
          (\mc{F}f)(t) = \left(\frac{-it}{2qy}\right)^{\d_{\chi}}\frac{e^{\frac{2\pi iat}{q}-\frac{\pi t^{2}}{2q^{2}y}}}{\sqrt{2q^{2}y}}.
        \]
        By the Poisson summation formula and the identity theorem, we have
        \[
          I_{a}(z) = \sum_{m \in \Z}(mq+a)^{\d_{\chi}}e^{2\pi i(mq+a)^{2}z} = \sum_{t \in \Z}\left(\frac{-it}{2q(-iz)}\right)^{\d_{\chi}}\frac{e^{\frac{2\pi iat}{q}-\frac{\pi t^{2}}{2q^{2}(-iz)}}}{\sqrt{2q^{2}(-iz)}}.
        \]
        Plugging this back into the definition of $\vt_{\chi}(z)$ yields
        \begin{align*}
          \vt_{\chi}(z) &= \sum_{a \tmod{q}}\chi(a)\sum_{t \in \Z}\left(\frac{-it}{2q(-iz)}\right)^{\d_{\chi}}\frac{e^{\frac{2\pi iat}{q}-\frac{\pi t^{2}}{2q^{2}(-iz)}}}{\sqrt{2q^{2}(-iz)}} \\
          &= \sum_{a \tmod{q}}\chi(a)\sum_{t \in \Z}\left(\frac{t}{i(-2qiz)}\right)^{\d_{\chi}}\frac{e^{\frac{2\pi iat}{q}-\frac{\pi it^{2}}{2q^{2}z}}}{\sqrt{q(-2qiz)}} \\
          &= \frac{1}{i^{\d_{\chi}}\sqrt{q}(-2qiz)^{\frac{1}{2}+\d_{\chi}}}\sum_{t \in \Z}t^{\d_{\chi}}e^{-\frac{\pi it^{2}}{2q^{2}z}}\sum_{a \tmod{q}}\chi(a)e^{\frac{2\pi i at}{q}} \\
          &= \frac{1}{i^{\d_{\chi}}\sqrt{q}(-2qiz)^{\frac{1}{2}+\d_{\chi}}}\sum_{t \in \Z}t^{\d_{\chi}}e^{-\frac{\pi it^{2}}{2q^{2}z}}\tau(t,\chi) && \text{definition of $\tau(t,\chi)$} \\
          &= \frac{\tau(\chi)}{i^{\d_{\chi}}\sqrt{q}(-2qiz)^{\frac{1}{2}+\d_{\chi}}}\sum_{t \in \Z}\cchi(t)t^{\d_{\chi}}e^{-\frac{\pi it^{2}}{2q^{2}z}} && \text{\cref{cor:gauss_sum_primitive_formula}} \\
          &= \frac{\e_{\chi}}{i^{\d_{\chi}}(-2qiz)^{\frac{1}{2}+\d_{\chi}}}\sum_{t \in \Z}\cchi(t)t^{\d_{\chi}}e^{-\frac{\pi it^{2}}{2q^{2}z}} && \text{$\e_{\chi} = \frac{\tau(\chi)}{\sqrt{q}}$} \\
          &= \frac{\e_{\chi}}{i^{\d_{\chi}}(-2qiz)^{\frac{1}{2}+\d_{\chi}}}\sum_{t \in \Z}\cchi(t)t^{\d_{\chi}}e^{2\pi it^{2}\left(-\frac{1}{4q^{2}z}\right)} \\
          &=  \frac{\e_{\chi}}{i^{\d_{\chi}}(-2qiz)^{\frac{1}{2}+\d_{\chi}}}\vt_{\cchi}\left(-\frac{1}{4q^{2}z}\right).
        \end{align*}
      \end{proof}

      Notice that the functional equation relates $\vt_{\chi}(z)$ to $\vt_{\cchi}(z)$. Regardless, we will use \cref{thm:functional_equation_Dirichlet_theta} to analytically continue $L(s,\chi)$.
    \subsection*{The Integral Representation: Part II}
      Returning to $L(s,\chi)$, split the integral in \cref{equ:integral_representation_Dirichlet_L-functions_1} into two pieces by writing
      \begin{equation}\label{equ:symmetric_integral_Dirichlet_L-functions_split}
        \int_{0}^{\infty}\w_{\chi}(iy)y^{\frac{s+\d_{\chi}}{2}}\,\frac{dy}{y} = \int_{0}^{\frac{1}{q}}\w_{\chi}(iy)y^{\frac{s+\d_{\chi}}{2}}\,\frac{dy}{y}+\int_{\frac{1}{q}}^{\infty}\w_{\chi}(iy)y^{\frac{s+\d_{\chi}}{2}}\,\frac{dy}{y}.
      \end{equation}
      We now rewrite the first piece in the same form and symmetrize the result as much as possible. Start by performing a change of variables $y \mapsto \frac{1}{q^{2}y}$ to the first piece to obtain
      \[
        \int_{\frac{1}{q}}^{\infty}\w_{\chi}\left(\frac{i}{q^{2}y}\right)(q^{2}y)^{-\frac{s+\d_{\chi}}{2}}\,\frac{dy}{y}.
      \]
      Now we compute
      \begin{align*}
        \w_{\chi}\left(\frac{i}{q^{2}y}\right) &= \w_{\chi}\left(-\frac{1}{q^{2}iy}\right) \\
        &= \frac{\vt_{\chi}\left(-\frac{1}{2q^{2}iy}\right)}{2} \\
        &= \frac{i^{\d_{\chi}}(qy)^{\frac{1}{2}+\d_{\chi}}}{\e_{\cchi}}\frac{\vt_{\cchi}\left(\frac{iy}{2}\right)}{2} && \text{\cref{thm:functional_equation_Dirichlet_theta}} \\
        &= \e_{\chi}(-i)^{\d_{\chi}}(qy)^{\frac{1}{2}+\d_{\chi}}\frac{\vt_{\cchi}\left(\frac{iy}{2}\right)}{2} && \text{\cref{prop:epsilon_factor_relationship} and that $\chi(-1) = (-1)^{\d_{\chi}}$} \\
        &= \frac{\e_{\chi}(qy)^{\frac{1}{2}+\d_{\chi}}}{i^{\d_{\chi}}}\frac{\vt_{\cchi}\left(\frac{iy}{2}\right)}{2} \\
        &= \frac{\e_{\chi}(qy)^{\frac{1}{2}+\d_{\chi}}}{i^{\d_{\chi}}}\w_{\cchi}(iy).
      \end{align*}
      This chain implies that our first piece can be expressed as
      \[
        \frac{\e_{\chi}}{i^{\d_{\chi}}}q^{\frac{1}{2}-s}\int_{\frac{1}{q}}^{\infty}\w_{\cchi}(iy)y^{\frac{(1-s)+\d_{\chi}}{2}}\,\frac{dy}{y}.
      \]
      Substituting this expression back into \cref{equ:symmetric_integral_Dirichlet_L-functions_split} and combining with \cref{equ:integral_representation_Dirichlet_L-functions_1} gives the integral representation
      \begin{equation}\label{equ:integral_representation_Dirichlet_final}
        L(s,\chi) = \frac{\pi^{\frac{s+\d_{\chi}}{2}}}{\G\left(\frac{s+\d_{\chi}}{2}\right)}\left[\frac{\e_{\chi}}{i^{\d_{\chi}}}q^{\frac{1}{2}-s}\int_{\frac{1}{q}}^{\infty}\w_{\cchi}(iy)y^{\frac{(1-s)+\d_{\chi}}{2}}\,\frac{dy}{y}+\int_{\frac{1}{q}}^{\infty}\w_{\chi}(iy)y^{\frac{s+\d_{\chi}}{2}}\,\frac{dy}{y}\right].
      \end{equation}
      This integral representation will give analytic continuation. Indeed, we know everything outside the brackets is entire. The integrands exhibit exponential decay and therefore the integrals are locally absolutely uniformly convergent on $\C$. This gives analytic continuation to all of $\C$. In particular, $L(s,\chi)$ has no poles.
    \subsection*{The Functional Equation}
      An immediate consequence of applying the symmetry $s \mapsto 1-s$ to \cref{equ:integral_representation_Dirichlet_final} is the following functional equation:
      \[
        q^{\frac{s}{2}}\frac{\G\left(\frac{s+\d_{\chi}}{2}\right)}{\pi^{\frac{s+\d_{\chi}}{2}}}L(s,\chi) = \frac{\e_{\chi}}{i^{\d_{\chi}}}q^{\frac{1-s}{2}}\frac{\G\left(\frac{(1-s)+\d_{\chi}}{2}\right)}{\pi^{\frac{(1-s)+\d_{\chi}}{2}}}L(1-s,\cchi).
      \]
      We identify the gamma factor as
      \[
        \g(s,\chi) = \pi^{-\frac{s}{2}}\G\left(\frac{s+\d_{\chi}}{2}\right),
      \]
      with $\k = \d_{\chi}$ the only local root at infinity. Clearly it satisfies the required bounds. The conductor is $q(\chi) = q$ and if $p$ is an unramified prime then the local root is $\chi(p) \neq 0$. The completed $L$-function is
      \[
        \L(s,\chi) = q^{\frac{s}{2}}\pi^{-\frac{s}{2}}\G\left(\frac{s+\d_{\chi}}{2}\right)L(s,\chi),
      \]
      with functional equation
      \[
        \L(s,\chi) = \frac{\e_{\chi}}{i^{\d_{\chi}}}\L(1-s,\cchi).
      \]
      From it we see that the root number is $\e(\chi) = \frac{\e_{\chi}}{i^{\d_{\chi}}}$ and that $L(s,\chi)$ has dual $L(s,\cchi)$. We now show that $L(s,\chi)$ is of order $1$. Since $L(s,\chi)$ has no poles, we do not need to clear any polar divisors. As the integrals in \cref{equ:integral_representation_Dirichlet_final} are locally absolutely uniformly convergent, computing the order amounts to estimating the gamma factor. Since the reciprocal of the gamma function is of order $1$, we have
      \[
        \frac{1}{\g(s,\chi)} \ll_{\e} e^{|s|^{1+\e}}.
      \]
      So the reciprocal of the gamma factor is also of order $1$. It follows that
      \[
        L(s,\chi) \ll_{\e} e^{|s|^{1+\e}}.
      \]
      So $L(s,\chi)$ is of order $1$. We summarize all of our work into the following theorem:

      \begin{theorem}\label{thm:primitive_Dirichlet_Selberg}
        For any primitive Dirichlet character $\chi$ of conductor $q > 1$, $L(s,\chi)$ is a primitive Selberg class $L$-function. For $\s > 1$, it has a degree $1$ Euler product given by
        \[
          L(s,\chi) = \prod_{p}(1-\chi(p)p^{-s})^{-1} = \prod_{p \nmid q}(1-\chi(p)p^{-s})^{-1}.
        \]
        Moreover, it admits analytic continuation to $\C$ and possesses the functional equation
        \[
          q^{\frac{s}{2}}\pi^{-\frac{s}{2}}\G\left(\frac{s+\d_{\chi}}{2}\right)L(s,\chi) = \L(s,\chi) = \frac{\e_{\chi}}{i^{\d_{\chi}}}\L(1-s,\cchi).
        \]
      \end{theorem}
    \subsection*{Beyond Primitivity}
      We can still obtain meromorphic continuation of the $L$-series $L(s,\chi)$ if $\chi$ is imprimitive. 
      
      
      Indeed, if $\chi$ is induced by $\wtilde{\chi}$, then $\chi(p) = \wtilde{\chi}(p)$ if $p \nmid q$ and $\chi(p) = 0$ if $p \mid m$. Then just as for primitive characters, \cref{prop:Dirichlet_series_Euler_product} implies that $L(s,\chi)$ is locally absolutely uniformly convergent for $\s > 1$ and admits the following degree $1$ Euler product:
      \begin{equation}\label{equ:non-primitive_primitive_Dirichlet_L-series_relation}
        L(s,\chi) = \prod_{p \nmid m}(1-\wtilde{\chi}(p)p^{-s})^{-1} = \prod_{p}(1-\wtilde{\chi}(p)p^{-s})^{-1}\prod_{p \mid m}(1-\wtilde{\chi}(p)p^{-s}) = L(s,\wtilde{\chi})\prod_{p \mid m}(1-\wtilde{\chi}(p)p^{-s}).
      \end{equation}
      From this relation, we can prove the following:

      \begin{theorem}\label{thm:analytic_continuation_Dirichlet}
        For any Dirichlet character $\chi$ modulo $m$ of conductor $q > 1$, $L(s,\chi)$ is locally absolutely uniformly convergent for $\s > 1$ with degree $1$ Euler product given by
        \[
          L(s,\chi) = \prod_{p \nmid m}(1-\wtilde{\chi}(p)p^{-s})^{-1}.
        \]
        Moreover, it admits meromorphic continuation to $\C$ and if $\chi$ is principal there is a simple pole at $s = 1$ of residue $\prod_{p \mid m}(1-\wtilde{\chi}(p)p^{-1})$ where $\wtilde{\chi}$ is the primitive character inducing $\chi$.
      \end{theorem}
      \begin{proof}
        This follows from \cref{thm:zeta_Selberg,thm:primitive_Dirichlet_Selberg,equ:non-primitive_primitive_Dirichlet_L-series_relation}. 
      \end{proof}

      It is worth noting that for any non-principal Dirichlet character $\chi$, the $L$-series $L(s,\chi)$ converges for $\s > 0$. Indeed, setting $A(X) = \sum_{n \le X}\chi(n)$ we have $A(X) \ll 1$ by the orthogonality relations (\cref{cor:Dirichlet_orthogonality_relations} (i)) and that $\chi$ is periodic, and then the claim follows from \cref{prop:Dirichlet_series_convergence_bounded_coefficient_sum}. While this fact is not too important from an analytic continuation standpoint, it is useful because it allows for the manipulation (without rearrangement since we do not have absolute convergence) of the Dirichlet series $L(s,\chi)$ in the vertical strip $0 < \s \le 1$.
  \section{Dedekind Zeta Functions}
    \subsection*{The Definition \& Euler Product}
      We can associate and $L$-function to every number field. Let $K$ be a number field of degree $d$ and signature $(r_{1},r_{2})$. The \textbf{Dedekind zeta function}\index{Dedekind zeta function} $\z_{K}(s)$ is defined by the following Dirichlet series
      \[
        \z_{K}(s) = \sum_{n \ge 1}\frac{a_{K}(n)}{n^{s}}.
      \]

      \begin{remark}
        If we sum over integral ideals of $K$ instead, we can write
        \[
          \z_{K}(s) = \sum_{\text{$\mf{a}$ integral}}\frac{1}{\Norm(\mf{a})^{s}}.
        \]
      \end{remark}

      We will see that $\z_{K}(s)$ is a Selberg class $L$-function (note that $\z_{K}(s) = \z(s)$ when $d = 1$). We have already shown that the coefficients $a_{K}(n)$ are multiplicative and satisfy $a_{K}(n) \ll_{\e} n^{\e}$ by \cref{equ:ideals_of_fixed_norm_bound} (recall \cref{prop:sum_of_divisors_growth_rate}). By \cref{prop:Dirichlet_series_Euler_product}, $\z_{K}(s)$ is locally absolutely uniformly convergent for $\s > 1$ and admits the following infinite product expression:
      \[
        \z_{K}(s) = \prod_{p}\left(\sum_{n \ge 0}\frac{a_{K}(p^{n})}{p^{hs}}\right).
      \]
      Recall that each prime integral ideal $\mf{p}$ lies above a unique prime $p$ and $\Norm(\mf{p})$ is a power of $p$. As the norm is completely multiplicative by \cref{prop:ideal_norm_is_multiplicative}, the unique factorization of integral ideals implies that our infinite product can be expressed as
      \[
        \z_{K}(s) = \prod_{p}\prod_{\text{$\mf{p}$ above $p$}}(1-\Norm(\mf{p})p^{-s})^{-1} = \prod_{p}\prod_{1 \le i \le r_{p}}(1-p^{-f_{p}(\mf{p}_{i})s})^{-1},
      \]
      where $r_{p}$ is the number of prime integral ideals $\mf{p}_{1},\ldots,\mf{p}_{r_{p}}$ above $p$. As finitely many primes ramify by \cref{thm:ramification_division_equivalence}, \cref{prop:inertia_ramification_relation} implies that all but finitely many primes $p$ satisfy
      \[
        d = \sum_{1 \le i \le r_{p}}f_{p}(\mf{p}_{i}).
      \]
      In particular, at least one prime does. Therefore, letting $\w_{p,i}$ be a primitive $f_{p}(\mf{p}_{i})$-th root of unity, we have the following degree $d$ Euler product:
      \[
        \z_{K}(s) = \prod_{p}\prod_{\substack{1 \le i \le r_{p} \\ 1 \le k \le f_{p}(\mf{p}_{i})}}(1-\w_{p,i}^{k}p^{-s})^{-1}.
      \]
      The local factor at $p$ is
      \[
        \z_{K,p}(s) = \prod_{\substack{1 \le i \le r_{p} \\ 1 \le k \le f_{p}(\mf{p}_{i})}}(1-\w_{p,i}^{k}p^{-s})^{-1},
      \]
      with local roots $\w_{p,i}^{k}$ and $\sum_{1 \le i \le r_{p}}(e_{p}(\mf{p}_{i})-1)f_{p}(\mf{p}_{i})$ many local roots $0$.
    \subsection*{The Integral Representation: Part I}
      We will find an integral representation for $\z_{K}(s)$. To do this, let $\s$ run over the $n$ distinct $\Q$-embeddings of $K$ into $\conj{\Q}$ and let $\tau$ run over a complete set of representatives for the real and pairs of complex $\Q$-embeddings. Also recall that $N_{\tau} = 1,2$ depending upon if $\tau$ is real or complex. It will be useful to let
      \[
        \mathbf{N} = (N_{\tau})_{\tau}, \quad \mathbf{N}^{\vee} = (3-N_{\tau})_{\tau}, \quad \boldsymbol{\a} = (|\tau(\a)|)_{\tau},  \quad \text{and} \quad \boldsymbol{j(\a)} = (|\s(\a)|)_{\s},
      \]
      for all $\a \in K$. With this notation,
      \[
        \boldsymbol{\a}^{\mathbf{N}} = |\Norm(\a)|.
      \]
      Now consider the function
      \[
        \w_{K}(\mathbf{z}) = \sum_{n \ge 1}a_{K}(n)e^{\pi in^{\frac{2}{d}}\<\mathbf{z},\mathbf{N}\>},
      \]
      defined for $\mathbf{z} \in \H^{r_{K}+1}$. It is locally absolutely uniformly convergent in this region by the Weierstrass $M$-test. Taking $\e < 1$, the bound $a_{K}(n) \ll_{\e} n^{\e}$ gives
      \[
        \w_{K}(\mathbf{z}) = O\left(\sum_{n \ge 1}n^{r_{2}+1}e^{-\pi n^{\frac{2}{d}}||\mathbf{y}||_{\infty}}\right) = O(e^{-\pi||\mathbf{y}||_{\infty}}),
      \]
      where the second equality holds because each term is of smaller order than the next so that the series is bounded by a constant times the first term. Hence $\w_{K}(\mathbf{z})$ exhibits exponential decay. Now consider the following Mellin transform:
      \[
        \int_{\R_{+}^{r_{K}+1}}\w_{K}(i\mathbf{y})\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}}.
      \]
      By the exponential decay of $\w_{K}(\mathbf{z})$, this integral is locally absolutely uniformly convergent for $\s > 1$ and hence defines an analytic function there. Then we compute
      \begin{align*}
        \int_{\R_{+}^{r_{K}+1}}\w_{K}(i\mathbf{y})\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}} &= \int_{\R_{+}^{r_{K}+1}}\sum_{n \ge 1}a_{K}(n)e^{-\pi n^{\frac{2}{d}}\<\mathbf{y},\mathbf{N}\>}\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}} \\
        &= \sum_{n \ge 1}\int_{\R_{+}^{r_{K}+1}}a_{K}(n)e^{-\pi n^{\frac{2}{d}}\<\mathbf{y},\mathbf{N}\>}\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}} && \text{FT} \\
        &= \sum_{n \ge 1}\frac{a_{K}(n)}{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}n^{s}}\int_{\R_{+}^{r_{K}+1}}e^{-\<\mathbf{y},\mathbf{1}\>}\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}} && \text{$\mathbf{y} \mapsto \frac{\mathbf{y}}{\mathbf{N}\pi n^{\frac{2}{d}}}$} \\
        &= \frac{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}\sum_{n \ge 1}\frac{a_{K}(n)}{n^{s}} \\
        &= \frac{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}\z_{K}(s).
      \end{align*}
      Therefore we have an integral representation
      \[
        \z_{K}(s) = \frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\int_{\R_{+}^{r_{K}+1}}\w_{K}(i\mathbf{y})\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}}.
      \]
      We will manipulate the remaining integral to write it as a different Mellin transform. This will take a fair amount of work. As $\w_{K}(\mathbf{z})$ converges absolutely we may sum over integral ideals of $K$ and obtain
      \[
        \int_{\R_{+}^{r_{K}+1}}\sum_{\text{$\mf{a}$ integral}}e^{\pi i\Norm(\mf{a})^{\frac{2}{d}}\<i\mathbf{y},\mathbf{N}\>}\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}}.
      \]
      Now if $\mf{a}$ is an integral ideal, then $\mc{O}_{K}^{\ast}$ acts on $\mf{a}-\{0\}$ by multiplication. Therefore we have an orbit space $(\mf{a}-\{0\})/\mc{O}_{K}^{\ast}$. The following lemma establishes a bijection between this orbit space and integral ideals in an ideal class:

      \begin{lemma}\label{lem:Hecke_theta_function_lemma}
        Let $K$ be a number field. Suppose $\mf{a}$ is an integral ideal and $\mf{K}$ is the ideal class of $\mf{a}^{-1}$. Then there is a bijection
        \[
          (\mf{a}-\{0\})/\mc{O}_{K}^{\ast} \to \{\mf{b} \in \mf{K}:\text{$\mf{b}$ is an integral ideal}\} \qquad \a \mapsto \a\mf{a}^{-1}.
        \]
      \end{lemma}
      \begin{proof}
        We first show that this map is well-defined. If $\a \in \mf{a}$ is nonzero, then $\a\mf{a}^{-1} = \a\mc{O}_{K}\mf{a}^{-1} \subseteq \mc{O}_{K}$ by \cref{prop:explicit_inverse_ideal} so that $\a\mf{a}^{-1}$ is an integral ideal belonging to $\mf{K}$ (because it differs from $\mf{a}^{-1}$ by a principal ideal). Therefore the map is well-defined. To show injectivity, suppose $\a\mf{a}^{-1} = \b\mf{a}^{-1}$ for some $\a,\b \in (\mf{a}-\{0\})/\mc{O}_{K}^{\ast}$. Multiplying by $\mf{a}$, we obtain $\a\mc{O}_{K} = \b\mc{O}_{K}$ and hence $\a\b^{-1} \in \mc{O}_{K}^{\ast}$ from which injectivity follows. For surjectivity, the definition of $\mf{K}$ implies that any integral ideal $\mf{b} \in \mf{K}$ satisfies $\mf{b} = \a\mf{a}^{-1}$ for some nonzero $\a \in \mc{O}_{K}$ but then $\a \in \mf{a}\mf{b} \subseteq \mf{a}$.
      \end{proof}

       By Minkowski theorem, any ideal class is can be represented by an integral ideal $\mf{a}$. So let $\mf{a}_{1},\ldots,\mf{a}_{h_{K}}$ be a complete set of representatives of $\Cl(K)$ consisting only of integral ideals. As the ideal class group is a group, we see that $\mf{a}_{1}^{-1},\ldots,\mf{a}_{h_{K}}^{-1}$ is also a complete set of representatives. By \cref{lem:Hecke_theta_function_lemma}, this shows that every integral ideal is uniquely of the form $\a\mf{a}_{i}^{-1}$ for some $1 \le i \le h_{K}$ and $\a \in \mf{a}_{i}^{\ast}/\mc{O}_{K}^{\ast}$ and thus has norm $\Norm(\a\mf{a}_{i}^{-1})$. Then we may further rewrite our integral as
      \[
        \sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in (\mf{a}-\{0\})/\mc{O}_{K}^{\ast}}\int_{\R_{+}^{r_{K}+1}}e^{\pi i\Norm(\a\mf{a}^{-1})^{\frac{2}{d}}\<i\mathbf{y},\mathbf{N}\>}\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}},
      \]
      where we have interchange the two sums and integral by Fubini's theorem. Now perform the change of variables $\mathbf{y} \mapsto \boldsymbol{\a}^{2}\mathbf{y}$ to obtain
      \[
        \sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in (\mf{a}-\{0\})/\mc{O}_{K}^{\ast}}\int_{\R_{+}^{r_{K}+1}}e^{\pi i\Norm(\a\mf{a}^{-1})^{\frac{2}{d}}\<\boldsymbol{\a}^{2}i\mathbf{y},\mathbf{N}\>}(\boldsymbol{\a}^{2}\mathbf{y})^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}}.
      \]
      We will now alter the region of integration. Observe that any $\mathbf{y} \in \R_{+}^{r_{K}+1}$ can be written in the form
      \[
        \mathbf{y} = y^{\frac{1}{d}}\mathbf{x},
      \]
      where
      \[
        y = \Norm_{\R^{r_{K}+1}/\R}(\mathbf{y})^{\frac{d}{r_{K}+1}} \quad \text{and} \quad \mathbf{x} = \frac{\mathbf{y}}{\Norm_{\R^{r_{K}+1}/\R}(\mathbf{y})^{\frac{1}{r_{K}+1}}}.
      \]
      Therefore $\R_{+}^{r_{K}+1}$ decomposes as
      \[
        \R_{+}^{r_{K}+1} = (0,\infty) \x S,
      \]
      where $S$ is the norm-one hypersurface of $\R^{r_{K}+1}$. As $S$ is a multiplicative subgroup of $\R_{+}^{r_{K}+1}$, the measure $\frac{d\mathbf{y}}{\mathbf{y}}$ on $\R_{+}^{r_{K}+1}$ factors as
      \[
        \frac{d\mathbf{y}}{\mathbf{y}} = \frac{d\mathbf{x}\,dy}{y},
      \]
      where $d\mathbf{x}$ (which can also be written as $\frac{d\mathbf{x}}{\mathbf{x}}$ because $\mathbf{x} \in S$) is the restriction of the measure $\frac{d\mathbf{y}}{\mathbf{y}}$ to $S$. Therefore our expression takes the form
      \[
        \sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in (\mf{a}-\{0\})/\mc{O}_{K}^{\ast}}\int_{0}^{\infty}\int_{S}e^{\pi i\Norm(\a\mf{a}^{-1})^{\frac{2}{d}}\left\<\boldsymbol{\a}^{2}iy^{\frac{1}{d}}\mathbf{x},\mathbf{N}\right\>}\boldsymbol{\a}^{s\mathbf{N}}y^{\frac{s}{2}}\,\frac{d\mathbf{x}\,dy}{y}.
      \]
      Now consider the inverse isomorphisms
      \[
        \log:\R_{+}^{r_{K}+1} \to \R^{r_{K}+1} \qquad \text{and} \quad e:\R^{r_{K}+1} \to \R_{+}^{r_{K}+1}.
      \]
      In particular, they restricts to inverse bijections between the norm-one hypersurface $S$ and the trace-zero hyperplane $H$ ($\log(S) = H$ and $e^{H} = S$). By Dirichlet's unit theorem, $\mathbf{N}^{\vee}\L$ is a complete lattice in $H$ and therefore has fundamental domain $\mathbf{N}^{\vee}\mc{M}$ where $\mc{M}$ is a fundamental domain for $\L$. Then
      \[
        H = \bigcup_{\l \in \L}(\mathbf{N}^{\vee}\mc{M}+\mathbf{N}^{\vee}\l).
      \]
      Setting $\mc{F} = e^{\mathbf{N}^{\vee}\mc{M}}$, we see that $\mc{F}$ is a fundamental domain for the properly discontinuous action of $\L$ on $S$ by multiplication by $e^{\mathbf{N}^{\vee}\l}$ for all $\l \in \L$. In particular,
      \[
        S = \bigcup_{\l \in \L}e^{\mathbf{N}^{\vee}\l}\mc{F}.
      \]
      By \cref{prop:exact_sequence_for_Dirichlets_unit_theorem}, we may express this decomposition as
      \[
        S = \bigcup_{\e \in \mc{O}_{K}^{\ast}/\mu(K)}e^{\mathbf{N}^{\vee}\l(\e)}\mc{F}.
      \]
      Then folding yields
      \[
        \frac{1}{w_{K}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in (\mf{a}-\{0\})/\mc{O}_{K}^{\ast}}\sum_{\e \in \mc{O}_{K}^{\ast}}\int_{0}^{\infty}\int_{\mc{F}}e^{\pi i\Norm(\a\mf{a}^{-1})^{\frac{2}{d}}\left\<\boldsymbol{\a}^{2}e^{\mathbf{N}^{\vee}\l(\e)}iy^{\frac{1}{d}}\mathbf{x},\mathbf{N}\right\>}\boldsymbol{\a}^{s\mathbf{N}}y^{\frac{s}{2}}\,\frac{d\mathbf{x}\,dy}{y},
      \]
      because $e^{\mathbf{N}^{\vee}\l(\e)} = \mathbf{1}$ if $\e \in \mu(K)$ and we have interchanged the sum and integrals by Fubini's theorem. As $\boldsymbol{\e}^{\mathbf{N}} = |\Norm(\e)| = 1$ for all $\e \in \mc{O}_{K}^{\ast}$, we can use \cref{cor:unit_if_and_only_if_absolute_value_norm_1} to write our expression as
      \[
        \frac{1}{w_{K}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in (\mf{a}-\{0\})/\mc{O}_{K}^{\ast}}\sum_{\e \in \mc{O}_{K}^{\ast}}\int_{0}^{\infty}\int_{\mc{F}}e^{\pi i\Norm(\a\e\mf{a}^{-1})^{\frac{2}{d}}\left\<\boldsymbol{\a}^{2}e^{\mathbf{N}\l(\e^{2})}iy^{\frac{1}{d}}\mathbf{x},\mathbf{N}\right\>}(\boldsymbol{\a}\boldsymbol{\e})^{s\mathbf{N}}y^{\frac{s}{2}}\,\frac{d\mathbf{x}\,dy}{y}.
      \]
      By the definition of $\l$ and $\mathbf{N}^{\vee}$, we have $\boldsymbol{\a}^{2}e^{\mathbf{N}\l(\e)} = (\boldsymbol{\a\e})^{2}$ and therefore we may combine the innermost two sums to obtain
      \[
        \frac{1}{w_{K}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in \mf{a}-\{0\}}\int_{0}^{\infty}\int_{\mc{F}}e^{\pi i\Norm(\a\mf{a}^{-1})^{\frac{2}{d}}\left\<\boldsymbol{\a}^{2}iy^{\frac{1}{d}}\mathbf{x},\mathbf{N}\right\>}\boldsymbol{\a}^{s\mathbf{N}}y^{\frac{s}{2}}\,\frac{d\mathbf{x}\,dy}{y}.
      \]
      Performing the change of variables $y \mapsto \frac{y}{\boldsymbol{\a}^{2\mathbf{N}}}$ gives
      \[
        \frac{1}{w_{K}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in \mf{a}-\{0\}}\int_{0}^{\infty}\int_{\mc{F}}e^{\pi i\Norm(\mf{a}^{-1})^{\frac{2}{d}}\left\<\boldsymbol{\a}^{2}iy^{\frac{1}{d}}\mathbf{x},\mathbf{N}\right\>}y^{\frac{s}{2}}\,\frac{d\mathbf{x}\,dy}{y},
      \]
      Interchanging the the two integrals with the two sums by Fubini's theorem and noting that $\<\mathbf{N},\boldsymbol{\a}^{2}\> = \<\boldsymbol{j(\a)},\boldsymbol{j(\a)}\>$, our expression becomes
      \[
        \int_{0}^{\infty}\int_{\mc{F}}\frac{1}{w_{K}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{j(\a) \in j(\mf{a})-\{\mathbf{0}\}}e^{\pi i\Norm(\mf{a}^{-1})^{\frac{2}{d}}\left\<iy^{\frac{1}{d}}\mathbf{x}\boldsymbol{j(\a)},\boldsymbol{j(\a)}\right\>}y^{\frac{s}{2}}\,\frac{d\mathbf{x}\,dy}{y}.
      \]
      We compactly express this as
      \[
        \int_{0}^{\infty}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y},
      \]
      where we have defined $\w_{\mc{F}}(z)$ by
      \[
        \w_{\mc{F}}(z) = \int_{\mc{F}}\frac{1}{w_{K}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{j(\a) \in j(\mf{a})-\{\mathbf{0}\}}e^{\pi i\Norm(\mf{a}^{-1})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a)},\boldsymbol{j(\a)}\>}\,d\mathbf{x},
      \]
      for $z \in \H$. It is locally absolutely uniformly convergent in this region by the Weierstrass $M$-test and that $\mc{F}$ is compact (because $\mathbf{N}^{\vee}\mc{M}$ is and $\log(\mathbf{x})$ is continuous). At last, this gives a final integral representation
      \begin{equation}\label{equ:integral_representation_Dedekind_1}
        \z_{K}(s) = \frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\int_{0}^{\infty}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y},
      \end{equation}
      where the integral is a Mellin transform. We cannot proceed until we obtain a functional equation for $\w_{\mc{F}}(z)$. So we will make a detour and come back to the integral representation after.
    \subsection*{The Hecke Theta Function}
      The \textbf{Hecke theta function}\index{Hecke theta function} $\vt_{\mf{f}}(z\mathbf{x})$ attached to a fractional ideal $\mf{f}$ of $K$, is defined by
      \[
        \vt_{\mf{f}}(z\mathbf{x}) = \sum_{j(\a) \in j(\mf{f})}e^{2\pi i\Norm(\mf{f}^{-1})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a)},\boldsymbol{j(\a)}\>},
      \]
      for $z \in \H$ and $\mathbf{x} \in S$. It is locally absolutely uniformly convergent in this region by the Weierstrass $M$-test. Moreover,
      \[
        \vt_{\mf{f}}(z\mathbf{x})-1 = O\left(\sum_{j(\a) \in j(\mf{f})-\{\mathbf{0}\}}e^{-2\pi y||\mathbf{x}||_{\infty}\Norm(\mf{f}^{-1})^{\frac{2}{d}}\<\boldsymbol{j(\a)},\boldsymbol{j(\a)}\>}\right) = O(e^{-2\pi y||\mathbf{x}||_{\infty}}),
      \]
      where the second equality follows since $\<\boldsymbol{j(\a)},\boldsymbol{j(\a)}\> \ge d|\Norm(\a)|^{\frac{2}{d}}$ by the arithmetic-geometric inequality provided $\a$ is nonzero, and that $|\Norm(\a)|\Norm(\mf{f})$ is a positive integer for all nonzero $\a \in \mf{f}$ (as $\a\mf{f}^{-1}$ is an integral ideal by \cref{prop:explicit_inverse_ideal}), which combined show that each term is of smaller order than the single term where $\Norm(\a\mf{f}^{-1}) = 1$ (when $\a\mf{f}^{-1} = \mc{O}_{K}$) corresponding to $\a = \Norm(\mf{f})$ so that the sum is bounded by a constant times this term. The relationship to $\w_{\mc{F}}(z)$ is given by
      \[
        \w_{\mc{F}}(z) = \frac{1}{w_{K}}\int_{\mc{F}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\vt_{\mf{a}}\left(\frac{z\mathbf{x}}{2}\right)\,d\mathbf{x}-\frac{h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x}.
      \]
      The essential fact we will need is a functional equation for the Hecke theta function:

      \begin{theorem}\label{thm:functional_equation_Hecke_theta}
        Let $K$ be a number field of degree $d$ and let $\mf{f}$ be a fractional ideal. For any $z \in \H$ and $\mathbf{x} \in S$,
        \[
          \vt_{\mf{f}}(z\mathbf{x}) = \frac{1}{(-2|\D_{K}|^{\frac{1}{d}}iz)^{\frac{d}{2}}}\vt_{\mf{f}^{\vee}}\left(-\frac{\mathbf{x}}{4|\D_{K}|^{\frac{2}{d}}z}\right).
        \]
      \end{theorem}
      \begin{proof}
        We will apply the Poisson summation formula to
        \[
          \vt_{\mf{f}}(z\mathbf{x}) = \sum_{j(\a) \in j(\mf{f})}e^{2\pi i\Norm(\mf{f}^{-1})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a)},\boldsymbol{j(\a)}\>}.
        \]
        To do this, we compute the Fourier transform of the summand and by the identity theorem it suffices to verify this for $z = iy$ with $y > 0$ and $\mathbf{x} = \mathbf{1}$. So set
        \[
          f(\mathbf{x}) = e^{-2\pi y\Norm(\mf{f}^{-1})^{\frac{2}{d}}\<\mathbf{x},\mathbf{x}\>}.
        \]
        Then $f(\mathbf{x})$ is of Schwarz class. By \cref{cor:Fourier_transform_of_exponential_single_variable} and multiplicativity of the norm, we have
        \[
          (\mc{F}f)(\mathbf{t}) = \Norm(\mf{f})\frac{e^{-\frac{\pi\Norm(\mf{f})^{\frac{2}{d}}\<\mathbf{t},\mathbf{t}\>}{2y}}}{(2y)^{\frac{d}{2}}}.
        \]
        By the Poisson summation formula and the identity theorem, we compute
        \begin{align*}
          \vt_{\mf{f}}(z\mathbf{x}) &= \sum_{j(\a) \in j(\mf{f})}e^{2\pi i\Norm(\mf{f}^{-1})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a)},\boldsymbol{j(\a)}\>} \\
          &= \frac{1}{V_{j(\mf{f})}}\sum_{\a^{\vee} \in \mf{f}^{\vee}}\Norm(\mf{f})\frac{e^{-\frac{\pi\Norm(\mf{f})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a^{\vee})},\boldsymbol{j(\a^{\vee})}\>}{-2iz}}}{(-2iz)^{\frac{d}{2}}} \\
          &= \frac{1}{\Norm(\mf{f})\sqrt{|\D_{K}|}}\sum_{\a^{\vee} \in \mf{f}^{\vee}}\Norm(\mf{f})\frac{e^{-\frac{\pi\Norm(\mf{f})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a^{\vee})},\boldsymbol{j(\a^{\vee})}\>}{-2iz}}}{(-2iz)^{\frac{d}{2}}} && \text{\cref{prop:covolume_of_fractional_ideal_under_j}} \\
          &= \frac{1}{(-2|\D_{K}|^{\frac{1}{d}}iz)^{\frac{d}{2}}}\sum_{\a^{\vee} \in \mf{f}^{\vee}}e^{-\frac{\pi\Norm(\mf{f})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a^{\vee})},\boldsymbol{j(\a^{\vee})}\>}{-2iz}} \\
          &= \frac{1}{(-2|\D_{K}|^{\frac{1}{d}}iz)^{\frac{d}{2}}}\sum_{\a^{\vee} \in \mf{f}^{\vee}}e^{-\frac{\pi\left(\Norm((\mf{f}^{\vee})^{-1})|\D|_{K}^{-1}\right)^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a^{\vee})},\boldsymbol{j(\a^{\vee})}\>}{-2iz}} && \text{\cref{cor:norm_of_different}} \\
          &= \frac{1}{(-2|\D_{K}|^{\frac{1}{d}}iz)^{\frac{d}{2}}}\sum_{\a^{\vee} \in \mf{f}^{\vee}}e^{2\pi i\Norm((\mf{f}^{\vee})^{-1})^{\frac{2}{d}}\left\<\left(-\frac{\mathbf{x}}{4|\D_{K}|^{\frac{2}{d}}z}\right)\boldsymbol{j(\a)},\boldsymbol{j(\a)}\right\>} \\
          &= \frac{1}{(-2|\D_{K}|^{\frac{1}{d}}iz)^{\frac{d}{2}}}\vt_{\mf{f}^{\vee}}\left(-\frac{\mathbf{x}}{4|\D_{K}|^{\frac{2}{d}}z}\right).
        \end{align*}
      \end{proof}

      We will use \cref{thm:functional_equation_Hecke_theta} to analytically continue $\z_{K}(s)$.
    \subsection*{The Integral Representation: Part II}
      Returning to $\z_{K}(s)$, split the integral in \cref{equ:integral_representation_Dedekind_1} into two pieces by writing
      \begin{equation}\label{equ:symmetric_integral_Dedekind_L-functions_split}
        \int_{0}^{\infty}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y} = \int_{0}^{\frac{1}{|\D_{K}|}}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y}+\int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y}.
      \end{equation}
      We will rewrite the first piece in the same form and symmetrize the result as much as possible. Perform the change of variables $y \mapsto \frac{1}{|\D_{K}|^{2}y}$ to the first piece to obtain
      \[
        \int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}\left(\frac{i}{(|\D_{K}|^{2}y)^{\frac{1}{d}}}\right)(|\D_{K}|^{2}y)^{-\frac{s}{2}}\,\frac{dy}{y}.
      \]
      Now we compute
      \begin{align*}
        \w_{\mc{F}}\left(\frac{i}{(|\D_{K}|^{2}y)^{\frac{1}{d}}}\right) &= \w_{\mc{F}}\left(-\frac{1}{|\D_{K}|^{\frac{2}{d}}iy^{\frac{1}{d}}}\right) \\
        &= \frac{1}{w_{K}}\int_{\mc{F}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\vt_{\mf{a}}\left(-\frac{\mathbf{x}}{2|\D_{K}|^{\frac{2}{d}}iy^{\frac{1}{d}}}\right)d\mathbf{x}-\frac{h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x} \\
        &= \frac{1}{w_{K}}\int_{\mc{F}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sqrt{|\D_{K}|y}\vt_{\mf{a}}\left(\frac{iy^{\frac{1}{d}}\mathbf{x}}{2}\right)d\mathbf{x}-\frac{h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x} && \text{\cref{thm:functional_equation_Hecke_theta}} \\
        &= \frac{\sqrt{|\D_{K}|y}}{w_{K}}\int_{\mc{F}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\vt_{\mf{a}}\left(\frac{iy^{\frac{1}{d}}\mathbf{x}}{2}\right)d\mathbf{x}-\frac{h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x} \\
        &= \sqrt{|\D_{K}|y}\w_{\mc{F}}(iy^{\frac{1}{d}})+\frac{\sqrt{|\D|_{K}y}h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x}-\frac{h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x}.
      \end{align*}
      This chain implies that our first piece can be expressed as
      \[
        \int_{\frac{1}{|\D_{K}|}}^{\infty}\left(\sqrt{|\D_{K}|y}\w_{\mc{F}}(iy^{\frac{1}{d}})+\frac{\sqrt{|\D|_{K}y}h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x}-\frac{h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x}\right)(|\D_{K}|^{2}y)^{-\frac{s}{2}}\,\frac{dy}{y},
      \]
      which is further equivalent to
      \[
        |\D_{K}|^{\frac{1}{2}-s}\int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}(iy^{\frac{1}{d}})y^{\frac{1-s}{2}}\,\frac{dy}{y}-\frac{2h_{K}}{\w_{K}\sqrt{|\D|_{K}}s(1-s)}\int_{\mc{F}}\,d\mathbf{x},
      \]
      since, upon interchanging the integrals in the last two pieces by Fubini's theorem, the inner integrals are $\frac{2}{\sqrt{|\D|_{K}}(1-s)}-\frac{2}{\sqrt{|\D|_{K}}s} = -\frac{2}{\sqrt{|\D|_{K}}s(1-s)}$. Substituting this expression back into \cref{equ:symmetric_integral_Dedekind_L-functions_split} and combining with \cref{equ:integral_representation_Dedekind_1} gives the integral representation
      \begin{align*}
        \z_{K}(s) &= \frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\Bigg[-\frac{2h_{K}}{\w_{K}\sqrt{|\D|_{K}}s(1-s)}\int_{\mc{F}}\,d\mathbf{x}+|\D_{K}|^{\frac{1}{2}-s}\int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}(iy^{\frac{1}{d}})y^{\frac{1-s}{2}}\,\frac{dy}{y} \\
        &+ \int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y}\Bigg].
      \end{align*}
      It remains to compute the first integral on the right-hand side. The following lemma gives the result:

      \begin{lemma}\label{lem:integral_of_fundamental_domain_for_norm-one_hypersurface}
        Let $K$ be a number field of signature $(r_{1},r_{2})$ and set $\mc{F} = e^{\mathbf{N}^{\vee}\mc{M}}$ where $\mc{M}$ is a fundamental domain for $\L$ in the trace-zero hyperplane $H$. Then
        \[
          \int_{\mc{F}}\,d\mathbf{x} = 2^{r_{1}-1}R_{K}.
        \]
      \end{lemma}
      \begin{proof}
        Let $d$ be the degree of $K$. Begin by observing that
        \[
          \int_{\mc{F}}\,d\mathbf{x} \int_{1}^{\e}\int_{\mc{F}}\,\frac{d\mathbf{x}\,dy}{y} = \int_{[1,e] \x \mc{F}}\,\frac{d\mathbf{y}}{\mathbf{y}},
        \]
        in view of the decomposition $\R_{+}^{r_{K}+1} = (0,\infty) \x S$ with $\mathbf{y} = y^{\frac{1}{d}}\mathbf{x}$ and $\frac{d\mathbf{y}}{\mathbf{y}} = \frac{d\mathbf{x}\,dy}{y}$. Under the change of variables $\mathbf{y} \to e^{2\mathbf{y}}$, we obtain
        \[
          2^{r_{K}+1}\int_{\left[0,\frac{1}{2}\right] \x \frac{\mc{M}}{\mathbf{N}}}\,d\mathbf{y},
        \]
        because the absolute value of the determinant of the Jacobian matrix is $2^{r_{K}+1}e^{\<\mathbf{y},\mathbf{1}\>}$. The remaining integral is just a $2^{-(r_{2+1})}$ multiple of the volume of $\mc{M}$. Letting $\e_{1},\ldots,\e_{r_{K}}$ be a system of fundamental units for $K$, Dirichlet's unit theorem implies that $\l(\e_{1}),\ldots,\l(\e_{r_{K}})$ is a basis for $\L$. Then by \cref{prop:covolume_equals_volume_of_fundamental_domain}, the volume of $\mc{M}$ is just the absolute value of the determinant of the generator matrix $P$ for $\l(\e_{1}),\ldots,\l(\e_{r_{K}})$. But this is $R_{K}$ by definition of the regulator. It follows that our last expression evaluates to $2^{r_{1}-1}R_{K}$ as claimed.
      \end{proof}

      From \cref{lem:integral_of_fundamental_domain_for_norm-one_hypersurface}, we obtain the integral representation
      \begin{equation}\label{equ:integral_representation_Dedekind_final}
        \begin{aligned}
          \z_{K}(s) &= \frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\Bigg[-\frac{2^{r_{1}}h_{K}R_{K}}{\w_{K}\sqrt{|\D|_{K}}s(1-s)}+|\D_{K}|^{\frac{1}{2}-s}\int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}(iy^{\frac{1}{d}})y^{\frac{1-s}{2}}\,\frac{dy}{y} \\
          &+ \int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y}\Bigg].
        \end{aligned}
      \end{equation}
      This integral representation will give analytic continuation. Indeed, everything outside the brackets is entire. The integrands exhibit exponential decay and therefore are locally absolutely uniformly convergent on $\C$. The fractional term is holomorphic except for simple poles at $s = 0$ and $s = 1$. The meromorphic continuation to $\C$ follows with possible simple poles at $s = 0$ and $s = 1$. Actually, there is no pole at $s = 0$. To see this, observe that $\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}$ has at least a simple pole at $s = 0$ (since $r_{1}$ or $r_{2}$ is positive) and so its reciprocal has at least a simple zero. This cancels the corresponding simple pole of $-\frac{2^{r_{1}}h_{K}R_{K}}{\w_{K}s(1-s)}$ so that $\z_{K}(s)$ has a removable singularity and thus is holomorphic at $s = 0$. At $s = 1$, $\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}$ is nonzero and so $\z_{K}(s)$ has a simple pole. Therefore $\z_{K}(s)$ has meromorphic continuation to all of $\C$ with a simple pole at $s = 1$. 
    \subsection*{The Functional Equation}
      An immediate consequence of applying the symmetry $s \mapsto 1-s$ to \cref{equ:integral_representation_Dedekind_final} is the following functional equation:
      \[
        |\D_{K}|^{\frac{s}{2}}\frac{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}\z_{K}(s) = |\D_{K}|^{\frac{1-s}{2}}\frac{\G\left(\frac{(1-s)}{2}\right)^{r_{1}}\G\left(1-s\right)^{r_{2}}}{\pi^{\frac{r_{1}(1-s)}{2}}(2\pi)^{r_{2}(1-s)}}\z_{K}(1-s).
      \]
      Using the Legendre duplication formula, we see that
      \begin{align*}
        \frac{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}} &= \frac{1}{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}2^{r_{2}(1-s)}\pi^{\frac{r_{2}}{2}}}\G\left(\frac{s}{2}\right)^{r_{1}+r_{2}}\G\left(\frac{s+1}{2}\right)^{r_{2}} \\
        &= \frac{1}{2^{r_{2}}\pi^{\frac{ds}{2}+\frac{r_{2}}{2}}}\G\left(\frac{s}{2}\right)^{r_{1}+r_{2}}\G\left(\frac{s+1}{2}\right)^{r_{2}} \\
        &= \frac{1}{2^{r_{2}}\pi^{\frac{r_{2}}{2}}}\pi^{-\frac{ds}{2}}\G\left(\frac{s}{2}\right)^{r_{1}+r_{2}}\G\left(\frac{s+1}{2}\right)^{r_{2}}.
      \end{align*}
      The constant factor in front is independent of $s$ and so can be canceled in the functional equation. Therefore we identify the gamma factor to be
      \[
        \g(s,\z_{K}) = \pi^{-\frac{ds}{2}}\G\left(\frac{s}{2}\right)^{r_{1}+r_{2}}\Gamma\left(\frac{s+1}{2}\right)^{r_{2}},
      \]
      with $\k_{i} = 0$ for $1 \le i \le r_{1}+r_{2}$ and $\k_{i} = 1$ for $r_{1}+r_{2}+1 \le i \le d$ the local roots at infinity. Clearly these satisfy the required bounds. The conductor is $q(\z_{K}) = |\D_{K}|$ and $p$ is ramified if and only if it is ramified in $K$ by \cref{thm:ramification_division_equivalence}. Note that if $p$ is unramified then $\sum_{1 \le i \le r_{p}}(e_{p}(\mf{p}_{i})-1)f_{p}(\mf{p}_{i}) = 0$ so that all local roots are of the form $\w_{p,i}^{k} \neq 0$. The completed Dedekind zeta function is
      \[
        \L(s,\z_{K}) = |\D_{K}|^{\frac{s}{2}}\pi^{-\frac{ds}{2}}\G\left(\frac{s}{2}\right)^{r_{1}+r_{2}}\Gamma\left(\frac{s+1}{2}\right)^{r_{2}}\z_{K}(s),
      \]
      with functional equation
      \[
        \L(s,\z_{K}) = \L(1-s,\z_{K}).
      \]
      This is the function equation of $\z_{K}(s)$ and from it we see that the root number is $\e(\z_{K}) = 1$ and that $\z_{K}(s)$ is self-dual. To see that the order is $1$, multiply by $(s-1)$ to clear the polar divisor. As the integrals in \cref{equ:integral_representation_Dedekind_final} are locally absolutely uniformly convergent, computing the order amounts to estimating the gamma factor. And because the reciprocal of the gamma function is of order $1$, we have
      \[
        \frac{1}{\g(s,\z_{K})} \ll_{\e} e^{|s|^{1+\e}}.
      \]
      Therefore the reciprocal of the gamma factor is also of order $1$ and it follows that
      \[
        (s-1)\z_{K}(s) \ll_{\e} e^{|s|^{1+\e}}.
      \]
      This shows $(s-1)\z_{K}(s)$ is of order $1$ and hence $\z_{K}(s)$ is too after removing the polar divisor. It now remains to compute the residue of $\z_{K}(s)$ at $s = 1$. This result is known as the \textbf{analytic class number formula}\index{analytic class number formula}:

      \begin{theorem}[Analytic class number formula]
        Let $K$ be a number field of signature $(r_{1},r_{2})$. Then
        \[
          \Res_{s = 1}\z_{K}(s) = \frac{2^{r_{1}}(2\pi)^{r_{2}}h_{K}R_{K}}{w_{K}\sqrt{|\D_{K}|}}.
        \]
      \end{theorem}
      \begin{proof}
        The only term in \cref{equ:integral_representation_Dedekind_final} contributing to the pole is $-\frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\frac{2^{r_{1}}h_{K}R_{K}}{\w_{K}\sqrt{|\D|_{K}}s(1-s)}$. Observe that
        \[
          \lim_{s \to 1}\frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}} = (2\pi)^{r_{2}},
        \]
        because $\G\left(\frac{1}{2}\right) = \sqrt{\pi}$ and $\G(1) = 1$. Therefore
        \begin{align*}
          \Res_{s = 1}\z(s) &= \Res_{s = 1}\left(-\frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\frac{2^{r_{1}}h_{K}R_{K}}{\w_{K}\sqrt{|\D|_{K}}s(1-s)}\right) \\
          &= \lim_{s \to 1}\left(\frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\frac{2^{r_{1}}h_{K}R_{K}}{\w_{K}\sqrt{|\D|_{K}}s}\right) \\
          &= \frac{2^{r_{1}}(2\pi)^{r_{2}}h_{K}R_{K}}{w_{K}\sqrt{|\D_{K}|}}.
        \end{align*}
      \end{proof}

      The usefulness of the analytic class number formula is that is allows for the estimation of the class number in terms of approximating the residue of the Dedekind zeta function at $s = 1$. We collect our work in the following theorem:

      \begin{theorem}\label{thm:Dedekind_Selberg}
        Let $K$ be a number field of degree $d$ and signature $(r_{1},r_{2})$. Then $\z_{K}(s)$ is a Selberg class $L$-function. For $\s > 1$, it has a degree $d$ Euler product given by
        \[
          \z_{K}(s) = \prod_{p}\prod_{\substack{1 \le i \le r_{p} \\ 1 \le k \le f_{p}(\mf{p}_{i})}}(1-\w_{p,i}^{k}p^{-s})^{-1},
        \]
        Moreover, it admits meromorphic continuation to $\C$, possesses the functional equation
        \[
          |\D_{K}|^{\frac{s}{2}}\pi^{-\frac{ds}{2}}\G\left(\frac{s}{2}\right)^{r_{1}+r_{2}}\Gamma\left(\frac{s+1}{2}\right)^{r_{2}}\z_{K}(s) = \L(s,\z_{K}) = \L(1-s,\z_{K}),
        \]
        and has a simple pole at $s = 1$ of residue $\frac{2^{r_{1}}(2\pi)^{r_{2}}h_{K}R_{K}}{w_{K}\sqrt{|\D_{K}|}}$.
      \end{theorem}
    \subsection*{Imprimitivity}
      Dedekind zeta functions are generally imprimitive $L$-functions. We illustrate this in the case of quadratic number fields:

      \begin{theorem}\label{thm:factorization_of_Dedekind_of_quadratic_number_field}
        Let $\Q(\sqrt{d})$ be a quadratic number field and let $\chi_{\D_{d}}$ be the quadratic character given by the Kronecker symbol. Then
        \[
          \z_{\Q(\sqrt{d})}(s) = \z(s)L(s,\chi_{\D_{d}}).
        \]
      \end{theorem}
      \begin{proof}
        By the identity theorem it suffices to prove this for $\s > 1$. By \cref{prop:factorization_of_primes_quadratic}, the Euler product of $\z_{\Q(\sqrt{d})}(s)$ is given by
        \begin{align*}
          \z_{\Q(\sqrt{d})}(s) &= \prod_{\substack{p \\ \chi_{\D_{d}}(p) = 1}}(1-p^{-s})^{-1}(1-p^{-s})^{-1}\prod_{\substack{p \\ \chi_{\D_{d}}(p) = -1}}(1-p^{-s})^{-1}(1+p^{-s})^{-1}\prod_{\substack{p \\ \chi_{\D_{d}}(p) = 0}}(1-p^{-s})^{-1} \\
          &= \z(s)\prod_{\substack{p \\ \chi_{\D_{d}}(p) = 1}}(1-p^{-s})^{-1}\prod_{\substack{p \\ \chi_{\D_{d}}(p) = -1}}(1+p^{-s})^{-1}\prod_{\substack{p \\ \chi_{\D_{d}}(p) = 0}}1 \\
          &= \z(s)L(s,\chi_{\D_{d}}).
        \end{align*}
        This completes the proof.
      \end{proof}

      Since the residue of $\z(s)$ at $s = 1$ is $1$, the analytic class number formula gives a relationship between the value of Dirichlet $L$-functions at $s = 1$ and the class number of quadratic number fields. This is known as the \textbf{Dirichlet class number formula}\index{Dirichlet class number formula}:

      \begin{corollary}[Dirichlet class number formula]
        Let $\Q(\sqrt{d})$ be a quadratic number field and let $\chi_{\D_{d}}$ be the quadratic character given by the Kronecker symbol. Then
        \[
          L(1,\chi_{\D_{d}}) = \frac{2h_{d}\log|\e_{d}|}{\sqrt{|\D_{d}|}} \quad \text{or} \quad L(1,\chi_{\D_{d}}) = \frac{2\pi h_{d}}{w_{d}\sqrt{|\D_{d}|}},
        \]
        where $\e_{d}$ is a fundamental unit, according to if $d > 0$ or $d < 0$.
      \end{corollary}
      \begin{proof}
        Let $(r_{1},r_{2})$ be the signature of $\Q(\sqrt{d})$. Combining \cref{thm:factorization_of_Dedekind_of_quadratic_number_field} with the analytic class number formula and \cref{prop:zeta_residue} gives
        \[
          L(1,\chi_{\D_{d}}) = \frac{2^{r_{1}}(2\pi)^{r_{2}}h_{d}R_{d}}{w_{d}\sqrt{|\D_{d}|}}.
        \]
        The result follows by \cref{prop:unit_group_quadratic}, \cref{prop:regulator_quadratic}, and that $(r_{1},r_{2})$ is $(2,0)$ or $(0,1)$ according to if $d > 0$ or $d < 0$.
      \end{proof}
      
      Since $h_{d} \ge 1$ and $w_{d} \le 6$ (by \cref{prop:unit_group_quadratic}), the Dirichlet class number formula gives the estimate
      \[
        L(1,\chi_{\D_{d}}) \gg \frac{1}{\sqrt{\D_{d}}}.
      \]
      By \cref{thm:fundamental_discriminant_character_primitive}, this is really an estimate about the Dirichlet $L$-functions of all primitive quadratic characters. We will see later on that Siegel's theorem gives a much better lower bound provided we make the implicit constant ineffective.
  \section{Hecke \texorpdfstring{$L$}{L}-functions}
    \subsection*{The Definition \& Euler Product}
      We will investigate the $L$-functions of holomorphic cusp forms. Let $f \in \mc{S}_{k}(N,\chi)$ and denote its Fourier series by
      \[
        f(z) = \sum_{n \ge 1}a_{f}(n)n^{\frac{k-1}{2}}e^{2\pi inz},
      \]
      with $a_{f}(1) = 1$. Thus if $f$ is a Hecke eigenform, the $a_{f}(n)$ are the Hecke eigenvalues of $f$ normalized so that they are constant on average. The \textbf{Hecke $L$-series}\index{Hecke $L$-series} (respectively \textbf{Hecke $L$-function}\index{Hecke $L$-function} if it is an $L$-function) $L(s,f)$ of $f$ is defined by the following Dirichlet series:
      \[
        L(s,f) = \sum_{n \ge 1}\frac{a_{f}(n)}{n^{s}}.
      \]
      We will see that $L(s,f)$ is a Selberg class $L$-function if $f$ is a primitive Hecke eigenform. From now on, we make this assumption about $f$. The Hecke relations and the Ramanujan-Petersson conjecture for holomorphic forms together imply that the coefficients $a_{f}(n)$ are multiplicative and satisfy $a_{f}(n) \ll_{\e} n^{\e}$. By \cref{prop:Dirichlet_series_Euler_product}, $L(s,f)$ is locally absolutely uniformly convergent for $\s > 1$ and admits the following infinite product expression:
      \[
        L(s,f) = \prod_{p}\left(\sum_{n \ge 0}\frac{a_{f}(p^{n})}{p^{ns}}\right).
      \]
      To determine the Euler product, the Hecke relations imply that the coefficients $a_{f}(n)$ satisfy
      \begin{equation}\label{equ:primitive_Hecke_eigenform_recurrence_for_coefficients_of_holomorphic_L-function}
        a_{f}(p^{n}) = \begin{cases} a_{f}(p^{n-1})a_{f}(p)-\chi(p)a_{f}(p^{n-2}) & \text{if $p \nmid N$}, \\ (a_{f}(p))^{n} & \text{if $p \mid N$}, \end{cases}
      \end{equation}
      for all primes $p$ and $n \ge 2$. We now simplify the factor inside the product using this \cref{equ:primitive_Hecke_eigenform_recurrence_for_coefficients_of_holomorphic_L-function}. On the one hand, if $p \nmid N$:
      \begin{align*}
        \sum_{n \ge 0}\frac{a_{f}(p^{n})}{p^{ns}} &= 1+\frac{a_{f}(p)}{p^{s}}+\sum_{n \ge 2}\frac{a_{f}(p^{n})}{p^{ns}} \\
        &= 1+\frac{a_{f}(p)}{p^{s}}+\sum_{n \ge 2}\frac{a_{f}(p^{n-1})a_{f}(p)-\chi(p)a_{f}(p^{n-2})}{p^{ns}} \\
        &= 1+\frac{a_{f}(p)}{p^{s}}+\frac{a_{f}(p)}{p^{s}}\sum_{n \ge 1}\frac{a_{f}(p^{n})}{p^{ns}}-\frac{\chi(p)}{p^{2s}}\sum_{n \ge 0}\frac{a_{f}(p^{n})}{p^{ns}} \\
        &= 1+\left(\frac{a_{f}(p)}{p^{s}}-\frac{\chi(p)}{p^{2s}}\right)\sum_{n \ge 0}\frac{a_{f}(p^{n})}{p^{ns}}.
      \end{align*}
      By isolating the sum we find
      \[
        \sum_{n \ge 0}\frac{a_{f}(p^{n})}{p^{ns}} = \left(1-\frac{a_{f}(p)}{p^{s}}+\frac{\chi(p)}{p^{2s}}\right)^{-1}.
      \]
      On the other hand, if $p \mid N$ we have
      \[
        \sum_{n \ge 0}\frac{a_{f}(p^{n})}{p^{ns}} = \sum_{n \ge 0}\frac{(a_{f}(p))^{n}}{p^{ns}} = \left(1-a_{f}(p)p^{-s}\right)^{-1}.
      \]
      Therefore
      \[
        L(s,f) = \prod_{p \nmid N}(1-a_{f}(p)p^{-s}+\chi(p)p^{-2s})^{-1}\prod_{p \mid N}(1-a_{f}(p)p^{-s})^{-1}.
      \]
      If $p \nmid N$, let $\a_{1}(p)$ and $\a_{2}(p)$ be the roots of $1-a_{f}(p)p^{-s}+\chi(p)p^{-2s}$. That is,
      \[
        (1-\a_{1}(p)p^{-s})(1-\a_{2}(p)p^{-s}) = (1-a_{f}(p)p^{-s}+\chi(p)p^{-2s}).
      \]
      If $p \mid N$, let $\a_{1}(p) = a_{f}(p)$ and $\a_{2}(p) = 0$. We can then express $L(s,f)$ as the following degree $2$ Euler product:
      \[
        L(s,f) = \prod_{p}(1-\a_{1}(p)p^{-s})^{-1}(1-\a_{2}(p)p^{-s})^{-1}.
      \]
      The local factor at $p$ is 
      \[
        L_{p}(s,f) = (1-\a_{1}(p)p^{-s})^{-1}(1-\a_{2}(p)p^{-s})^{-1},
      \]
      with local roots $\a_{1}(p)$ and $\a_{2}(p)$. Upon applying partial fraction decomposition to the local factor, we find
      \[
        \frac{1}{1-\a_{1}(p)p^{-s}}\frac{1}{1-\a_{2}(p)p^{-s}} = \frac{\frac{\a_{1}(p)}{\a_{1}(p)-\a_{2}(p)}}{1-\a_{1}(p)p^{-s}}+\frac{\frac{-\a_{2}(p)}{\a_{1}(p)-\a_{2}(p)}}{1-\a_{2}(p)p^{-s}}.
      \]
      Expanding both sides as series in $p^{-s}$, and comparing coefficients gives
      \begin{equation}\label{equ:Hecke_L_function_coefficient_formula}
        a_{f}(p^{n}) = \frac{\a_{1}(p)^{n+1}-\a_{2}(p)^{n+1}}{\a_{1}(p)-\a_{2}(p)}.
      \end{equation}
    \subsection*{The Integral Representation}
      We now want to find an integral representation for $L(s,f)$. Consider the following Mellin transform:
      \[
        \int_{0}^{\infty}f(iy)y^{s+\frac{k-1}{2}}\,\frac{dy}{y}.
      \]
      As $f$ has exponential decay at the cusps, this integral is locally absolutely uniformly convergent for $\s > 1$ and hence defines an analytic function there. Then we compute
      \begin{align*}
        \int_{0}^{\infty}f(iy)y^{s+\frac{k-1}{2}}\,\frac{dy}{y} &= \int_{0}^{\infty}\sum_{n \ge 1}a_{f}(n)n^{\frac{k-1}{2}}e^{-2\pi ny}y^{s+\frac{k-1}{2}}\,\frac{dy}{y} \\
        &= \sum_{n \ge 1}a_{f}(n)n^{\frac{k-1}{2}}\int_{0}^{\infty}e^{-2\pi ny}y^{s+\frac{k-1}{2}}\,\frac{dy}{y} &&\text{FT} \\
        &= \sum_{n \ge 1}\frac{a_{f}(n)}{(2\pi)^{s+\frac{k-1}{2}}n^{s}}\int_{0}^{\infty}e^{-y}y^{s+\frac{k-1}{2}}\,\frac{dy}{y} &&\text{$y \mapsto \frac{y}{2\pi n}$} \\
        &= \frac{\G\left(s+\frac{k-1}{2}\right)}{(2\pi)^{s+\frac{k-1}{2}}}\sum_{n \ge 1}\frac{a_{f}(n)}{n^{s}} \\
        &= \frac{\G\left(s+\frac{k-1}{2}\right)}{(2\pi)^{s+\frac{k-1}{2}}}L(s,f).
      \end{align*}
      Rewriting, we have an integral representation
      \begin{equation}\label{equ:integral_representation_holomorphic_1}
        L(s,f) = \frac{(2\pi)^{s+\frac{k-1}{2}}}{\G\left(s+\frac{k-1}{2}\right)}\int_{0}^{\infty}f(iy)y^{s+\frac{k-1}{2}}\,\frac{dy}{y}.
      \end{equation}
      Now split the integral on the right-hand side into two pieces by writing
      \begin{equation}\label{equ:symmetric_integral_holomorphic_split}
        \int_{0}^{\infty}f(iy)y^{s+\frac{k-1}{2}}\,\frac{dy}{y} = \int_{0}^{\frac{1}{\sqrt{N}}}f(iy)y^{s+\frac{k-1}{2}}\,\frac{dy}{y}+\int_{\frac{1}{\sqrt{N}}}^{\infty}f(iy)y^{s+\frac{k-1}{2}}\,\frac{dy}{y}.
      \end{equation}
      Now we will rewrite the first piece in the same form and symmetrize the result as much as possible. Begin by performing the change of variables $y \mapsto \frac{1}{Ny}$ to the first piece to obtain
      \[
        \int_{\frac{1}{\sqrt{N}}}^{\infty}f\left(\frac{i}{Ny}\right)(Ny)^{-s-\frac{k-1}{2}}\,\frac{dy}{y}.
      \]
      Rewriting in terms of the Atkin-Lehner operator and recalling that $\w_{N}f = \w_{N}(f)\conj{f}$ by \cref{prop:Atkin_Lehner_conjugation_holomorphic}, we have
      \begin{align*}
        \int_{\frac{1}{\sqrt{N}}}^{\infty}f\left(\frac{i}{Ny}\right)(Ny)^{-s-\frac{k-1}{2}}\,\frac{dy}{y} &= \int_{\frac{1}{\sqrt{N}}}^{\infty}f\left(-\frac{1}{iNy}\right)(Ny)^{-s-\frac{k-1}{2}}\,\frac{dy}{y} \\
        &= \int_{\frac{1}{\sqrt{N}}}^{\infty}\left(\sqrt{N}iy\right)^{k}(\w_{N}f)(iy)(Ny)^{-s-\frac{k-1}{2}}\,\frac{dy}{y} \\
        &= \int_{\frac{1}{\sqrt{N}}}^{\infty}\left(\sqrt{N}iy\right)^{k}\w_{N}(f)\conj{f}(iy)(Ny)^{-s-\frac{k-1}{2}}\,\frac{dy}{y} \\
        &= \w_{N}(f)i^{k}N^{\frac{1}{2}-s}\int_{\frac{1}{\sqrt{N}}}^{\infty}\conj{f}(iy)y^{(1-s)-\frac{k-1}{2}}\,\frac{dy}{y}.
      \end{align*}
      Substituting this result back into \cref{equ:symmetric_integral_holomorphic_split} and combining with \cref{equ:integral_representation_holomorphic_1} yields the integral representation
      \begin{equation}\label{equ:integral_representation_holomorphic_final}
        L(s,f) = \frac{(2\pi)^{s+\frac{k-1}{2}}}{\G\left(s+\frac{k-1}{2}\right)}\left[\w_{N}(f)i^{k}N^{\frac{1}{2}-s}\int_{\frac{1}{\sqrt{N}}}^{\infty}\conj{f}(iy)y^{(1-s)+\frac{k-1}{2}}\,\frac{dy}{y}+\int_{\frac{1}{\sqrt{N}}}^{\infty}f(iy)y^{s+\frac{k-1}{2}}\,\frac{dy}{y}\right].
      \end{equation}
      This integral representation will give analytic continuation. To see this, we know everything outside the brackets is entire. The integrands exhibit exponential decay and therefore the integrals are locally absolutely uniformly convergent on $\C$. Hence we have analytic continuation to all of $\C$. In particular, we have shown that $L(s,f)$ has no poles.
    \subsection*{The Functional Equation}
      An immediate consequence of applying the symmetry $s \mapsto 1-s$ to \cref{equ:integral_representation_holomorphic_final} is the following functional equation:
      \[
        N^{\frac{s}{2}}\frac{\G\left(s+\frac{k-1}{2}\right)}{(2\pi)^{s+\frac{k-1}{2}}}L(s,f) = \w_{N}(f)i^{k}N^{\frac{1-s}{2}}\frac{\G\left((1-s)+\frac{k-1}{2}\right)}{(2\pi)^{(1-s)+\frac{k-1}{2}}}L(1-s,\conj{f}).
      \]
      Using the Legendre duplication formula, we find that
      \begin{align*}
        \frac{\G\left(s+\frac{k-1}{2}\right)}{(2\pi)^{s+\frac{k-1}{2}}} &= \frac{1}{(2\pi)^{s+\frac{k-1}{2}}2^{1-\left(s+\frac{k-1}{2}\right)}\sqrt{\pi}}\G\left(\frac{s+\frac{k-1}{2}}{2}\right)\G\left(\frac{s+\frac{k+1}{2}}{2}\right) \\
        &= \frac{1}{2\pi^{s+\frac{1}{2}}}\G\left(\frac{s+\frac{k-1}{2}}{2}\right)\G\left(\frac{s+\frac{k+1}{2}}{2}\right) \\ 
        &= \frac{1}{\sqrt{4\pi}}\pi^{-s}\G\left(\frac{s+\frac{k-1}{2}}{2}\right)\G\left(\frac{s+\frac{k+1}{2}}{2}\right).
      \end{align*}
      The constant factor in front is independent of $s$ and so can be canceled in the functional equation. Therefore we identify the gamma factor as
      \[
        \g(s,f) = \pi^{-s}\G\left(\frac{s+\frac{k-1}{2}}{2}\right)\G\left(\frac{s+\frac{k+1}{2}}{2}\right),
      \]
      with $\k_{1} = k-1$ and $\k_{2} = k+1$ the local roots at infinity. The conductor is $q(f) = N$, so the primes dividing the level ramify, and by the Ramanujan-Petersson conjecture for holomorphic forms, $\a_{1}(p) \neq 0$ and $\a_{2}(p) \neq 0$ for all primes $p \nmid N$. The completed $L$-function is
      \[
        \L(s,f) = N^{\frac{s}{2}}\pi^{-s}\G\left(\frac{s+\frac{k-1}{2}}{2}\right)\G\left(\frac{s+\frac{k+1}{2}}{2}\right)L(s,f),
      \]
      with functional equation
      \[
        \L(s,f) = \w_{N}(f)i^{k}\L(1-s,\conj{f}).
      \]
      This is the functional equation of $L(s,f)$. From it, the root number is $\e(f) = \w_{N}(f)i^{k}$ and we see that $L(s,f)$ has dual $L(s,\conj{f})$. We will now show that $L(s,f)$ is of order $1$. Since $L(s,f)$ has no poles, we do not need to clear any polar divisors. As the integrals in \cref{equ:integral_representation_holomorphic_final} are locally absolutely uniformly convergent, computing the order amounts to estimating the gamma factor. Since the reciprocal of the gamma function is of order $1$, we have
      \[
        \frac{1}{\g(s,f)} \ll_{\e} e^{|s|^{1+\e}}.
      \]
      So the reciprocal of the gamma factor is also of order $1$. Then
      \[
        L(s,f) \ll_{\e} e^{|s|^{1+\e}}.
      \]
      So $L(s,f)$ is of order $1$. We summarize all of our work into the following theorem:

      \begin{theorem}\label{thm:primitive_Hecke_Selberg}
        For any primitive Hecke eigenform $f \in \mc{S}_{k}(N,\chi)$, $L(s,f)$ is a Selberg class $L$-function. For $\s > 1$, it has a degree $2$ Euler product given by 
        \[
          L(s,f) = \prod_{p \nmid N}(1-a_{f}(p)p^{-s}+\chi(p)p^{-2s})^{-1}\prod_{p \mid N}(1-a_{f}(p)p^{-s})^{-1}.
        \]
        Moreover, it admits analytic continuation to $\C$ and possesses the functional equation
        \[
          N^{\frac{s}{2}}\pi^{-s}\G\left(\frac{s+\frac{k-1}{2}}{2}\right)\G\left(\frac{s+\frac{k+1}{2}}{2}\right)L(s,f) = \L(s,f) = \w_{N}(f)i^{k}\L(1-s,\conj{f}).
        \]
      \end{theorem}
    \subsection*{Beyond Primitivity}
      We can still obtain analytic continuation of the $L$-series $L(s,f)$ if $f$ is not a primitive Hecke eigenform. Indeed, since the primitive Hecke eigenforms form a basis for the space of newforms, we can prove the following:

      \begin{theorem}\label{thm:analytic_continuation_Hecke}
        For any $f \in \mc{S}_{k}(\G_{1}(N))$, $L(s,f)$ is locally absolutely uniformly convergent for $\s > 1$ and admits analytic continuation to $\C$.
      \end{theorem}
      \begin{proof}
        If $f$ is a newform, this follows from \cref{thm:newforms_characterization_holomorphic,thm:primitive_Hecke_Selberg}. We will prove the case for oldforms by induction. The base case is clear since if $N = 1$ there are no oldforms. So assume by induction that the claim holds for all proper divisors of $N$. As $f$ is an oldform, there is a proper divisor $d \mid N$ with $d > 1$ such that
        \[
          f(z) = g(z)+d^{k-1}h(dz) = g(z)+\prod_{p^{r} \mid\mid d}(V_{p}^{r}h)(z),
        \]
        for some $g,h \in \mc{S}_{k}\left(\G_{1}\left(\frac{N}{d}\right)\right)$. Note that $V_{p}h \in \mc{S}_{k}\left(\G_{1}\left(\frac{Np}{d}\right)\right)$ by \cref{lem:twisted_holomorphic_lemma}. Our induction hypothesis then implies that $L(s,g)$ and $L(s,V_{p}^{r}h)$, for all $p^{r} \mid\mid d$, admit analytic continuation to $\C$. Thus so does $L(s,f)$ which completes the proof.
      \end{proof}
  \section{Hecke-Maass \texorpdfstring{$L$}{L}-functions}
    \subsection*{The Definition \& Euler Product}
      We will investigate the $L$-functions of weight zero Maass cusp forms. Let $f \in \mc{C}_{\nu}(N,\chi)$ and denote its Fourier-Whittaker series by
      \[
        f(z) = \sum_{n \ge 1}a_{f}(n)\left(\sqrt{y}K_{\nu}(2\pi ny)e^{2\pi inx}+\frac{a_{f}(-n)}{a_{f}(n)}\sqrt{y}K_{\nu}(2\pi ny)e^{-2\pi inx}\right),
      \]
      with $a_{f}(1) = 1$. Thus if $f$ is a Hecke eigenform, then as $f$ is even or odd by \cref{prop:Hecke_Maass_eigenform_even_or_odd}, the Fourier-Whittaker series takes the form
      \[
        f(z) = \sum_{n \ge 1}a_{f}(n)\sqrt{y}K_{\nu}(2\pi ny)\SC(2\pi nx),
      \]
      and the $a_{f}(n)$ are the Hecke eigenvalues of $f$ normalized so that they are constant on average. The \textbf{Hecke-Maass $L$-series}\index{Hecke-Maass $L$-series} (respectively \textbf{Hecke-Maass $L$-function}\index{Hecke-Maass $L$-function} if it is an $L$-function) $L(s,f)$ of $f$ is defined by the following Dirichlet series:
      \[
        L(s,f) = \sum_{n \ge 1}\frac{a_{f}(n)}{n^{s}}.
      \]
      We will see that $L(s,f)$ is a Selberg class $L$-function if $f$ is a primitive Hecke-Maass eigenform. From now on, we make this assumption about $f$. The Ramanujan-Petersson conjecture for Maass forms is not know so $L(s,f)$ has not been proven to be a Selberg class $L$-function. As it is conjectured to be, throughout we will assume that the Ramanujan-Petersson conjecture for Maass forms holds. The Hecke relations and the Ramanujan-Petersson conjecture for Maass forms together imply that the coefficients $a_{f}(n)$ are multiplicative and satisfy $a_{f}(n) \ll_{\e} n^{\e}$. By \cref{prop:Dirichlet_series_Euler_product}, $L(s,f)$ is locally absolutely uniformly convergent for $\s > 1$ and admits the following infinite product expression:
      \[
        L(s,f) = \prod_{p}\left(\sum_{n \ge 0}\frac{a_{f}(p^{n})}{p^{ns}}\right).
      \]
      To determine the Euler product, the Hecke relations imply that the coefficients $a_{f}(n)$ satisfy
      \begin{equation}\label{equ:primitive_Hecke_eigenform_recurrence_for_coefficients_of_Maass_L-function}
        a_{f}(p^{n}) = \begin{cases} a_{f}(p^{n-1})a_{f}(p)-\chi(p)a_{f}(p^{n-2}) & \text{if $p \nmid N$}, \\ (a_{f}(p))^{n} & \text{if $p \mid N$}, \end{cases}
      \end{equation}
      for all primes $p$ and $n \ge 2$. We now simplify the factor inside the product using this \cref{equ:primitive_Hecke_eigenform_recurrence_for_coefficients_of_Maass_L-function}. On the one hand, if $p \nmid N$:
      \begin{align*}
        \sum_{n \ge 0}\frac{a_{f}(p^{n})}{p^{ns}} &= 1+\frac{a_{f}(p)}{p^{s}}+\sum_{n \ge 2}\frac{a_{f}(p^{n})}{p^{ns}} \\
        &= 1+\frac{a_{f}(p)}{p^{s}}+\sum_{n \ge 2}\frac{a_{f}(p^{n-1})a_{f}(p)-\chi(p)a_{f}(p^{n-2})}{p^{ns}} \\
        &= 1+\frac{a_{f}(p)}{p^{s}}+\frac{a_{f}(p)}{p^{s}}\sum_{n \ge 1}\frac{a_{f}(p^{n})}{p^{ns}}-\frac{\chi(p)}{p^{2s}}\sum_{n \ge 0}\frac{a_{f}(p^{n})}{p^{ns}} \\
        &= 1+\left(\frac{a_{f}(p)}{p^{s}}-\frac{\chi(p)}{p^{2s}}\right)\sum_{n \ge 0}\frac{a_{f}(p^{n})}{p^{ns}}.
      \end{align*}
      By isolating the sum we find
      \[
        \sum_{n \ge 0}\frac{a_{f}(p^{n})}{p^{ns}} = \left(1-\frac{a_{f}(p)}{p^{s}}+\frac{\chi(p)}{p^{2s}}\right)^{-1}.
      \]
      On the other hand, if $p \mid N$ we have
      \[
        \sum_{n \ge 0}\frac{a_{f}(p^{n})}{p^{ns}} = \sum_{n \ge 0}\frac{(a_{f}(p))^{n}}{p^{ns}} = \left(1-a_{f}(p)p^{-s}\right)^{-1}.
      \]
      Therefore
      \[
        L(s,f) = \prod_{p \nmid N}(1-a_{f}(p)p^{-s}+\chi(p)p^{-2s})^{-1}\prod_{p \mid N}(1-a_{f}(p)p^{-s})^{-1}.
      \]
      If $p \nmid N$, let $\a_{1}(p)$ and $\a_{2}(p)$ be the roots of $1-a_{f}(p)p^{-s}+\chi(p)p^{-2s}$. That is,
      \[
        (1-\a_{1}(p)p^{-s})(1-\a_{2}(p)p^{-s}) = (1-a_{f}(p)p^{-s}+\chi(p)p^{-2s}).
      \]
      If $p \mid N$, let $\a_{1}(p) = a_{f}(p)$ and $\a_{2}(p) = 0$. We can then express $L(s,f)$ as a degree $2$ Euler product:
      \[
        L(s,f) = \prod_{p}(1-\a_{1}(p)p^{-s})^{-1}(1-\a_{2}(p)p^{-s})^{-1}.
      \]
      The local factor at $p$ is 
      \[
        L_{p}(s,f) = (1-\a_{1}(p)p^{-s})^{-1}(1-\a_{2}(p)p^{-s})^{-1},
      \]
      with local roots $\a_{1}(p)$ and $\a_{2}(p)$. Upon applying partial fraction decomposition to the local factor, we find
      \[
        \frac{1}{1-\a_{1}(p)p^{-s}}\frac{1}{1-\a_{2}(p)p^{-s}} = \frac{\frac{\a_{1}(p)}{\a_{1}(p)-\a_{2}(p)}}{1-\a_{1}(p)p^{-s}}+\frac{\frac{-\a_{2}(p)}{\a_{1}(p)-\a_{2}(p)}}{1-\a_{2}(p)p^{-s}}.
      \]
      Expanding both sides as series in $p^{-s}$, and comparing coefficients gives
      \begin{equation}\label{equ:Hecke_Maass_L_function_coefficient_formula}
        a_{f}(p^{n}) = \frac{\a_{1}(p)^{n+1}-\a_{2}(p)^{n+1}}{\a_{1}(p)-\a_{2}(p)}.
      \end{equation}
    \subsection*{The Integral Representation}
      We want to find an integral representation for $L(s,f)$. Recall that $f$ is an eigenfunction for the parity Hecke operator $T_{-1}$ with eigenvalue $\pm 1$. Equivalently, $f$ is even if the eigenvalue is $1$ and odd if the eigenvalue is $-1$. The integral representation will depend upon this parity. To handle both cases simultaneously, let $\d_{f} = 0,1$ according to whether $f$ is even or odd. In other words,
      \[
        \d_{f} = \frac{1-a_{f}(-1)}{2}.
      \]
      Now consider the following Mellin transform:
      \[
        \int_{0}^{\infty}\left(\frac{\del}{\del x}^{\d_{f}}f\right)(iy)y^{s-\frac{1}{2}+\d_{f}}\,\frac{dy}{y}.
      \]
      As $f$ has exponential decay at the cusps, this integral is locally absolutely uniformly convergent for $\s > 1$ and hence defines an analytic function there. The derivative operator is present because $\SC(x) = i\sin(x)$ if $f$ is odd. In any case, the smoothness of $f$ implies that we may differentiate its Fourier-Whittaker series termwise to obtain
      \[
        \left(\frac{\del}{\del x}^{\d_{f}}f\right)(z) = \sum_{n \ge 1}a_{f}(n)(2\pi in)^{\d_{f}}\sqrt{y}K_{\nu}(2\pi ny)\cos(2\pi nx).
      \]
      Therefore regardless if $f$ is even or odd, the Fourier-Whittaker series of $\left(\frac{\del}{\del x}^{\d_{f}}f\right)(z)$ has $\SC(x) = \cos(x)$ and the integral does not vanish identically. Then we compute
      \begin{align*}
        \int_{0}^{\infty}\left(\frac{\del}{\del x}^{\d_{f}}f\right)(iy)y^{s-\frac{1}{2}+\d_{f}}\,\frac{dy}{y} &= \int_{0}^{\infty}\sum_{n \ge 1}a_{f}(n)(2\pi in)^{\d_{f}}K_{\nu}(2\pi ny)y^{s+\d_{f}}\,\frac{dy}{y} \\
        &= \sum_{n \ge 1}a_{f}(n)(2\pi in)^{\d_{f}}\int_{0}^{\infty}K_{\nu}(2\pi ny)y^{s+\d_{f}}\,\frac{dy}{y} &&\text{FT} \\
        &= \sum_{n \ge 1}\frac{a_{f}(n)}{(2\pi)^{s}n^{s}}i^{\d_{f}}\int_{0}^{\infty}K_{\nu}(y)y^{s+\d_{f}}\,\frac{dy}{y} &&\text{$y \mapsto \frac{y}{2\pi n}$} \\
        &= \frac{\G\left(\frac{s+\d_{f}+\nu}{2}\right)\G\left(\frac{s+\d_{f}-\nu}{2}\right)}{2^{2-\d_{f}}\pi^{s}(-i)^{\d_{f}}}\sum_{n \ge 1}\frac{a_{f}(n)}{n^{s}} && \text{\cref{append:Special_Integrals}} \\
        &= \frac{\G\left(\frac{s+\d_{f}+\nu}{2}\right)\G\left(\frac{s+\d_{f}-\nu}{2}\right)}{2^{2-\d_{f}}\pi^{s}(-i)^{\d_{f}}}L(s,f).
      \end{align*}
      Rewriting, we have an integral representation
      \begin{equation}\label{equ:integral_representation_Maass_1}
        L(s,f) = \frac{2^{2-\d_{f}}\pi^{s}(-i)^{\d_{f}}}{\G\left(\frac{s+\d_{f}+\nu}{2}\right)\G\left(\frac{s+\d_{f}-\nu}{2}\right)}\int_{0}^{\infty}\left(\frac{\del}{\del x}^{\d_{f}}f\right)(iy)y^{s-\frac{1}{2}+\d_{f}}\,\frac{dy}{y}.
      \end{equation}
      Now split the integral on the right-hand side into two pieces by writing
      \begin{equation}\label{equ:symmetric_integral_Maass_split}
        \int_{0}^{\infty}\left(\frac{\del}{\del x}^{\d_{f}}f\right)(iy)y^{s-\frac{1}{2}+\d_{f}}\,\frac{dy}{y} = \int_{0}^{\frac{1}{\sqrt{N}}}\left(\frac{\del}{\del x}^{\d_{f}}f\right)(iy)y^{s-\frac{1}{2}+\d_{f}}\,\frac{dy}{y}+\int_{\frac{1}{\sqrt{N}}}^{\infty}\left(\frac{\del}{\del x}^{\d_{f}}f\right)(iy)y^{s-\frac{1}{2}+\d_{f}}\,\frac{dy}{y}.
      \end{equation}
      Now we will rewrite the first piece in the same form and symmetrize the result as much as possible. Performing the change of variables $y \mapsto \frac{1}{Ny}$ to the first piece to obtain
      \[
        \int_{\frac{1}{\sqrt{N}}}^{\infty}\left(\frac{\del}{\del x}^{\d_{f}}f\right)\left(\frac{i}{Ny}\right)(Ny)^{-s+\frac{1}{2}-\d_{f}}\,\frac{dy}{y}.
      \]
      We will rewrite this in terms of the Atkin-Lehner operator. But first we require an identity that relates $\frac{\del}{\del x}^{\d_{f}}$ with the Atkin-Lehner operator $\w_{N}$. By the identity theorem it suffices verify this for $z \in \H$ with $|z|$ fixed. Observe that $-\frac{1}{Nz} = \frac{-x}{N|z|^{2}}+\frac{iy}{N|z|^{2}}$. Now differentiate termwise to see that
      \begin{align*}
        \left(\frac{\del}{\del x}^{\d_{f}}\w_{N}f\right)(z) &= \left(\frac{\del}{\del x}^{\d_{f}}\right)f\left(-\frac{1}{Nz}\right) \\
         &= \left(\frac{\del}{\del x}^{\d_{f}}\right)\sum_{n \ge 1}a_{f}(n)\sqrt{\frac{y}{N|z|^{2}}}K_{\nu}(2\pi ny)\SC\left(-2\pi n\frac{x}{N|z|^{2}}\right) \\
        &= (-N|z|^{2})^{-\d_{f}}\sum_{n \ge 1}a_{f}(n)(2\pi in)^{\d_{f}}\sqrt{\frac{y}{N|z|^{2}}}K_{\nu}\left(2\pi n\frac{y}{N|z|^{2}}\right)\cos\left(-2\pi n\frac{x}{N|z|^{2}}\right) \\
        &= (-N|z|^{2})^{-\d_{f}}\left(\frac{\del}{\del x}^{\d_{f}}f\right)\left(-\frac{1}{Nz}\right).
      \end{align*}
      By the identity theorem, we have
      \[
        \left(\frac{\del}{\del x}^{\d_{f}}f\right)\left(-\frac{1}{Nz}\right) = (-N|z|^{2})^{\d_{f}}\left(\frac{\del}{\del x}^{\d_{f}}\w_{N}f\right)(z),
      \]
      Using this identity, rewriting in terms of the Atkin-Lehner operator, and recalling that $\w_{N}f = \w_{N}(f)\conj{f}$ by \cref{prop:Atkin_Lehner_conjugation_Maass}, we have
      \begin{align*}
        \int_{\frac{1}{\sqrt{N}}}^{\infty}\left(\frac{\del}{\del x}^{\d_{f}}f\right)\left(\frac{i}{Ny}\right)(Ny)^{-s+\frac{1}{2}-\d_{f}}\,\frac{dy}{y} &= \int_{\frac{1}{\sqrt{N}}}^{\infty}\left(\frac{\del}{\del x}^{\d_{f}}f\right)\left(-\frac{1}{iNy}\right)(Ny)^{-s+\frac{1}{2}-\d_{f}}\,\frac{dy}{y} \\
        &= \int_{\frac{1}{\sqrt{N}}}^{\infty}(-Ny^{2})^{\d_{f}}\left(\left(\frac{\del}{\del x}^{\d_{f}}\right)\w_{N}f\right)(iy)(Ny)^{-s+\frac{1}{2}-\d_{f}}\,\frac{dy}{y} \\
        &= \int_{\frac{1}{\sqrt{N}}}^{\infty}(-Ny^{2})^{\d_{f}}\w_{N}(f)\left(\left(\frac{\del}{\del x}^{\d_{f}}\right)\conj{f}\right)(iy)(Ny)^{-s+\frac{1}{2}-\d_{f}}\,\frac{dy}{y} \\
        &= w_{N}(f)(-1)^{\d_{f}}N^{\frac{1}{2}-s}\int_{\frac{1}{\sqrt{N}}}^{\infty}\left(\left(\frac{\del}{\del x}^{\d_{f}}\right)\conj{f}\right)(iy)y^{(1-s)-\frac{1}{2}+\d_{f}}\,\frac{dy}{y}.
      \end{align*}
      Substituting this result back into \cref{equ:symmetric_integral_Maass_split} and combining with \cref{equ:integral_representation_Maass_1} gives the integral representation
      \begin{equation}\label{equ:integral_representation_Maass_final}
        \begin{aligned}
          L(s,f) &= \frac{2^{2-\d_{f}}\pi^{s}(-i)^{\d_{f}}}{\G\left(\frac{s+\d_{f}+\nu}{2}\right)\G\left(\frac{s+\d_{f}-\nu}{2}\right)}\Bigg[w_{N}(f)(-1)^{\d_{f}}N^{\frac{1}{2}-s}\int_{\frac{1}{\sqrt{N}}}^{\infty}\left(\left(\frac{\del}{\del x}^{\d_{f}}\right)\conj{f}\right)(iy)y^{(1-s)-\frac{1}{2}+\d_{f}}\,\frac{dy}{y} \\
          &+ \int_{\frac{1}{\sqrt{N}}}^{\infty}\left(\frac{\del}{\del x}^{\d_{f}}f\right)(iy)y^{s-\frac{1}{2}+\d_{f}}\,\frac{dy}{y}\Bigg].
        \end{aligned}
      \end{equation}
      This integral representation will give analytic continuation. To see this, note that everything outside the brackets is entire. The integrands exhibit exponential decay and therefore the integrals are locally absolutely uniformly convergent on $\C$. Hence we have analytic continuation to all of $\C$. In particular, $L(s,f)$ has no poles.
    \subsection*{The Functional Equation}
      An immediate consequence of applying the symmetry $s \mapsto 1-s$ to \cref{equ:integral_representation_Maass_final} is the following functional equation:
      \[
        N^{\frac{s}{2}}\frac{\G\left(\frac{s+\d_{f}+\nu}{2}\right)\G\left(\frac{s+\d_{f}-\nu}{2}\right)}{2^{2-\d_{f}}\pi^{s}(-i)^{\d_{f}}}L(s,f) = \w_{N}(f)(-1)^{\d_{f}}N^{\frac{1-s}{2}}\frac{\G\left(\frac{(1-s)+\d_{f}+\nu}{2}\right)\G\left(\frac{(1-s)+\d_{f}-\nu}{2}\right)}{2^{2-\d_{f}}\pi^{1-s}(-i)^{\d_{f}}}L(1-s,\conj{f}).
      \]
      The constant factor in the denominator is independent of $s$ and so can be canceled in the functional equation. Therefore we identify the gamma factor as
      \[
        \g(s,f) = \pi^{-s}\G\left(\frac{s+\d_{f}+\nu}{2}\right)\G\left(\frac{s+\d_{f}-\nu}{2}\right),
      \]
      with $\k_{1} = \d_{f}+\nu$ and $\k_{2} = \d_{f}-\nu$ the local roots at infinity (these are conjugates because $\nu$ is either purely imaginary of real). The conductor is $q(f) = N$, so the primes dividing the level ramify, and by the Ramanujan-Petersson conjecture for Maass forms, $\a_{1}(p) \neq 0$ and $\a_{2}(p) \neq 0$  for all primes $p \nmid N$. The completed $L$-function is
      \[
        \L(s,f) = N^{\frac{s}{2}}\pi^{-s}\G\left(\frac{s+\d_{f}+\nu}{2}\right)\G\left(\frac{s+\d_{f}-\nu}{2}\right)L(s,f),
      \]
      with functional equation
      \[
        \L(s,f) = \w_{N}(f)(-1)^{\d_{f}}\L(1-s,\conj{f}).
      \]
      This is the functional equation of $L(s,f)$. From it, the root number is $\e(f) = \w_{N}(f)(-1)^{\d_{f}}$ and we see that $L(s,f)$ has dual $L(s,\conj{f})$. We will now show that $L(s,f)$ is of order $1$. Since $L(s,f)$ has no poles, we do not need to clear any polar divisors. As the integrals in \cref{equ:integral_representation_Maass_final} are locally absolutely uniformly convergent, computing the order amounts to estimating the gamma factor. Since the reciprocal of the gamma function is of order $1$, we have
      \[
        \frac{1}{\g(s,f)} \ll_{\e} e^{|s|^{1+\e}}.
      \]
      So the reciprocal of the gamma factor is also of order $1$. Then
      \[
        L(s,f) \ll_{\e} e^{|s|^{1+\e}}.
      \]
      So $L(s,f)$ is of order $1$. We summarize all of our work into the following theorem:

      \begin{theorem}\label{equ:thm:primitive_Hecke-Maass_Selberg}
        For any primitive Hecke-Maass eigenform $f \in \mc{C}_{\nu}(N,\chi)$, $L(s,f)$ is a Selberg class $L$-function provided the Ramanujan-Petersson conjecture for Maass forms holds. For $\s > 1$, it has a degree $2$ Euler product given by 
        \[
          L(s,f) = \prod_{p \nmid N}(1-a_{f}(p)p^{-s}+\chi(p)p^{-2s})^{-1}\prod_{p \mid N}(1-a_{f}(p)p^{-s})^{-1}.
        \]
        Moreover, it admits analytic continuation to $\C$ and possesses the functional equation
        \[
          N^{\frac{s}{2}}\pi^{-s}\G\left(\frac{s+\d_{f}+\nu}{2}\right)\G\left(\frac{s+\d_{f}-\nu}{2}\right)L(s,f) = \L(s,f) = \w_{N}(f)(-1)^{\d_{f}}\L(1-s,\conj{f}).
        \]
      \end{theorem}
    \subsection*{Beyond Primitivity}
      We can still obtain analytic continuation of the $L$-series $L(s,f)$ if $f$ is not a primitive Hecke-Maass eigenform. Similarly to the Hecke $L$-function case, this holds because the primitive Hecke-Maass eigenforms form a basis for the space of newforms:

      \begin{theorem}\label{thm:analytic_continuation_Hecke-Maass}
        For any $f \in \mc{C}_{\nu}(\G_{1}(N))$, $L(s,f)$ is locally absolutely uniformly convergent for $\s > 1$ and admits analytic continuation to $\C$
      \end{theorem}
      \begin{proof}
        Argue as in the proof of \cref{thm:analytic_continuation_Hecke}.
      \end{proof}
  \section{The Rankin-Selberg Method}
    \subsection*{The Definition \& Euler Product}
      The Rankin-Selberg method is a process by which we can construct new $L$-functions from old ones. Instead of giving the general definition outright, we first provide a full discussion of the method only in the simplest case. Many technical difficulties arise in the fully general setting. Let $f,g \in \mc{S}_{k}(1)$ be primitive Hecke eigenforms with Fourier series
      \[
        f(z) = \sum_{n \ge 1}a_{f}(n)n^{\frac{k-1}{2}}e^{2\pi inz} \quad \text{and} \quad g(z) = \sum_{n \ge 1}a_{g}(n)n^{\frac{k-1}{2}}e^{2\pi inz}.
      \]
      The $L$-function $L(s,f \x g)$ of $f$ and $g$ is given by the $L$-series
      \[
        L(s,f \x g) = \sum_{n \ge 1}\frac{a_{f \x g}(n)}{n^{s}} = \sum_{n \ge 1}\frac{a_{f}(n)\conj{a_{g}(n)}}{n^{s}} = \sum_{n \ge 1}\frac{a_{f}(n)\conj{a_{g}(n)}}{n^{s}},
      \]
      The \textbf{Rankin-Selberg convolution}\index{Rankin-Selberg convolution} $L(s,f \ox g)$ of $f$ and $g$ is defined by
      \[
        L(s,f \ox g) = \sum_{n \ge 1}\frac{a_{f \ox g}(n)}{n^{s}} = \z(2s)L(s,f \x g),
      \]
      where $a_{f \ox g}(n) = \sum_{n = m\ell^{2}}a_{f}(m)\conj{a_{g}(m)}$. Our primary aim will be to show that $L(s,f \ox g)$ is the Rankin-Selberg convolution of $L(s,f)$ and $L(s,g)$ and is a Selberg class $L$-function. Since $a_{f}(n)$ and $a_{g}(n)$ are both multiplicative so is $a_{f \ox g}(n) \ll_{\e}$. Moreover, $a_{f \ox g}(n) \ll_{\e} n^{\e}$ because $a_{f}(n) \ll_{\e} n^{\e}$ and $a_{g}(n) \ll_{\e} n^{\e}$. It follows from \cref{prop:Dirichlet_series_Euler_product} that $L(s,f \ox g)$ is locally absolutely uniformly convergent for $\s > 1$ and admits the following infinite product expression:
      \[
        L(s,f \ox g) = \z(2s)L(s,f \x g) = \prod_{p}(1-p^{-2s})^{-1}\prod_{p}\left(\sum_{n \ge 0}\frac{a_{f}(p^{n})\conj{a_{g}(p^{n})}}{p^{ns}}\right).
      \]
      We now simplify the factor inside the latter product using \cref{equ:Hecke_L_function_coefficient_formula}:
      \begingroup
      \allowdisplaybreaks
          \begin{align*}
            \sum_{n \ge 0}\frac{a_{f}(p^{n})\conj{a_{g}(p^{n})}}{p^{ns}} &= \sum_{n \ge 0}\left(\frac{\a_{1}(p)^{n+1}-\a_{2}(p)^{n+1}}{\a_{1}(p)-\a_{2}(p)}\right)\left(\frac{(\conj{\b_{1}(p)})^{n+1}-(\conj{\b_{2}(p)})^{n+1}}{\conj{\b_{1}(p)}-\conj{\b_{2}(p)}}\right)p^{-ns} \\
            &= (\a_{1}(p)-\a_{2}(p))^{-1}\left(\conj{\b_{1}(p)}-\conj{\b_{2}(p)}\right)^{-1} \\
            &\cdot \bigg[\sum_{n \ge 1}\frac{\a_{1}(p)^{n}(\conj{\b_{1}(p)})^{n}}{p^{(n-1)s}}+\frac{\a_{2}(p)^{n}(\conj{\b_{2}(p)})^{n}}{p^{(n-1)s}}-\frac{\a_{1}(p)^{n}(\conj{\b_{2}(p)})^{n}}{p^{(n-1)s}}-\frac{\a_{2}(p)^{n}(\conj{\b_{1}(p)})^{n}}{p^{(n-1)s}}\bigg] \\
            &= (\a_{1}(p)-\a_{2}(p))^{-1}\left(\conj{\b_{1}(p)}-\conj{\b_{2}(p)}\right)^{-1}\bigg[\a_{1}(p)\conj{\b_{1}(p)}\left(1-\a_{1}(p)\conj{\b_{1}(p)}p^{-s}\right)^{-1} \\
            &+\a_{2}(p)\conj{\b_{2}(p)}\left(1-\a_{2}(p)\conj{\b_{2}(p)}p^{-s}\right)^{-1}-\a_{1}(p)\conj{\b_{2}(p)}\left(1-\a_{1}(p)\conj{\b_{2}(p)}p^{-s}\right)^{-1} \\
            &-\a_{2}(p)\conj{\b_{1}(p)}\left(1-\a_{2}(p)\conj{\b_{1}(p)}p^{-s}\right)^{-1}\bigg] \\
            &= (\a_{1}(p)-\a_{2}(p))^{-1}\left(\conj{\b_{1}(p)}-\conj{\b_{2}(p)}\right)^{-1}\left(1-\a_{1}(p)\conj{\b_{1}(p)}p^{-s}\right)^{-1} \\
            &\cdot\left(1-\a_{2}(p)\conj{\b_{2}(p)}p^{-s}\right)^{-1}\left(1-\a_{1}(p)\conj{\b_{2}(p)}p^{-s}\right)^{-1}\left(1-\a_{2}(p)\conj{\b_{1}(p)}p^{-s}\right)^{-1} \\
            &\cdot\bigg[\a_{1}(p)\conj{\b_{1}(p)}\left(1-\a_{2}(p)\conj{\b_{2}(p)}p^{-s}\right)\left(1-\a_{1}(p)\conj{\b_{2}(p)}p^{-s}\right)\left(1-\a_{2}(p)\conj{\b_{1}(p)}p^{-s}\right) \\
            &+\a_{2}(p)\conj{\b_{2}(p)}\left(1-\a_{1}(p)\conj{\b_{1}(p)}p^{-s}\right)\left(1-\a_{1}(p)\conj{\b_{2}(p)}p^{-s}\right)\left(1-\a_{2}(p)\conj{\b_{1}(p)}p^{-s}\right) \\
            &-\a_{1}(p)\conj{\b_{2}(p)}\left(1-\a_{1}(p)\conj{\b_{1}(p)}p^{-s}\right)\left(1-\a_{2}(p)\conj{\b_{2}(p)}p^{-s}\right)\left(1-\a_{2}(p)\conj{\b_{1}(p)}p^{-s}\right) \\
            &-\a_{2}(p)\conj{\b_{1}(p)}\left(1-\a_{1}(p)\conj{\b_{1}(p)}p^{-s}\right)\left(1-\a_{2}(p)\conj{\b_{2}(p)}p^{-s}\right)\left(1-\a_{1}(p)\conj{\b_{2}(p)}p^{-s}\right)\bigg].
          \end{align*}
      \endgroup
      The term in the brackets simplifies to
      \[
        \left(1-\a_{1}(p)\a_{2}(p)\conj{\b_{1}(p)}\conj{\b_{2}(p)}p^{-2s}\right)(\a_{1}(p)-\a_{2}(p))\left(\conj{\b_{1}(p)}-\conj{\b_{2}(p)}\right),
      \]
      because all of the other terms are annihilated by symmetry in $\a_{1}(p)$, $\a_{2}(p)$, $\conj{\b_{1}(p)}$, and $\conj{\b_{2}(p)}$. The Ramanujan-Petersson conjecture for holomorphic forms implies $\a_{1}(p)\a_{2}(p)\conj{\b_{1}(p)}\conj{\b_{2}(p)} = 1$. Therefore the corresponding factor above is $(1-p^{-2s})$. This factor cancels the local factor at $p$ in the Euler product of $\z(2s)$, so that
      \[
        \sum_{n \ge 0}\frac{a_{f}(p^{n})\conj{a_{g}(p^{n})}}{p^{ns}} = \prod_{1 \le j,\ell \le 2}\left(1-\a_{j}(p)\conj{\b_{\ell}(p)}p^{-s}\right)^{-1}.
      \]
      Hence we have the following degree $4$ Euler product:
      \[
        L(s,f \ox g) = \prod_{p}\prod_{1 \le j,\ell \le 2}\left(1-\a_{j}(p)\conj{\b_{\ell}(p)}p^{-s}\right)^{-1}.
      \]
      The local factor at $p$ is 
      \[
        L_{p}(s,f \ox g) = \prod_{1 \le j,\ell \le 2}\left(1-\a_{j}(p)\conj{\b_{\ell}(p)}p^{-s}\right)^{-1},
      \]
      with local roots $\a_{j}(p)\conj{\b_{\ell}(p)}$.
    \subsection*{The Integral Representation: Part I}
      We now look for an integral representation for $L(s,f \ox g)$. Consider the following integral:
      \[
        \int_{\G_{\infty}\backslash\H}f(z)\conj{g(z)}\Im(z)^{s+k}\,d\mu.
      \]
      This will turn out to be a Mellin transform as we will soon see. Since $f$ and $g$ have exponential decay, this integral is locally absolutely uniformly convergent for $\s > 1$ and hence defines an analytic function there. We have
      \begin{align*}
        \int_{\G_{\infty}\backslash\H}f(z)\conj{g(z)}\Im(z)^{s+k}\,d\mu &= \int_{0}^{\infty}\int_{0}^{1}f(x+iy)\conj{g(x+iy)}y^{s+k}\,\frac{dx\,dy}{y^{2}} \\
        &= \int_{0}^{\infty}\int_{0}^{1}\sum_{n,m \ge 1}a_{f}(n)\conj{a_{g}(m)}(nm)^{\frac{k-1}{2}}e^{2\pi i(n-m)x}e^{-2\pi(n+m)y}y^{s+k}\,\frac{dx\,dy}{y^{2}} \\
        &= \int_{0}^{\infty}\sum_{n,m \ge 1}\int_{0}^{1}a_{f}(n)\conj{a_{g}(m)}(nm)^{\frac{k-1}{2}}e^{2\pi i(n-m)x}e^{-2\pi(n+m)y}y^{s+k}\,\frac{dx\,dy}{y^{2}} && \text{FT} \\
        &= \int_{0}^{\infty}\sum_{n \ge 1}a_{f}(n)\conj{a_{g}(n)}n^{k-1}e^{-4\pi ny}y^{s+k}\,\frac{dy}{y^{2}},
      \end{align*}
      where the last line follows by \cref{equ:Dirac_integral_representation}. Observe that this last integral is a Mellin transform. The rest is a computation:
      \begin{align*}
        \int_{0}^{\infty}\sum_{n \ge 1}a_{f}(n)\conj{a_{g}(n)}n^{k-1}e^{-4\pi ny}y^{s+k}\,\frac{dy}{y^{2}} &= \sum_{n \ge 1}a_{f}(n)\conj{a_{g}(n)}n^{k-1}\int_{0}^{\infty}e^{-4\pi ny}y^{s+k}\,\frac{dy}{y^{2}} &&\text{FT} \\
        &= \sum_{n \ge 1}\frac{a_{f}(n)\conj{a_{g}(n)}}{(4\pi)^{s+k-1}n^{s}}\int_{0}^{\infty}e^{-y}y^{s+k-1}\,\frac{dy}{y} &&\text{$y \mapsto \frac{y}{4\pi n}$} \\
        &= \frac{\G\left(s+k-1\right)}{(4\pi)^{s+k-1}}\sum_{n \ge 1}\frac{a_{f}(n)\conj{a_{g}(n)}}{n^{s}} \\
        &= \frac{\G\left(s+k-1\right)}{(4\pi)^{s+k-1}}L(s,f \x g).
      \end{align*}
      Rewriting, we have an integral representation
      \[
        L(s,f \x g) = \frac{(4\pi)^{s+k-1}}{\G(s+k-1)}\int_{\G_{\infty}\backslash\H}f(z)\conj{g(z)}\Im(z)^{s+k}\,d\mu.
      \]
      We rewrite the integral as follows:
      \begin{align*}
        \int_{\G_{\infty}\backslash\H}f(z)\conj{g(z)}\Im(z)^{s+k}\,d\mu &= \int_{\mc{F}}\sum_{\g \in \GG}f(\g z)\conj{g(\g z)}\Im(\g z)^{s+k}\,d\mu && \text{folding} \\
        &= \int_{\mc{F}}\sum_{\g \in \GG}j(\g,z)^{k}\conj{j(\g,z)^{k}}f(z)\conj{g(z)}\Im(\g z)^{s+k}\,d\mu && \text{modularity} \\
        &= \int_{\mc{F}}f(z)\conj{g(z)}\sum_{\g \in \GG}|j(\g,z)|^{2k}\Im(\g z)^{s+k}\,d\mu \\
        &= \int_{\mc{F}}f(z)\conj{g(z)}\Im(z)^{k}\sum_{\g \in \GG}\Im(\g z)^{s}\,d\mu \\
        &= \int_{\mc{F}}f(z)\conj{g(z)}\Im(z)^{k}E(z,s)\,d\mu.
      \end{align*}
      Note that $E(z,s)$ is the weight zero Eisenstein series on $\G_{1}(1)\backslash\H$ at the $\infty$ cusp. Altogether, this gives the integral representation
      \begin{equation}\label{equ:Rankin-Selberg_integral-reresentation}
        L(s,f \x g) =  \frac{(4\pi)^{s+k-1}}{\G(s+k-1)}\int_{\mc{F}}f(z)\conj{g(z)}\Im(z)^{k}E(z,s)\,d\mu.
      \end{equation}
      We cannot investigate the integral any further until we understand the Fourier-Whittaker series of $E(z,s)$ and obtain a functional equation. Therefore we will take a necessary detour and return to the integral after.
    \subsection*{Explicit Fourier-Whittaker Series of Eisenstein Series}
      We will compute the Fourier-Whittaker series of $E(z,s)$. To do this we will need the following technical lemma:

      \begin{lemma}\label{lem:Ramanujan_zeta_relation}
        For $\s > 1$ and $b \in \Z$,
        \[
          \sum_{m \ge 1}\frac{r(b,m)}{m^{2s}} = \begin{cases} \frac{\z(2s-1)}{\z(2s)} & \text{if $b = 0$}, \\ \frac{\s_{1-2s}(|b|)}{\z(2s)} & \text{if $b \neq 0$}, \end{cases}
        \]
        where $\s_{s}(b)$ is the generalized sum of divisors function.
      \end{lemma}
      \begin{proof}
        If $\s > 1$ then the desired evaluation of the sum is locally absolutely uniformly convergent because the Riemann zeta function is in that region. Hence the sum will be too provided we prove the identity. Suppose $b = 0$. Then $r(0,m) = \vphi(m)$. Since $\vphi(m)$ is multiplicative we have
        \begin{equation}\label{equ:Ramanujan_zeta_relation_1}
          \sum_{m \ge 1}\frac{\vphi(m)}{m^{2s}} = \prod_{p}\left(\sum_{k \ge 0}\frac{\vphi(p^{k})}{p^{k(2s)}}\right).
        \end{equation}
        Recalling that $\vphi(p^{k}) = p^{k}-p^{k-1}$ for $k \ge 1$, make the following computation:
        \begin{equation}\label{equ:Ramanujan_zeta_relation_2}
          \begin{aligned}
            \sum_{k \ge 0}\frac{\vphi(p^{k})}{p^{k(2s)}} &= 1+\sum_{k \ge 1}\frac{p^{k}-p^{k-1}}{p^{k(2s)}} \\
            &= \sum_{k \ge 0}\frac{1}{p^{k(2s-1)}}-\frac{1}{p}\sum_{k \ge 1}\frac{1}{p^{k(2s-1)}} \\
            &= \sum_{k \ge 0}\frac{1}{p^{k(2s-1)}}-p^{-2s}\sum_{k \ge 0}\frac{1}{p^{k(2s-1)}} \\
            &= (1-p^{-2s})\sum_{k \ge 0}\frac{1}{p^{k(2s-1)}} \\
            &= \frac{1-p^{-2s}}{1-p^{-(2s-1)}}.
          \end{aligned}
        \end{equation}
        Combining \cref{equ:Ramanujan_zeta_relation_1,equ:Ramanujan_zeta_relation_2} gives
        \[
          \sum_{m \ge 1}\frac{\vphi(m)}{m^{2s}} = \frac{\z(2s-1)}{\z(2s)}.
        \]
        Now suppose $b \neq 0$, \cref{prop:Ramanujan_sum_evaluation} gives the first equality in the following chain:
        \begin{align*}
          \sum_{m \ge 1}\frac{r(b,m)}{m^{2s}} &= \sum_{m \ge 1}m^{-2s}\sum_{\ell \mid (b,m)}\ell\mu\left(\frac{m}{\ell}\right) \\
          &= \sum_{\ell \mid b}\ell\sum_{m \ge 1}\frac{\mu(m)}{(m\ell)^{2s}} \\
          &= \left(\sum_{\ell \mid b}\ell^{1-2s}\right)\left(\sum_{m \ge 1}\frac{\mu(m)}{m^{2s}}\right) \\
          &= \s_{1-2s}(b)\sum_{m \ge 1}\frac{\mu(m)}{m^{2s}} \\
          &= \s_{1-2s}(|b|)\sum_{m \ge 1}\frac{\mu(m)}{m^{2s}} \\
          &= \frac{\s_{1-2s}(|b|)}{\z(2s)} && \text{\cref{prop:Dirichlet_Mobius_is_zeta_inverse}}.
        \end{align*}
      \end{proof}

      We can now compute the Fourier-Whittaker series of $E(z,s)$:

      \begin{proposition}\label{prop:Fourier_coefficients_of_real-analytic_Eisenstein_series}
        The Fourier-Whittaker series of $E(z,s)$ is given by
        \[
          E(z,s) = y^{s}+y^{1-s}\frac{\sqrt{\pi}\G\left(s-\frac{1}{2}\right)\z(2s-1)}{\G(s)\z(2s)}+\sum_{t \ge 1}\left(\frac{2\pi^{s}|t|^{s-\frac{1}{2}\s_{1-2s}(|t|)}}{\G(s)\z(2s)}\sqrt{y}K_{s-\frac{1}{2}}(2\pi|t|y)\right)e^{2\pi itx}.
        \]
      \end{proposition}
      \begin{proof}
        Fix $s$ with $\s > 1$. By the Bruhat decomposition for $\G_{1}(1)$ and \cref{rem:Bruhat_modulo_infity_exact}, we have
        \[
          E(z,s) = \Im(z)^{s}+\sum_{\substack{c \ge 1, d \in \Z \\ (c,d) = 1}}\frac{\Im(z)^{s}}{|cz+d|^{2s}}.
        \]
        Summing over all pairs $(c,d) \in \Z^{2}-\{\mathbf{0}\}$ with $c \ge 1$, $d \in \Z$, and $(c,d) = 1$ is the same as summing over all triples $(c,\ell,r)$ with $c \ge 1$, $\ell \in \Z$, $r$ taken modulo $c$, and $(r,c) = 1$. This is seen by writing $d = c\ell+r$. Therefore
        \[
          \sum_{\substack{c \ge 1, d \in \Z \\ (c,d) = 1}}\frac{\Im(z)^{s}}{|cx+icy+d|^{2s}} = \sum_{(c,\ell,r)}\frac{\Im(z)^{s}}{|cz+c\ell+r|^{2s}} = \psum_{\substack{c \ge 1 \\ r \tmod{c}}}\sum_{\ell \in \Z}\frac{\Im(z)^{s}}{|cz+c\ell+r|^{2s}}.
        \]
         where on the right-hand side it is understood that we are summing over all triples $(c,\ell,r)$ with the prescribed properties. Now let
        \[
          I_{c,r}(z,s) = \sum_{\ell \in \Z}\frac{\Im(z)^{s}}{|cz+c\ell+r|^{2s}}.
        \]
        We apply the Poisson summation formula to $I_{c,r}(z,s)$. By the identity theorem it suffices to apply the Poisson summation formula for $z = iy$ with $y > 0$. So let $f(x)$ be given by
        \[
          f(x) = \frac{y^{s}}{|cx+r+icy|^{2s}}.
        \]
        Then $f(x)$ is absolutely integrable on $\R$ because it exhibits polynomial decay of order $\s > 1$. We compute the Fourier transform
        \begin{align*}
          (\mc{F}f)(t) &= \int_{-\infty}^{\infty}f(x)e^{-2\pi itx}\,dx \\
          &= \int_{-\infty}^{\infty}\frac{y^{s}}{|cx+r+icy|^{2s}}e^{-2\pi itx}\,dx \\
          &= \int_{-\infty}^{\infty}\frac{y^{s}}{((cx+r)^{2}+(cy)^{2})^{s}}e^{-2\pi itx}\,dx \\
          &= e^{2\pi it\frac{r}{c}}\int_{-\infty}^{\infty}\frac{y^{s}}{((cx)^{2}+(cy)^{2})^{s}}e^{-2\pi itx}\,dx && \text{$x \mapsto x-\frac{r}{c}$} \\
          &= \frac{e^{2\pi it\frac{r}{c}}}{c^{2s}}\int_{-\infty}^{\infty}\frac{y^{s}}{(x^{2}+y^{2})^{s}}e^{-2\pi itx}\,dx \\
          &= \frac{e^{2\pi it\frac{r}{c}}}{c^{2s}}\int_{-\infty}^{\infty}\frac{y^{s+1}}{((xy)^{2}+y^{2})^{s}}e^{-2\pi itxy}\,dx && \text{$x \mapsto xy$} \\
          &= \frac{e^{2\pi it\frac{r}{c}}}{c^{2s}}\int_{-\infty}^{\infty}\frac{y^{1-s}}{(x^{2}+1)^{s}}e^{-2\pi itxy}\,dx.
        \end{align*}
        Appealing to \cref{append:Special_Integrals} to compute this latter integral, we see that
        \[
          (\mc{F}f)(t) = \begin{cases} \frac{y^{1-s}}{c^{2s}}\frac{\sqrt{\pi}\G\left(s-\frac{1}{2}\right)}{\G(s)} & \text{if $t = 0$}, \\ \frac{e^{2\pi it\frac{r}{c}}}{c^{2s}}\frac{2\pi^{s}|t|^{s-\frac{1}{2}}}{\G(s)}\sqrt{y}K_{s-\frac{1}{2}}(2\pi|t|y) & \text{if $t \neq 0$}. \end{cases}
        \]
        By the Poisson summation formula and the identity theorem, we have
        \[
          I_{c,r}(z,s) = \frac{y^{1-s}}{c^{2s}}\frac{\sqrt{\pi}\G\left(s-\frac{1}{2}\right)}{\G(s)}+\sum_{t \neq 0}\left(\frac{e^{2\pi it\frac{r}{c}}}{c^{2s}}\frac{2\pi^{s}|t|^{s-\frac{1}{2}}}{\G(s)}\sqrt{y}K_{s-\frac{1}{2}}(2\pi|t|y)\right)e^{2\pi itx}.
        \]
        Substituting this back into the Eisenstein series gives a form of the Fourier-Whittaker series:
      \begin{align*}
        E(z,s) &= y^{s}+\psum_{\substack{c \ge 1 \\ r \tmod{c}}}\left(\frac{y^{1-s}}{c^{2s}}\frac{\sqrt{\pi}\G\left(s-\frac{1}{2}\right)}{\G(s)}+\sum_{t \ge 1}\left(\frac{e^{2\pi it\frac{r}{c}}}{c^{2s}}\frac{2\pi^{s}|t|^{s-\frac{1}{2}}}{\G(s)}\sqrt{y}K_{s-\frac{1}{2}}(2\pi|t|y)\right)e^{2\pi itx}\right) \\
        &= y^{s}+y^{1-s}\psum_{\substack{c \ge 1 \\ r \tmod{c}}}\frac{1}{c^{2s}}\frac{\sqrt{\pi}\G\left(s-\frac{1}{2}\right)}{\G(s)}+\sum_{t \ge 1}\left(\psum_{\substack{c \ge 1 \\ r \tmod{c}}}\frac{e^{2\pi it\frac{r}{c}}}{c^{2s}}\frac{2\pi^{s}|t|^{s-\frac{1}{2}}}{\G(s)}\sqrt{y}K_{s-\frac{1}{2}}(2\pi|t|y)\right)e^{2\pi itx} \\
        &= y^{s}+y^{1-s}\sum_{c \ge 1}\frac{r(0,c)}{c^{2s}}\frac{\sqrt{\pi}\G\left(s-\frac{1}{2}\right)}{\G(s)}+\sum_{t \ge 1}\left(\sum_{c \ge 1}\frac{r(t,c)}{c^{2s}}\frac{2\pi^{s}|t|^{s-\frac{1}{2}}}{\G(s)}\sqrt{y}K_{s-\frac{1}{2}}(2\pi|t|y)\right)e^{2\pi itx}.
      \end{align*}
      By applying \cref{lem:Ramanujan_zeta_relation} to compute the Dirichlet series of Ramanujan sums, we obtain the desired Fourier-Whittaker series:
      \[
        E(z,s) = y^{s}+y^{1-s}\frac{\sqrt{\pi}\G\left(s-\frac{1}{2}\right)\z(2s-1)}{\G(s)\z(2s)}+\sum_{t \ge 1}\left(\frac{2\pi^{s}|t|^{s-\frac{1}{2}\s_{1-2s}(|t|)}}{\G(s)\z(2s)}\sqrt{y}K_{s-\frac{1}{2}}(2\pi|t|y)\right)e^{2\pi itx}.
      \]
      \end{proof}

      Having computed the Fourier-Whittaker series, we would like to obtain a functional equation for $E(z,s)$ under the symmetry $s \mapsto 1-s$. To this end, we define $E^{\ast}(z,s)$ by
      \[
        E^{\ast}(z,s) = \L(2s,\z)E(z,s) = \pi^{-s}\G(s)\z(2s)E(z,s).
      \]
      From \cref{prop:Fourier_coefficients_of_real-analytic_Eisenstein_series}, the Fourier coefficients $a^{\ast}(n,y,s)$ of $E^{\ast}(z,s)$ in the Fourier series
      \[
        E^{\ast}(z,s) = a^{\ast}(0,y,s)+\sum_{n \neq 0}a^{\ast}(n,y,s)e^{2\pi inx},
      \]
       are given by
      \[
        a^{\ast}(n,y,s) = \begin{cases} y^{s}\pi^{-s}\G(s)\z(2s)+y^{1-s}\pi^{-\left(s-\frac{1}{2}\right)}\G(s-\frac{1}{2})\z(2s-1) & \text{if $n = 0$}, \\ 2|n|^{s-\frac{1}{2}}\s_{1-2s}(|n|)\sqrt{y}K_{s-\frac{1}{2}}(2\pi|n|y) & \text{if $n \neq 0$}. \end{cases}
      \]
      We can now derive a functional equation for $E^{\ast}(z,s)$. Using the definition and functional equation for $\L(2s-1,\z)$, we can rewrite the second term in the constant coefficient to get
      \begin{equation}\label{equ:Fourier_coefficients_for_completed_real-analytic_Eisenstein_series}
        a^{\ast}(n,y,s) = \begin{cases} y^{s}\L(2s,\z)+y^{1-s}\L(2(1-s),\z) & \text{if $n = 0$}, \\ 2|n|^{s-\frac{1}{2}}\s_{1-2s}(|n|)\sqrt{y}K_{s-\frac{1}{2}}(2\pi|n|y) & \text{if $n \neq 0$}. \end{cases}
      \end{equation}
      Now observe that the constant coefficient is invariant under $s \mapsto 1-s$. Each $n \neq 0$ coefficient is also invariant under $s \mapsto 1-s$. To see this we will use two facts. First, from \cref{append:Bessel_Functions}, $K_{s}(y)$ is invariant under $s \mapsto -s$ and so $K_{s-\frac{1}{2}}(2\pi|n|y)$ is invariant as $s \mapsto 1-s$. Second, for $n \ge 1$ we have
      \[
        n^{s-\frac{1}{2}}\s_{1-2s}(n) = n^{\frac{1}{2}-s}n^{2s-1}\s_{1-2s}(n) = n^{\frac{1}{2}-s}n^{2s-1}\sum_{d \mid n}d^{1-2s} = n^{\frac{1}{2}-s}\sum_{d \mid n}\left(\frac{n}{d}\right)^{2s-1} = n^{\frac{1}{2}-s}\s_{2s-1}(n),
      \]
      where the second to last equality follows by writing $n^{2s-1} = \left(\frac{n}{d}\right)^{2s-1}d^{2s-1}$ for each $d \mid n$. These two facts together give the invariance of the $n \neq 0$ coefficients under $s \mapsto 1-s$. Altogether, we have shown the following functional equation for $E^{\ast}(z,s)$:
      \[
        E^{\ast}(z,s) = E^{\ast}(z,1-s).
      \]
      We can now obtain meromorphic continuation of $E^{\ast}(z,s)$ in $s$ to all of $\C$ for any $z \in \H$. We first write $E^{\ast}(z,s)$ as a Fourier-Whittaker series using \cref{equ:Fourier_coefficients_for_completed_real-analytic_Eisenstein_series}:
      \[
        E^{\ast}(z,s) = y^{s}\L(2s,\z)+y^{1-s}\L(2(1-s),\z)+\sum_{n \neq 0}2|n|^{s-\frac{1}{2}}\s_{1-2s}(|n|)\sqrt{y}K_{s-\frac{1}{2}}(2\pi|n|y)e^{2\pi inx}.
      \]
      Since $\L(2s,\z)$ is meromorphic on $\C$, the constant term of $E^{\ast}(z,s)$ is as well. To finish the meromorphic continuation of $E^{\ast}(z,s)$ it now suffices to show
      \[
        \sum_{n \neq 0}2|n|^{s-\frac{1}{2}}\s_{1-2s}(|n|)\sqrt{y}K_{s-\frac{1}{2}}(2\pi|n|y)e^{2\pi inx},
      \]
      is meromorphic on $\C$. We will actually prove it is locally absolutely uniformly convergent. So let $K$ be a compact subset of $\C$. Then we have to show $E^{\ast}(z,s)$ is absolutely convergent on $K$ for any $z \in \H$. To achieve this we need two bounds, one for $\s_{1-2s}(|n|)$ and one for $K_{s-\frac{1}{2}}(2\pi|n|y)$. For the first bound, we use the estimate $\s_{0}(|n|) \ll_{\e} |n|^{\e}$ (recall \cref{prop:sum_of_divisors_growth_rate}). Therefore we have the crude bound
      \[
        \s_{1-2s}(|n|) = \sum_{d \mid n}d^{1-2s} < \s_{0}(|n|)|n|^{1-2s} \ll_{\e}|n|^{1-2s+\e}.
      \]
      For the second bound, \cref{lem:K_Bessel_function_asymptotic} implies
      \[
        K_{s-\frac{1}{2}}(2\pi|n|y) \ll e^{-2\pi|n|y}.
      \]
      Using these two bounds, we have
      \begin{equation}\label{equ:non-constant_Fourier_coefficient_bound_non-holomorphic_Eisenstein_series}
        \sum_{n \neq 0}2|n|^{s-\frac{1}{2}}\s_{1-2s}(|n|)\sqrt{y}K_{s-\frac{1}{2}}(2\pi|n|y)e^{2\pi inx} \ll_{\e} \sum_{n \ge 1}n^{\frac{1}{2}-s+\e}\sqrt{y}e^{-2\pi ny}.
      \end{equation}
      This latter series is absolutely uniformly convergent on $K$ by the Weierstrass $M$-test. Therefore $E^{\ast}(z,s)$ is absolutely convergent on $K$ for any $z \in \H$ and the meromorphic continuation to $\C$ follows. It remains to investigate the poles and residues. We will accomplish this from direct inspection of the Fourier-Whittaker coefficients:

      \begin{proposition}\label{equ:completed_real-analytic_Eisenstein_series_residues}
        $E^{\ast}(z,s)$ has simple poles at $s = 0$ and $s = 1$, and
        \[
          \Res_{s = 0}E^{\ast}(z,s) = -\frac{1}{2} \quad \text{and} \quad \Res_{s = 1}E^{\ast}(z,s) = \frac{1}{2}.
        \]
      \end{proposition}
      \begin{proof}
        Since the constant term in the Fourier-Whittaker series of $E^{\ast}(z,s)$ is the only non-holomorphic term, poles of $E^{\ast}(z,s)$ can only come from that term. So we are reduced to understanding the poles of
        \begin{equation}\label{equ:constant_coefficient_of_completed_non-holomorphic_Eisenstein_series}
          y^{s}\L(2s,\z)+y^{1-s}\L(2(1-s),\z).
        \end{equation}
        Notice $\L(2s,\z)$ has simple poles at $s = 0$, $s = \frac{1}{2}$ (one from the Riemann zeta function and one from the gamma factor) and no others. It follows that $E^{\ast}(z,s)$ has a simple pole at $s = 0$ coming from the $y^{s}$ term in
        \cref{equ:constant_coefficient_of_completed_non-holomorphic_Eisenstein_series}, and by the functional equation there is also a pole at $s = 1$ coming from the $y^{1-s}$ term. At $s = \frac{1}{2}$, both terms in \cref{equ:constant_coefficient_of_completed_non-holomorphic_Eisenstein_series} have simple poles and we will show that the singularity there is removable. Recall $\G\left(\frac{1}{2}\right) = \sqrt{\pi}$. Also, by \cref{prop:zeta_residue}, $\Res_{s = \frac{1}{2}}\z(2s) = \frac{1}{2}$ and $\Res_{s = \frac{1}{2}}\z(2(1-s)) = -\frac{1}{2}$. So altogether
        \[
          \Res_{s = \frac{1}{2}}E^{\ast}(z,s) = \Res_{s = \frac{1}{2}}[y^{s}\L(2s,\z)+y^{1-s}\L(2(1-s),\z)] = \frac{1}{2}y^{\frac{1}{2}}-\frac{1}{2}y^{\frac{1}{2}} = 0.
        \]
        Hence the singularity at $s = \frac{1}{2}$ is removable. As for the residues at $s = 0$ and $s = 1$, the functional equation implies that they are negatives of each other. So it suffices to compute the residue at $s = 0$. Recall $\z(0) = -\frac{1}{2}$ and $\Res_{s = 0}\G(s) = 1$. Then together we find
        \[
          \Res_{s = 0}E^{\ast}(z,s) = \Res_{s = 0}y^{s}\L(2s,\z) = -\frac{1}{2}.
        \]
      \end{proof}

      This completes our study of $E(z,s)$.
    \subsection*{The Integral Representation: Part II}
      We can now continue with the Rankin-Selberg convolution $L(s,f \ox g)$. Writing \cref{equ:Rankin-Selberg_integral-reresentation} in terms of $E^{\ast}(z,s)$ and $L(s,f \ox g)$ results in the integral representation
      \begin{equation}\label{equ:integral_representation_Rankin-Selberg_final}
        L(s,f \ox g) = \frac{(4\pi)^{s+k-1}\pi^{s}}{\G(s+k-1)\G(s)}\int_{\mc{F}}f(z)\conj{g(z)}\Im(z)^{k}E^{\ast}(z,s)\,d\mu.
      \end{equation}
      This integral representation will give analytic continuation. To see this, note that the gamma functions are analytic for $\s < 0$. By the functional equation for $E^{\ast}(z,s)$, the integral is invariant as $s \mapsto 1-s$. These two facts together give analytic continuation to $\C$ outside of the critical strip. The continuation inside of the critical strip will be meromorphic because of the poles of $E^{\ast}(z,s)$. To see this, substituting the Fourier-Whittaker series for $E^{\ast}(z,s)$ into \cref{equ:integral_representation_Rankin-Selberg_final} gives
      \begin{align*}
        L(s,f \ox g) &= \frac{(4\pi)^{s+k-1}\pi^{s}}{\G(s+k-1)\G(s)}\Bigg[\int_{\mc{F}}f(x+iy)\conj{g(x+iy)}y^{k}(y^{s}\L(2s,\z)+y^{1-s}\L(2(1-s),\z))\,\frac{dx\,dy}{y^{2}} \\
        &+\int_{\mc{F}}f(x+iy)\conj{g(x+iy)}y^{k}\sum_{n \neq 0}2|n|^{s-\frac{1}{2}}\s_{1-2s}(|n|)\sqrt{y}K_{s-\frac{1}{2}}(2\pi|n|y)e^{2\pi inx}\,\frac{dx\,dy}{y^{2}}\Bigg],
      \end{align*}
      and we are reduced to showing that both integrals are locally absolutely uniformly convergent in the critical strip and distance $\e$ away from the poles of $E^{\ast}(z,s)$. Indeed, the first integral is locally absolutely uniformly convergent in this region since the exponential decay of $f$ and $g$ imply that the integrand is bounded and we are integrating over a region of finite volume. As for the second integral, since $s$ is in the critical strip $0 \le \s \le 1$ and so \cref{equ:non-constant_Fourier_coefficient_bound_non-holomorphic_Eisenstein_series} implies that it is
      \[
        O_{\e}\left(\int_{\mc{F}}f(x+iy)\conj{g(x+iy)}y^{k}\sum_{n \ge 1}n^{\frac{1}{2}+\e}\sqrt{y}e^{-2\pi ny}\,\frac{dx\,dy}{y^{2}}\right).
      \]
      But then
      \[
        \sum_{n \ge 1}n^{\frac{1}{2}+\e}e^{-2\pi ny} = O(e^{-2\pi y}),
      \]
      because each term is of smaller order than the next so that the series is bounded by a constant times its first term. It follows that the first sum has exponential decay. Together with the exponential decay of $f$ and $g$, the integrand is bounded and thus is locally absolutely uniformly convergent because we are integrating over a region of finite volume. The meromorphic continuation to the critical strip and hence to all of $\C$ follows. In particular, $L(s,f \ox g)$ has at most simple poles at $s = 0$ and $s = 1$. Actually, there is no pole at $s = 0$. Indeed, $\G(s)$ has a simple pole at $s = 0$ and therefore its reciprocal has a simple zero. This cancels the simple pole at $s = 0$ coming from $E^{\ast}(z,s)$ and therefore $L(s,f \ox g)$ is has a removable singularity at $s = 0$. So there is at worst a simple pole at $s = 1$.
    \subsection*{The Functional Equation}
      An immediate consequence of applying the symmetry $s \mapsto 1-s$ to \cref{equ:integral_representation_Rankin-Selberg_final} is the following functional equation:
      \[
        \frac{\G(s+k-1)\G(s)}{(4\pi)^{s+k-1}\pi^{s}}L(s,f \ox g) = \frac{\G((1-s)+k-1)\G(1-s)}{(4\pi)^{(1-s)+k-1}\pi^{1-s}}L(1-s,f \ox g).
      \]
      Applying the Legendre duplication formula, we see that
      \begin{align*}
        \frac{\G(s+k-1)\G(s)}{(4\pi)^{s+k-1}\pi^{s}} &= \frac{2^{2s+k-3}}{(4\pi)^{s+k-1}\pi^{s+1}}\G\left(\frac{s+k-1}{2}\right)\G\left(\frac{s+k}{2}\right)\G\left(\frac{s}{2}\right)\G\left(\frac{s+1}{2}\right) \\
        &= \frac{1}{2^{k+1}\pi^{k}}\pi^{-2s}\G\left(\frac{s+k-1}{2}\right)\G\left(\frac{s+k}{2}\right)\G\left(\frac{s}{2}\right)\G\left(\frac{s+1}{2}\right).
      \end{align*}
      The constant factor in front is independent of $s$ and can therefore be canceled in the functional equation. We identify the gamma factor as:
      \[
        \g(s,f \ox g) = \pi^{-2s}\G\left(\frac{s+k-1}{2}\right)\G\left(\frac{s+k}{2}\right)\G\left(\frac{s}{2}\right)\G\left(\frac{s+1}{2}\right),
      \]
      with $\mu_{1,1} = k-1$, $\mu_{2,2} = k$, $\mu_{1,2} = 0$, and $\mu_{2,1} = 1$ the local roots at infinity. The completed $L$-function is
      \[
        \L(s,f \ox g) = \pi^{-2s}\G\left(\frac{s+k-1}{2}\right)\G\left(\frac{s+k}{2}\right)\G\left(\frac{s}{2}\right)\G\left(\frac{s+1}{2}\right)L(s,f \ox g),
      \]
      so the conductor is $q(f \ox g) = 1$ and no primes ramify. Clearly $q(f \ox g) \mid q(f)^{2}q(g)^{2}$ and conductor dropping does not occur. Then
      \[
        \L(s,f \ox g) = \L(1-s,f \ox g),
      \]
      is the functional equation of $L(s,f \ox g)$. In particular, the root number $\e(f \ox g) = 1$, and $L(s,f \ox g)$ is self-dual. We can now show that $L(s,f \ox g)$ is of order $1$. Since the possible pole at $s = 1$ is simple, multiplying by $(s-1)$ clears the possible polar divisor. As the integral in \cref{equ:integral_representation_Rankin-Selberg_final} is locally absolutely uniformly convergent, computing the order amounts to estimating the gamma factor. Since the reciprocal of the gamma function is of order $1$, we have
      \[
        \frac{1}{\g(s,f \ox g)} \ll_{\e} e^{|s|^{1+\e}}.
      \]
      So the reciprocal of the gamma factor is also of order $1$. Then we find that
      \[
        (s-1)L(s,f \ox g) \ll_{\e} e^{|s|^{1+\e}}.
      \]
      Thus $(s-1)L(s,f \ox g)$ is of order $1$, and so $L(s,f \ox g)$ is as well after removing the polar divisor. At last, we compute the residue of $L(s,f \ox g)$ at $s = 1$:

      \begin{proposition}
        Let $f,g \in \mc{S}_{k}(1)$ be primitive Hecke eigenforms. Then
        \[
          \Res_{s = 1}L(s,f \ox g) = \frac{4^{k}\pi^{k+1}V}{2\G(k)}\<f,g\>,
        \]
        where $\<f,g\>$ is the Petersson inner product.
      \end{proposition}
      \begin{proof}
        As $V = \frac{\pi}{3}$, \cref{equ:completed_real-analytic_Eisenstein_series_residues} implies
        \[
          \Res_{s = 1}L(s,f \ox g) = \frac{4^{k}\pi^{k+1}}{\G(k)}\Res_{s = 1}\int_{\mc{F}}f(z)\conj{g(z)}\Im(z)^{k}E^{\ast}(z,s)\,d\mu = \frac{4^{k}\pi^{k+1}V}{2\G(k)}\<f,g\>.
        \]
      \end{proof}

      Notice that if $f = g$, then $\<f,f\> \neq 0$ and therefore the residue at $s = 1$ is not zero and hence not a removable singularity. Actually, this is the only instance in which there is a pole since \cref{thm:newforms_characterization_holomorphic} implies that the primitive Hecke eigenforms are orthogonal so that $\<f,g\> = 0$ unless $f = g$. We summarize all of our work into the following theorem:

      \begin{theorem}
        For any two primitive Hecke eigenforms $f,g \in \mc{S}_{k}(1)$, $L(s,f \ox g)$ is the Rankin-Selberg convolution of $L(s,f)$ and $L(s,g)$ and is a Selberg class $L$-function. For $\s > 1$, it has a degree $4$ Euler product given by
        \[
          L(s,f \ox g) = \prod_{p}\left(\sum_{n \ge 0}\frac{a_{f}(p^{n})\conj{a_{g}(p^{n})}}{p^{ns}}\right).
        \]
        Moreover, it admits meromorphic continuation to $\C$, possesses the functional equation
        \[
          \pi^{-2s}\G\left(\frac{s+k-1}{2}\right)\G\left(\frac{s+k}{2}\right)\G\left(\frac{s}{2}\right)\G\left(\frac{s+1}{2}\right)L(s,f \ox g) = \L(s,f \ox g) = \L(1-s,f \ox g),
        \]
        and there is simple pole at $s = 1$ of residue $\frac{4^{k}\pi^{k+1}V}{2\G(k)}\<f,g\>$ provided $f = g$.
      \end{theorem}
    \subsection*{Beyond Level \texorpdfstring{$1$}{1}}
      The Rankin-Selberg method is much more complicated for arbitrary primitive Hecke or Hecke-Maass eigenforms, but the argument is essentially the same. Let $f$ and $g$ both be primitive Hecke or Heck-Maass eigenforms with Fourier or Fourier-Whittaker coefficients $a_{f}(n)$ and $a_{g}(n)$ respectively. We suppose $f$ has weight $k$/type $\nu$, level $N$, and character $\chi$, and $g$ has weight $\ell$/type $\eta$, level $M$, and character $\psi$. 
      The $L$-function $L(s,f \x g)$ of $f$ and $g$ is given by the $L$-series
      \[
        L(s,f \x g) = \sum_{n \ge 1}\frac{a_{f \x g}(n)}{n^{s}} = \sum_{n \ge 1}\frac{a_{f}(n)\conj{a_{g}(n)}}{n^{s}}.
      \]
      The \textbf{Rankin-Selberg convolution}\index{Rankin-Selberg convolution} $L(s,f \ox g)$ of $f$ and $g$ is defined by
      \[
        L(s,f \ox g) = \sum_{n \ge 1}\frac{a_{f \ox g}(n)}{n^{s}} = L(2s,\chi\conj{\psi})L(s,f \x g),
      \]
      where $a_{f \ox g}(n) = \sum_{n = m\ell^{2}}\chi\conj{\psi}(\ell^{2})a_{f}(m)\conj{a_{g}(m)}$. The following generalization was obtained by Jacquet in the 1970's as a consequence of a more general framework (see \cite{jacquet1970automorphic,jacquet1972automorphic}):

      \begin{theorem}\label{thm:generalization_Rankin_Selberg_method}
        Let $f$ and $b$ both be primitive Hecke or Heck-Maass eigenforms. Also suppose the following: 
        \begin{enumerate}[label=(\roman*)]
          \item $f$ has weight $k$/type $\nu$, level $N$, and character $\chi$.
          \item $g$ has weight $\ell$/type $\eta$, level $M$, and character $\psi$.
          \item The Ramanujan-Petersson conjecture for Maass forms holds if $f$ or $g$ are Heck-Maass eigenforms.
        \end{enumerate}
        Then $L(s,f \ox g)$ is the Rankin-Selberg convolution of $L(s,f)$ and $L(s,g)$ and is a Selberg class $L$-function.
      \end{theorem}

      We make a few remarks about how \cref{thm:generalization_Rankin_Selberg_method} could be proved analogously to the case of two holomorphic cusp forms of level $1$. Local absolute uniform convergence for $\s > 1$ are proved in the exactly the same way as we have described. The argument for the Euler product is also similar. However, if either $N > 1$ or $M > 1$, the computation becomes more difficult since the local factors at $p$ for $p \mid NM$ change. Moreover, the situation is increasingly complicated if $(N,M) > 1$ since conductor dropping can occur. The integral representation has a similar argument, but if the weights/types are distinct the resulting Eisenstein series becomes more complicated. In particular, the Eisenstein series is on $\G_{0}(NM)\backslash\H$ and if $NM > 1$, then there is more than just the cusp at $\infty$. Therefore the functional equation of the Eisenstein series at the $\infty$ cusp will reflect into a linear combination of Eisenstein series at the other cusps. This requires the Fourier-Whittaker series of all of these Eisenstein series. Moreover, this procedure can be generalized to remove the primitive Hecke and/or primitive Hecke-Maass eigenform conditions by taking linear combinations, but we won't attempt discussing this further. 
  \section{Applications of the Rankin-Selberg Method}
    \subsection*{The Ramanujan-Petersson Conjecture on Average}
      Let $f$ be a Hecke or Hecke-Maass eigenform. Using Rankin-Selberg convolutions, it is possible to show the weaker result that $a_{f}(n) \ll_{\e} n^{\e}$ holds on average without assuming the corresponding Ramanujan-Petersson conjecture:
      
      \begin{proposition}\label{prop:Ramanujan_Petersson_average}
        Let $f$ be a primitive Hecke or Hecke-Maass eigenform. Then for any $X > 0$, we have
        \[
        \sum_{n \le X}|a_{f}(n)| \ll_{\e} X^{1+\e},
        \]
      \end{proposition}
      \begin{proof}
        By the Cauchy-Schwarz inequality,
        \begin{equation}\label{equ:Ramanujan_conjecture_on_average_1}
          \left(\sum_{n \le X}|a_{f}(n)|\right)^{2} \le X\sum_{n \le X}|a_{f}(n)|^{2},
        \end{equation}
        The Rankin-Selberg square $L(s,f \ox f)$ is locally absolutely uniformly convergent for $\s > \frac{3}{2}$. Therefore it still admits meromorphic continuation to $\C$ with a simple pole at $s = 1$. By Landau's theorem, the abscissa of absolute convergence of $L(s,f \ox f)$, and hence $L(s,f \x f)$ too, is $1$ so by \cref{prop:Dirichlet_series_coefficient_size_on_average} we have
        \[
          \sum_{n \le X}|a_{f}(n)|^{2} \ll_{\e} X^{1+\e},
        \]
        for any $\e > 0$. Substituting this bound into \cref{equ:Ramanujan_conjecture_on_average_1}, we obtain
        \[
          \left(\sum_{n \le X}|a_{f}(n)|\right)^{2} \ll_{\e} X^{2+\e},
        \]
        and taking the square root yields
        \[
          \sum_{n \le X}|a_{f}(n)| \ll_{\e} X^{1+\e}.
        \]
      \end{proof}
      
      The bound in \cref{prop:Ramanujan_Petersson_average} should be compared with the implication $a_{f}(n) \ll_{\e} n^{\e}$ that follows from the corresponding Ramanujan-Petersson conjecture. While \cref{prop:Ramanujan_Petersson_average} is not useful in the holomorphic form case, it is in the Maass form case. Indeed, recall that if $f$ is a primitive Hecke-Maass eigenform we needed to assume the Ramanujan-Petersson conjecture for Maass forms to ensure $a_{f}(n) \ll_{\e} n^{\e}$ so that $L(s,f)$ was locally absolutely uniformly convergent for $\s > 1$. However, \cref{prop:Dirichlet_series_convergence_polynomial_bound_average,prop:Ramanujan_Petersson_average} now together imply $L(s,f)$ is locally absolutely uniformly convergent for $\s > 1$.
    \subsection*{Strong Multiplicity One}
      Let $f$ be a primitive Hecke or Hecke-Maass eigenform. Then $f$ is determined by Hecke eigenvalues at primes for fixed weight/type, and level. Using Rankin-Selberg convolutions, we can prove \textbf{strong multiplicity one}\index{strong multiplicity one} for holomorphic or Maass forms which says that $f$ is determined by Hecke eigenvalues at all but finitely many primes:

      \begin{theorem}[Strong multiplicity one, holomorphic and Maass versions]
        Let $f$ and $g$ both be primitive Hecke or Hecke-Maass eigenforms. Denote the Hecke eigenvalues by $\l_{f}(n)$ and $\l_{g}(n)$ respectively. If $\l_{f}(p) = \l_{g}(p)$ for all but finitely many primes $p$, then $f = g$.
      \end{theorem}
      \begin{proof}
        Let $S$ be the set the primes for which $\l_{f}(p) \neq \l_{g}(p)$ including the primes that ramify for $L(s,f)$ and $L(s,g)$. By assumption, $S$ is finite. As the local factors of $L(s,f \ox g)$ are holomorphic and nonzero at $s = 1$, the order of the pole of $L(s,f \ox g)$ is the same as the order of the pole of
        \[
          L(s,f \ox g)\prod_{p \in S}L_{p}(s,f \ox g)^{-1} = \prod_{p \notin S}L_{p}(s,f \ox g).
        \]
        But as $\l_{f}(p) = \l_{g}(p)$ for all $p \notin S$, we have
        \[
          \prod_{p \notin S}L_{p}(s,f \ox g) = \prod_{p \notin S}L_{p}(s,f \ox f),
        \]
        and so
        \[
          L(s,f \ox g)\prod_{p \in S}L_{p}(s,f \ox g)^{-1} = L(s,f \ox f)\prod_{p \in S}L_{p}(s,f \ox f)^{-1}.
        \]
        Since $L(s,f \ox f)$ has a simple pole at $s = 1$, it follows that $L(s,f \ox g)$ does too. But then $f = g$.
      \end{proof}