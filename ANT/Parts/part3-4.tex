\chapter{\texorpdfstring{$L$}{L}-functions of Number Fields}
  We introduce the $L$-functions attached to number fields known as Dedekind zeta functions. From the analytic properties of Dedekind zeta functions, we prove the infamous analytic class number formula and the Dirichlet class number formula. We then discuss Dedekind zeta functions attached to quadratic number fields in more detail and use the Dirichlet class number formula to deduce estimates for the class number of quadratic number fields.
  \section{Dedekind Zeta Functions}
    \subsection*{The Definition and Euler Product}
      We can associate and $L$-function to every number field. Let $K$ be a number field of degree $d$ and signature $(r_{1},r_{2})$. The \textbf{Dedekind zeta function}\index{Dedekind zeta function} $\z_{K}(s)$ is defined by the following Dirichlet series
      \[
        \z_{K}(s) = \sum_{n \ge 1}\frac{a_{K}(n)}{n^{s}}.
      \]
      We say $\z_{K}(s)$ is \textbf{quadratic}\index{quadratic}, \textbf{cubic}\index{cubic}, etc. if $K$ is. Similarly, we say $\z_{K}(s)$ is \textbf{cyclotomic}\index{cyclotomic} if $K$ is.

      \begin{remark}\label{rem:alternative_expression_for_Dirichlet_series_of_Dedekind_zeta_function}
        If we sum over integral ideals of $K$ instead, we can write
        \[
          \z_{K}(s) = \sum_{\text{$\mf{a}$ integral}}\frac{1}{\Norm_{K}(\mf{a})^{s}}.
        \]
      \end{remark}

      We will see that $\z_{K}(s)$ is a Selberg class $L$-function (note that $\z_{K}(s) = \z(s)$ when $d = 1$). We have already seen that the coefficients $a_{K}(n)$ are multiplicative and satisfy $a_{K}(n) \ll_{\e} n^{\e}$. By \cref{prop:Dirichlet_series_Euler_product}, $\z_{K}(s)$ is locally absolutely uniformly convergent for $\s > 1$ and admits the following infinite product expression:
      \[
        \z_{K}(s) = \prod_{p}\left(\sum_{n \ge 0}\frac{a_{K}(p^{n})}{p^{ns}}\right).
      \]
      Recall that each prime $\mf{p}$ lies above a prime $p$ and $\Norm_{K}(\mf{p})$ is a power of $p$. As the norm is multiplicative, the prime factorization of fractional ideals and \cref{rem:alternative_expression_for_Dirichlet_series_of_Dedekind_zeta_function} together imply that our infinite product can be expressed as
      \[
        \z_{K}(s) = \prod_{p}\prod_{\text{$\mf{p}$ above $p$}}(1-\Norm_{K}(\mf{p})^{-s})^{-1} = \prod_{p}\prod_{1 \le i \le r_{p}}(1-p^{-f_{p}(\mf{p}_{i})s})^{-1},
      \]
      where $r_{p}$ is the number of primes $\mf{p}_{1},\ldots,\mf{p}_{r_{p}}$ above $p$. Letting $\w_{p,i}$ be a primitive $f_{p}(\mf{p}_{i})$-th root of unity, we have a factorization
      \[
        1-p^{-f_{p}(\mf{p}_{i})s} = \prod_{1 \le k \le f_{p}(\mf{p}_{i})}(1-\w_{p,i}^{k}p^{-s}),
      \]
      for all $i$. As finitely many primes ramify (because only those dividing $|\D_{K}|$ do), the fundamental equality implies that all but finitely many primes $p$ satisfy
      \[
        d = \sum_{1 \le i \le r_{p}}f_{p}(\mf{p}_{i}).
      \]
      In particular, at least one prime does. Therefore, we have the following degree $d$ Euler product:
      \[
        \z_{K}(s) = \prod_{p}\prod_{\substack{1 \le i \le r_{p} \\ 1 \le k \le f_{p}(\mf{p}_{i})}}(1-\w_{p,i}^{k}p^{-s})^{-1}.
      \]
      The local factor at $p$ is
      \[
        \z_{K,p}(s) = \prod_{\substack{1 \le i \le r_{p} \\ 1 \le k \le f_{p}(\mf{p}_{i})}}(1-\w_{p,i}^{k}p^{-s})^{-1},
      \]
      with local roots $\w_{p,i}^{k}$ and $\sum_{1 \le i \le r_{p}}(e_{p}(\mf{p}_{i})-1)f_{p}(\mf{p}_{i})$ many local roots $0$.
    \subsection*{The Integral Representation: Part I}
      We will find an integral representation for $\z_{K}(s)$. To do this, let $\s$ run over $\Hom_{\Q}(K,\conj{\Q})$ and let $\tau$ run over a complete set of representatives for the real and pairs of complex $\Q$-embeddings. Also recall that $N_{\tau} = 1,2$ depending upon if $\tau$ is real or complex. It will be useful to let
      \[
        \mathbf{N} = (N_{\tau})_{\tau}, \quad \mathbf{N}^{\vee} = (3-N_{\tau})_{\tau}, \quad \boldsymbol{\a} = (|\tau(\a)|)_{\tau},  \quad \text{and} \quad \boldsymbol{j(\a)} = (|\s(\a)|)_{\s},
      \]
      for all $\a \in K$. With this notation,
      \[
        \boldsymbol{\a}^{\mathbf{N}} = |\Norm_{K}(\a)|.
      \]
      Now consider the function
      \[
        \w_{K}(\mathbf{z}) = \sum_{n \ge 1}a_{K}(n)e^{\pi in^{\frac{2}{d}}\<\mathbf{z},\mathbf{N}\>},
      \]
      defined for $\mathbf{z} \in \H^{r_{K}+1}$. It is locally absolutely uniformly convergent in this region by the Weierstrass $M$-test. Taking $\e < 1$, the bound $a_{K}(n) \ll_{\e} n^{\e}$ gives
      \[
        \w_{K}(\mathbf{z}) = O\left(\sum_{n \ge 1}n^{r_{2}+1}e^{-\pi n^{\frac{2}{d}}||\mathbf{y}||_{\infty}}\right) = O(e^{-\pi||\mathbf{y}||_{\infty}}),
      \]
      where the second equality holds because each term is of smaller order than the next so that the series is bounded by a constant times the first term. Hence $\w_{K}(\mathbf{z})$ exhibits exponential decay. Now consider the following Mellin transform:
      \[
        \int_{\R_{+}^{r_{K}+1}}\w_{K}(i\mathbf{y})\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}}.
      \]
      By the exponential decay of $\w_{K}(\mathbf{z})$, this integral is locally absolutely uniformly convergent for $\s > 1$ and hence defines an analytic function there. Then we compute
      \begin{align*}
        \int_{\R_{+}^{r_{K}+1}}\w_{K}(i\mathbf{y})\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}} &= \int_{\R_{+}^{r_{K}+1}}\sum_{n \ge 1}a_{K}(n)e^{-\pi n^{\frac{2}{d}}\<\mathbf{y},\mathbf{N}\>}\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}} \\
        &= \sum_{n \ge 1}\int_{\R_{+}^{r_{K}+1}}a_{K}(n)e^{-\pi n^{\frac{2}{d}}\<\mathbf{y},\mathbf{N}\>}\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}} && \text{FTT} \\
        &= \sum_{n \ge 1}\frac{a_{K}(n)}{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}n^{s}}\int_{\R_{+}^{r_{K}+1}}e^{-\<\mathbf{y},\mathbf{1}\>}\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}} && \text{$\mathbf{y} \mapsto \frac{\mathbf{y}}{\mathbf{N}\pi n^{\frac{2}{d}}}$} \\
        &= \frac{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}\sum_{n \ge 1}\frac{a_{K}(n)}{n^{s}} \\
        &= \frac{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}\z_{K}(s).
      \end{align*}
      Therefore we have an integral representation
      \[
        \z_{K}(s) = \frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\int_{\R_{+}^{r_{K}+1}}\w_{K}(i\mathbf{y})\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}}.
      \]
      We will manipulate the remaining integral to write it as a different Mellin transform. This will take a fair amount of work. As $\w_{K}(\mathbf{z})$ converges absolutely we may sum over integral ideals of $K$ and obtain
      \[
        \int_{\R_{+}^{r_{K}+1}}\sum_{\text{$\mf{a}$ integral}}e^{\pi i\Norm_{K}(\mf{a})^{\frac{2}{d}}\<i\mathbf{y},\mathbf{N}\>}\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}}.
      \]
      Now if $\mf{a}$ is an integral ideal then $\mc{O}_{K}^{\ast}$ acts on $\mf{a}-\{0\}$ by multiplication. Therefore we have an orbit space $(\mf{a}-\{0\})/\mc{O}_{K}^{\ast}$. The following lemma establishes a bijection between this orbit space and integral ideals in an ideal class:

      \begin{lemma}\label{lem:Hecke_theta_function_lemma}
        Let $K$ be a number field. Suppose $\mf{a}$ is an integral ideal and $\mf{K}$ is the ideal class of $\mf{a}^{-1}$. Then there is a bijection
        \[
          (\mf{a}-\{0\})/\mc{O}_{K}^{\ast} \to \{\mf{b} \in \mf{K}:\text{$\mf{b}$ is an integral ideal}\} \qquad \a \mapsto \a\mf{a}^{-1}.
        \]
      \end{lemma}
      \begin{proof}
        We first show that this map is well-defined. If $\a \in \mf{a}$ is nonzero then $\a\mf{a}^{-1} = \a\mc{O}_{K}\mf{a}^{-1} \subseteq \mc{O}_{K}$ by \cref{prop:explicit_inverse_ideal} so that $\a\mf{a}^{-1}$ is an integral ideal belonging to $\mf{K}$ (because it differs from $\mf{a}^{-1}$ by a principal ideal). Therefore the map is well-defined. To show injectivity, suppose $\a\mf{a}^{-1} = \b\mf{a}^{-1}$ for some $\a,\b \in (\mf{a}-\{0\})/\mc{O}_{K}^{\ast}$. Multiplying by $\mf{a}$, we obtain $\a\mc{O}_{K} = \b\mc{O}_{K}$ and hence $\a\b^{-1} \in \mc{O}_{K}^{\ast}$ from which injectivity follows. For surjectivity, the definition of $\mf{K}$ implies that any integral ideal $\mf{b} \in \mf{K}$ satisfies $\mf{b} = \a\mf{a}^{-1}$ for some nonzero $\a \in \mc{O}_{K}$ but then $\a \in \mf{a}\mf{b} \subseteq \mf{a}$.
      \end{proof}

       By Minkowski theorem, any ideal class is can be represented by an integral ideal $\mf{a}$. So let $\mf{a}_{1},\ldots,\mf{a}_{h_{K}}$ be a complete set of representatives of $\Cl(K)$ consisting only of integral ideals. As the ideal class group is a group, we see that $\mf{a}_{1}^{-1},\ldots,\mf{a}_{h_{K}}^{-1}$ is also a complete set of representatives. By \cref{lem:Hecke_theta_function_lemma}, this shows that every integral ideal is uniquely of the form $\a\mf{a}_{i}^{-1}$ for some $1 \le i \le h_{K}$ and $\a \in \mf{a}_{i}^{\ast}/\mc{O}_{K}^{\ast}$ and thus has norm $\Norm_{K}(\a\mf{a}_{i}^{-1})$. Then we may further rewrite our integral as
      \[
        \sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in (\mf{a}-\{0\})/\mc{O}_{K}^{\ast}}\int_{\R_{+}^{r_{K}+1}}e^{\pi i\Norm_{K}(\a\mf{a}^{-1})^{\frac{2}{d}}\<i\mathbf{y},\mathbf{N}\>}\mathbf{y}^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}},
      \]
      where we have interchange the two sums and integral by the Fubiniâ€“Tonelli theorem. Now perform the change of variables $\mathbf{y} \mapsto \boldsymbol{\a}^{2}\mathbf{y}$ to obtain
      \[
        \sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in (\mf{a}-\{0\})/\mc{O}_{K}^{\ast}}\int_{\R_{+}^{r_{K}+1}}e^{\pi i\Norm_{K}(\a\mf{a}^{-1})^{\frac{2}{d}}\<\boldsymbol{\a}^{2}i\mathbf{y},\mathbf{N}\>}(\boldsymbol{\a}^{2}\mathbf{y})^{\frac{s\mathbf{N}}{2}}\,\frac{d\mathbf{y}}{\mathbf{y}}.
      \]
      We will now alter the region of integration. Observe that any $\mathbf{y} \in \R_{+}^{r_{K}+1}$ can be written in the form
      \[
        \mathbf{y} = y^{\frac{1}{d}}\mathbf{x},
      \]
      where
      \[
        y = \Norm_{\R^{r_{K}+1}/\R}(\mathbf{y})^{\frac{d}{r_{K}+1}} \quad \text{and} \quad \mathbf{x} = \frac{\mathbf{y}}{\Norm_{\R^{r_{K}+1}/\R}(\mathbf{y})^{\frac{1}{r_{K}+1}}}.
      \]
      Therefore $\R_{+}^{r_{K}+1}$ decomposes as
      \[
        \R_{+}^{r_{K}+1} = (0,\infty) \x S,
      \]
      where $S$ is the norm-one hypersurface of $\R^{r_{K}+1}$. As $S$ is a multiplicative subgroup of $\R_{+}^{r_{K}+1}$, the measure $\frac{d\mathbf{y}}{\mathbf{y}}$ on $\R_{+}^{r_{K}+1}$ factors as
      \[
        \frac{d\mathbf{y}}{\mathbf{y}} = \frac{d\mathbf{x}\,dy}{y},
      \]
      where $d\mathbf{x}$ (which can also be written as $\frac{d\mathbf{x}}{\mathbf{x}}$ because $\mathbf{x} \in S$) is the restriction of the measure $\frac{d\mathbf{y}}{\mathbf{y}}$ to $S$. Therefore our expression takes the form
      \[
        \sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in (\mf{a}-\{0\})/\mc{O}_{K}^{\ast}}\int_{0}^{\infty}\int_{S}e^{\pi i\Norm_{K}(\a\mf{a}^{-1})^{\frac{2}{d}}\left\<\boldsymbol{\a}^{2}iy^{\frac{1}{d}}\mathbf{x},\mathbf{N}\right\>}\boldsymbol{\a}^{s\mathbf{N}}y^{\frac{s}{2}}\,\frac{d\mathbf{x}\,dy}{y}.
      \]
      Now consider the inverse isomorphisms
      \[
        \log:\R_{+}^{r_{K}+1} \to \R^{r_{K}+1} \qquad \text{and} \quad e:\R^{r_{K}+1} \to \R_{+}^{r_{K}+1}.
      \]
      In particular, they restricts to inverse bijections between the norm-one hypersurface $S$ and the trace-zero hyperplane $H$ ($\log(S) = H$ and $e^{H} = S$). By Dirichlet's unit theorem, $\mathbf{N}^{\vee}\L$ is a complete lattice in $H$ and therefore has fundamental domain $\mathbf{N}^{\vee}\mc{M}$ where $\mc{M}$ is a fundamental domain for $\L$. Then
      \[
        H = \bigcup_{\l \in \L}(\mathbf{N}^{\vee}\mc{M}+\mathbf{N}^{\vee}\l).
      \]
      Setting $\mc{F} = e^{\mathbf{N}^{\vee}\mc{M}}$, we see that $\mc{F}$ is a fundamental domain for the properly discontinuous action of $\L$ on $S$ by multiplication by $e^{\mathbf{N}^{\vee}\l}$ for all $\l \in \L$. In particular,
      \[
        S = \bigcup_{\l \in \L}e^{\mathbf{N}^{\vee}\l}\mc{F}.
      \]
      By \cref{prop:exact_sequence_for_Dirichlets_unit_theorem}, we may express this decomposition as
      \[
        S = \bigcup_{\e \in \mc{O}_{K}^{\ast}/\mu(K)}e^{\mathbf{N}^{\vee}\l(\e)}\mc{F}.
      \]
      Then folding yields
      \[
        \frac{1}{w_{K}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in (\mf{a}-\{0\})/\mc{O}_{K}^{\ast}}\sum_{\e \in \mc{O}_{K}^{\ast}}\int_{0}^{\infty}\int_{\mc{F}}e^{\pi i\Norm_{K}(\a\mf{a}^{-1})^{\frac{2}{d}}\left\<\boldsymbol{\a}^{2}e^{\mathbf{N}^{\vee}\l(\e)}iy^{\frac{1}{d}}\mathbf{x},\mathbf{N}\right\>}\boldsymbol{\a}^{s\mathbf{N}}y^{\frac{s}{2}}\,\frac{d\mathbf{x}\,dy}{y},
      \]
      because $e^{\mathbf{N}^{\vee}\l(\e)} = \mathbf{1}$ if $\e \in \mu(K)$ and we have interchanged the sum and integrals by the Fubiniâ€“Tonelli theorem. As $\boldsymbol{\e}^{\mathbf{N}} = |\Norm_{K}(\e)| = 1$ and $\Norm_{K}(\e) = \pm1$ for all $\e \in \mc{O}_{K}^{\ast}$, we can use multiplicativity of the norm and \cref{prop:norm_and_field_norms_are_identical} to write our expression as
      \[
        \frac{1}{w_{K}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in (\mf{a}-\{0\})/\mc{O}_{K}^{\ast}}\sum_{\e \in \mc{O}_{K}^{\ast}}\int_{0}^{\infty}\int_{\mc{F}}e^{\pi i\Norm_{K}(\a\e\mf{a}^{-1})^{\frac{2}{d}}\left\<\boldsymbol{\a}^{2}e^{\mathbf{N}\l(\e)}iy^{\frac{1}{d}}\mathbf{x},\mathbf{N}\right\>}(\boldsymbol{\a}\boldsymbol{\e})^{s\mathbf{N}}y^{\frac{s}{2}}\,\frac{d\mathbf{x}\,dy}{y}.
      \]
      By the definitions of $\l$ and $\mathbf{N}^{\vee}$, we have $\boldsymbol{\a}^{2}e^{\mathbf{N}\l(\e)} = (\boldsymbol{\a\e})^{2}$ and therefore we may combine the innermost two sums to obtain
      \[
        \frac{1}{w_{K}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in \mf{a}-\{0\}}\int_{0}^{\infty}\int_{\mc{F}}e^{\pi i\Norm_{K}(\a\mf{a}^{-1})^{\frac{2}{d}}\left\<\boldsymbol{\a}^{2}iy^{\frac{1}{d}}\mathbf{x},\mathbf{N}\right\>}\boldsymbol{\a}^{s\mathbf{N}}y^{\frac{s}{2}}\,\frac{d\mathbf{x}\,dy}{y}.
      \]
      Performing the change of variables $y \mapsto \frac{y}{\boldsymbol{\a}^{2\mathbf{N}}}$ gives
      \[
        \frac{1}{w_{K}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{\a \in \mf{a}-\{0\}}\int_{0}^{\infty}\int_{\mc{F}}e^{\pi i\Norm_{K}(\mf{a}^{-1})^{\frac{2}{d}}\left\<\boldsymbol{\a}^{2}iy^{\frac{1}{d}}\mathbf{x},\mathbf{N}\right\>}y^{\frac{s}{2}}\,\frac{d\mathbf{x}\,dy}{y},
      \]
      Interchanging the the two integrals with the two sums by the Fubiniâ€“Tonelli theorem and noting that $\<\mathbf{N},\boldsymbol{\a}^{2}\> = \<\boldsymbol{j(\a)},\boldsymbol{j(\a)}\>$, our expression becomes
      \[
        \int_{0}^{\infty}\int_{\mc{F}}\frac{1}{w_{K}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{j(\a) \in j(\mf{a})-\{\mathbf{0}\}}e^{\pi i\Norm_{K}(\mf{a}^{-1})^{\frac{2}{d}}\left\<iy^{\frac{1}{d}}\mathbf{x}\boldsymbol{j(\a)},\boldsymbol{j(\a)}\right\>}y^{\frac{s}{2}}\,\frac{d\mathbf{x}\,dy}{y}.
      \]
      We compactly express this as
      \[
        \int_{0}^{\infty}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y},
      \]
      where we have defined $\w_{\mc{F}}(z)$ by
      \[
        \w_{\mc{F}}(z) = \int_{\mc{F}}\frac{1}{w_{K}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sum_{j(\a) \in j(\mf{a})-\{\mathbf{0}\}}e^{\pi i\Norm_{K}(\mf{a}^{-1})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a)},\boldsymbol{j(\a)}\>}\,d\mathbf{x},
      \]
      for $z \in \H$. It is locally absolutely uniformly convergent in this region by the Weierstrass $M$-test and that $\mc{F}$ is compact (because $\mathbf{N}^{\vee}\mc{M}$ is and $\log(\mathbf{x})$ is continuous). At last, this gives a final integral representation
      \begin{equation}\label{equ:integral_representation_Dedekind_1}
        \z_{K}(s) = \frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\int_{0}^{\infty}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y},
      \end{equation}
      where the integral is a Mellin transform. We cannot proceed until we obtain a functional equation for $\w_{\mc{F}}(z)$. So we will make a detour and come back to the integral representation after.
    \subsection*{The Hecke Theta Function}
      The \textbf{Hecke theta function}\index{Hecke theta function} $\vt_{\mf{f}}(z\mathbf{x})$ attached to a fractional ideal $\mf{f}$ of $K$, is defined by
      \[
        \vt_{\mf{f}}(z\mathbf{x}) = \sum_{j(\a) \in j(\mf{f})}e^{2\pi i\Norm_{K}(\mf{f}^{-1})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a)},\boldsymbol{j(\a)}\>},
      \]
      for $z \in \H$ and $\mathbf{x} \in S$. It is locally absolutely uniformly convergent in this region by the Weierstrass $M$-test. Moreover,
      \[
        \vt_{\mf{f}}(z\mathbf{x})-1 = O\left(\sum_{j(\a) \in j(\mf{f})-\{\mathbf{0}\}}e^{-2\pi y||\mathbf{x}||_{\infty}\Norm_{K}(\mf{f}^{-1})^{\frac{2}{d}}\<\boldsymbol{j(\a)},\boldsymbol{j(\a)}\>}\right) = O(e^{-2\pi y||\mathbf{x}||_{\infty}}),
      \]
      where the second equality follows since $\<\boldsymbol{j(\a)},\boldsymbol{j(\a)}\> \ge d|\Norm_{K}(\a)|^{\frac{2}{d}}$ by the arithmetic-geometric inequality provided $\a$ is nonzero, and that $|\Norm_{K}(\a)|\Norm_{K}(\mf{f})$ is a positive integer for all nonzero $\a \in \mf{f}$ (as $\a\mf{f}^{-1}$ is an integral ideal by \cref{prop:explicit_inverse_ideal}), which combined show that each term is of smaller order than the single term where $\Norm_{K}(\a\mf{f}^{-1}) = 1$ (when $\a\mf{f}^{-1} = \mc{O}_{K}$) corresponding to $\a = \Norm_{K}(\mf{f})$ so that the sum is bounded by a constant times this term. The relationship to $\w_{\mc{F}}(z)$ is given by
      \[
        \w_{\mc{F}}(z) = \frac{1}{w_{K}}\int_{\mc{F}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\vt_{\mf{a}}\left(\frac{z\mathbf{x}}{2}\right)\,d\mathbf{x}-\frac{h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x}.
      \]
      The essential fact we will need is a functional equation for the Hecke theta function:

      \begin{theorem}\label{thm:functional_equation_Hecke_theta}
        Let $K$ be a number field of degree $d$ and let $\mf{f}$ be a fractional ideal. For any $z \in \H$ and $\mathbf{x} \in S$,
        \[
          \vt_{\mf{f}}(z\mathbf{x}) = \frac{1}{(-2|\D_{K}|^{\frac{1}{d}}iz)^{\frac{d}{2}}}\vt_{\mf{f}^{\vee}}\left(-\frac{\mathbf{x}}{4|\D_{K}|^{\frac{2}{d}}z}\right).
        \]
      \end{theorem}
      \begin{proof}
        We will apply the Poisson summation formula to
        \[
          \vt_{\mf{f}}(z\mathbf{x}) = \sum_{j(\a) \in j(\mf{f})}e^{2\pi i\Norm_{K}(\mf{f}^{-1})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a)},\boldsymbol{j(\a)}\>}.
        \]
        To do this, we compute the Fourier transform of the summand and by the identity theorem it suffices to verify this for $z = iy$ with $y > 0$ and $\mathbf{x} = \mathbf{1}$. So set
        \[
          f(\mathbf{x}) = e^{-2\pi y\Norm_{K}(\mf{f}^{-1})^{\frac{2}{d}}\<\mathbf{x},\mathbf{x}\>}.
        \]
        Then $f(\mathbf{x})$ is of Schwarz class. By \cref{cor:Fourier_transform_of_exponential_single_variable} and multiplicativity of the norm, we have
        \[
          (\mc{F}f)(\mathbf{t}) = \Norm_{K}(\mf{f})\frac{e^{-\frac{\pi\Norm_{K}(\mf{f})^{\frac{2}{d}}\<\mathbf{t},\mathbf{t}\>}{2y}}}{(2y)^{\frac{d}{2}}}.
        \]
        By the Poisson summation formula and the identity theorem, we compute
        \begin{align*}
          \vt_{\mf{f}}(z\mathbf{x}) &= \sum_{j(\a) \in j(\mf{f})}e^{2\pi i\Norm_{K}(\mf{f}^{-1})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a)},\boldsymbol{j(\a)}\>} \\
          &= \frac{1}{V_{j(\mf{f})}}\sum_{\a^{\vee} \in \mf{f}^{\vee}}\Norm_{K}(\mf{f})\frac{e^{-\frac{\pi\Norm_{K}(\mf{f})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a^{\vee})},\boldsymbol{j(\a^{\vee})}\>}{-2iz}}}{(-2iz)^{\frac{d}{2}}} \\
          &= \frac{1}{\Norm_{K}(\mf{f})\sqrt{|\D_{K}|}}\sum_{\a^{\vee} \in \mf{f}^{\vee}}\Norm_{K}(\mf{f})\frac{e^{-\frac{\pi\Norm_{K}(\mf{f})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a^{\vee})},\boldsymbol{j(\a^{\vee})}\>}{-2iz}}}{(-2iz)^{\frac{d}{2}}} && \text{\cref{prop:covolume_of_fractional_ideal_under_j}} \\
          &= \frac{1}{(-2|\D_{K}|^{\frac{1}{d}}iz)^{\frac{d}{2}}}\sum_{\a^{\vee} \in \mf{f}^{\vee}}e^{-\frac{\pi\Norm_{K}(\mf{f})^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a^{\vee})},\boldsymbol{j(\a^{\vee})}\>}{-2iz}} \\
          &= \frac{1}{(-2|\D_{K}|^{\frac{1}{d}}iz)^{\frac{d}{2}}}\sum_{\a^{\vee} \in \mf{f}^{\vee}}e^{-\frac{\pi\left(\Norm\left((\mf{f}^{\vee})^{-1}\right)|\D|_{K}^{-1}\right)^{\frac{2}{d}}\<z\mathbf{x}\boldsymbol{j(\a^{\vee})},\boldsymbol{j(\a^{\vee})}\>}{-2iz}} && \text{\cref{cor:norm_of_different}} \\
          &= \frac{1}{(-2|\D_{K}|^{\frac{1}{d}}iz)^{\frac{d}{2}}}\sum_{\a^{\vee} \in \mf{f}^{\vee}}e^{2\pi i\Norm\left((\mf{f}^{\vee})^{-1}\right)^{\frac{2}{d}}\left\<\left(-\frac{\mathbf{x}}{4|\D_{K}|^{\frac{2}{d}}z}\right)\boldsymbol{j(\a)},\boldsymbol{j(\a)}\right\>} \\
          &= \frac{1}{(-2|\D_{K}|^{\frac{1}{d}}iz)^{\frac{d}{2}}}\vt_{\mf{f}^{\vee}}\left(-\frac{\mathbf{x}}{4|\D_{K}|^{\frac{2}{d}}z}\right).
        \end{align*}
      \end{proof}

      We will use \cref{thm:functional_equation_Hecke_theta} to analytically continue $\z_{K}(s)$.
    \subsection*{The Integral Representation: Part II}
      Returning to $\z_{K}(s)$, split the integral in \cref{equ:integral_representation_Dedekind_1} into two pieces by writing
      \begin{equation}\label{equ:symmetric_integral_Dedekind_L-functions_split}
        \int_{0}^{\infty}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y} = \int_{0}^{\frac{1}{|\D_{K}|}}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y}+\int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y}.
      \end{equation}
      We will rewrite the first piece in the same form and symmetrize the result as much as possible. Perform the change of variables $y \mapsto \frac{1}{|\D_{K}|^{2}y}$ to the first piece to obtain
      \[
        \int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}\left(\frac{i}{(|\D_{K}|^{2}y)^{\frac{1}{d}}}\right)(|\D_{K}|^{2}y)^{-\frac{s}{2}}\,\frac{dy}{y}.
      \]
      Now we compute
      \begin{align*}
        \w_{\mc{F}}\left(\frac{i}{(|\D_{K}|^{2}y)^{\frac{1}{d}}}\right) &= \w_{\mc{F}}\left(-\frac{1}{|\D_{K}|^{\frac{2}{d}}iy^{\frac{1}{d}}}\right) \\
        &= \frac{1}{w_{K}}\int_{\mc{F}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\vt_{\mf{a}}\left(-\frac{\mathbf{x}}{2|\D_{K}|^{\frac{2}{d}}iy^{\frac{1}{d}}}\right)d\mathbf{x}-\frac{h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x} \\
        &= \frac{1}{w_{K}}\int_{\mc{F}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\sqrt{|\D_{K}|y}\vt_{\mf{a}}\left(\frac{iy^{\frac{1}{d}}\mathbf{x}}{2}\right)d\mathbf{x}-\frac{h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x} && \text{\cref{thm:functional_equation_Hecke_theta}} \\
        &= \frac{\sqrt{|\D_{K}|y}}{w_{K}}\int_{\mc{F}}\sum_{\substack{\mf{a} \in \Cl(K) \\ \text{$\mf{a}$ integral}}}\vt_{\mf{a}}\left(\frac{iy^{\frac{1}{d}}\mathbf{x}}{2}\right)d\mathbf{x}-\frac{h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x} \\
        &= \sqrt{|\D_{K}|y}\w_{\mc{F}}(iy^{\frac{1}{d}})+\frac{\sqrt{|\D|_{K}y}h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x}-\frac{h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x}.
      \end{align*}
      This chain implies that our first piece can be expressed as
      \[
        \int_{\frac{1}{|\D_{K}|}}^{\infty}\left(\sqrt{|\D_{K}|y}\w_{\mc{F}}(iy^{\frac{1}{d}})+\frac{\sqrt{|\D|_{K}y}h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x}-\frac{h_{K}}{w_{K}}\int_{\mc{F}}\,d\mathbf{x}\right)(|\D_{K}|^{2}y)^{-\frac{s}{2}}\,\frac{dy}{y},
      \]
      which is further equivalent to
      \[
        |\D_{K}|^{\frac{1}{2}-s}\int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}(iy^{\frac{1}{d}})y^{\frac{1-s}{2}}\,\frac{dy}{y}-\frac{2h_{K}}{\w_{K}\sqrt{|\D|_{K}}s(1-s)}\int_{\mc{F}}\,d\mathbf{x},
      \]
      since, upon interchanging the integrals in the last two pieces by the Fubiniâ€“Tonelli theorem, the inner integrals are $\frac{2}{\sqrt{|\D|_{K}}(1-s)}-\frac{2}{\sqrt{|\D|_{K}}s} = -\frac{2}{\sqrt{|\D|_{K}}s(1-s)}$. Substituting this expression back into \cref{equ:symmetric_integral_Dedekind_L-functions_split} and combining with \cref{equ:integral_representation_Dedekind_1} gives the integral representation
      \begin{align*}
        \z_{K}(s) &= \frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\Bigg[-\frac{2h_{K}}{\w_{K}\sqrt{|\D|_{K}}s(1-s)}\int_{\mc{F}}\,d\mathbf{x}+|\D_{K}|^{\frac{1}{2}-s}\int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}(iy^{\frac{1}{d}})y^{\frac{1-s}{2}}\,\frac{dy}{y} \\
        &+ \int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y}\Bigg].
      \end{align*}
      It remains to compute the first integral on the right-hand side. The following lemma gives the result:

      \begin{lemma}\label{lem:integral_of_fundamental_domain_for_norm-one_hypersurface}
        Let $K$ be a number field of signature $(r_{1},r_{2})$ and set $\mc{F} = e^{\mathbf{N}^{\vee}\mc{M}}$ where $\mc{M}$ is a fundamental domain for $\L$ in the trace-zero hyperplane $H$. Then
        \[
          \int_{\mc{F}}\,d\mathbf{x} = 2^{r_{1}-1}R_{K}.
        \]
      \end{lemma}
      \begin{proof}
        Let $d$ be the degree of $K$. Begin by observing that
        \[
          \int_{\mc{F}}\,d\mathbf{x} \int_{1}^{\e}\int_{\mc{F}}\,\frac{d\mathbf{x}\,dy}{y} = \int_{[1,e] \x \mc{F}}\,\frac{d\mathbf{y}}{\mathbf{y}},
        \]
        in view of the decomposition $\R_{+}^{r_{K}+1} = (0,\infty) \x S$ with $\mathbf{y} = y^{\frac{1}{d}}\mathbf{x}$ and $\frac{d\mathbf{y}}{\mathbf{y}} = \frac{d\mathbf{x}\,dy}{y}$. Under the change of variables $\mathbf{y} \to e^{2\mathbf{y}}$, we obtain
        \[
          2^{r_{K}+1}\int_{\left[0,\frac{1}{2}\right] \x \frac{\mc{M}}{\mathbf{N}}}\,d\mathbf{y},
        \]
        because the absolute value of the determinant of the Jacobian matrix is $2^{r_{K}+1}e^{\<\mathbf{y},\mathbf{1}\>}$. The remaining integral is just a $2^{-(r_{2+1})}$ multiple of the volume of $\mc{M}$. Letting $\e_{1},\ldots,\e_{r_{K}}$ be a system of fundamental units for $K$, Dirichlet's unit theorem implies that $\l(\e_{1}),\ldots,\l(\e_{r_{K}})$ is a basis for $\L$. Then by \cref{prop:covolume_equals_volume_of_fundamental_domain}, the volume of $\mc{M}$ is just the absolute value of the determinant of the generator matrix $P$ for $\l(\e_{1}),\ldots,\l(\e_{r_{K}})$. But this is $R_{K}$ by definition of the regulator. It follows that our last expression evaluates to $2^{r_{1}-1}R_{K}$ as claimed.
      \end{proof}

      From \cref{lem:integral_of_fundamental_domain_for_norm-one_hypersurface}, we obtain the integral representation
      \begin{equation}\label{equ:integral_representation_Dedekind_final}
        \begin{aligned}
          \z_{K}(s) &= \frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\Bigg[-\frac{2^{r_{1}}h_{K}R_{K}}{\w_{K}\sqrt{|\D|_{K}}s(1-s)}+|\D_{K}|^{\frac{1}{2}-s}\int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}(iy^{\frac{1}{d}})y^{\frac{1-s}{2}}\,\frac{dy}{y} \\
          &+ \int_{\frac{1}{|\D_{K}|}}^{\infty}\w_{\mc{F}}\left(iy^{\frac{1}{d}}\right)y^{\frac{s}{2}}\,\frac{dy}{y}\Bigg].
        \end{aligned}
      \end{equation}
      This integral representation will give analytic continuation. Indeed, everything outside the brackets is entire. The integrands exhibit exponential decay and therefore are locally absolutely uniformly convergent on $\C$. The fractional term is holomorphic except for simple poles at $s = 0$ and $s = 1$. The meromorphic continuation to $\C$ follows with possible simple poles at $s = 0$ and $s = 1$. Actually, there is no pole at $s = 0$. To see this, observe that $\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}$ has at least a simple pole at $s = 0$ (since $r_{1}$ or $r_{2}$ is positive) and so its reciprocal has at least a simple zero. This cancels the corresponding simple pole of $-\frac{2^{r_{1}}h_{K}R_{K}}{\w_{K}s(1-s)}$ so that $\z_{K}(s)$ has a removable singularity and thus is holomorphic at $s = 0$. At $s = 1$, $\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}$ is nonzero and so $\z_{K}(s)$ has a simple pole. Therefore $\z_{K}(s)$ has meromorphic continuation to all of $\C$ with a simple pole at $s = 1$. 
    \subsection*{The Functional Equation}
      An immediate consequence of applying the symmetry $s \mapsto 1-s$ to \cref{equ:integral_representation_Dedekind_final} is the following functional equation:
      \[
        |\D_{K}|^{\frac{s}{2}}\frac{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}\z_{K}(s) = |\D_{K}|^{\frac{1-s}{2}}\frac{\G\left(\frac{(1-s)}{2}\right)^{r_{1}}\G\left(1-s\right)^{r_{2}}}{\pi^{\frac{r_{1}(1-s)}{2}}(2\pi)^{r_{2}(1-s)}}\z_{K}(1-s).
      \]
      Using the Legendre duplication formula, we see that
      \begin{align*}
        \frac{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}} &= \frac{1}{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}2^{r_{2}(1-s)}\pi^{\frac{r_{2}}{2}}}\G\left(\frac{s}{2}\right)^{r_{1}+r_{2}}\G\left(\frac{s+1}{2}\right)^{r_{2}} \\
        &= \frac{1}{2^{r_{2}}\pi^{\frac{ds}{2}+\frac{r_{2}}{2}}}\G\left(\frac{s}{2}\right)^{r_{1}+r_{2}}\G\left(\frac{s+1}{2}\right)^{r_{2}} \\
        &= \frac{1}{2^{r_{2}}\pi^{\frac{r_{2}}{2}}}\pi^{-\frac{ds}{2}}\G\left(\frac{s}{2}\right)^{r_{1}+r_{2}}\G\left(\frac{s+1}{2}\right)^{r_{2}}.
      \end{align*}
      The constant factor in front is independent of $s$ and so can be canceled in the functional equation. Therefore we identify the gamma factor to be
      \[
        \g(s,\z_{K}) = \pi^{-\frac{ds}{2}}\G\left(\frac{s}{2}\right)^{r_{1}+r_{2}}\Gamma\left(\frac{s+1}{2}\right)^{r_{2}},
      \]
      with $\k_{i} = 0$ for $1 \le i \le r_{1}+r_{2}$ and $\k_{i} = 1$ for $r_{1}+r_{2}+1 \le i \le d$ the local roots at infinity. Clearly these satisfy the required bounds. The conductor is $q(\z_{K}) = |\D_{K}|$ and so $p$ is ramified if and only if it is ramified in $\mc{O}_{K}/\Z$. Note that if $p$ is unramified then $\sum_{1 \le i \le r_{p}}(e_{p}(\mf{p}_{i})-1)f_{p}(\mf{p}_{i}) = 0$ so that all local roots are of the form $\w_{p,i}^{k} \neq 0$. The completed Dedekind zeta function is
      \[
        \L(s,\z_{K}) = |\D_{K}|^{\frac{s}{2}}\pi^{-\frac{ds}{2}}\G\left(\frac{s}{2}\right)^{r_{1}+r_{2}}\Gamma\left(\frac{s+1}{2}\right)^{r_{2}}\z_{K}(s),
      \]
      with functional equation
      \[
        \L(s,\z_{K}) = \L(1-s,\z_{K}).
      \]
      This is the function equation of $\z_{K}(s)$ and from it we see that the root number is $\e(\z_{K}) = 1$ and that $\z_{K}(s)$ is self-dual. To see that the order is $1$, multiply by $(s-1)$ to clear the polar divisor. As the integrals in \cref{equ:integral_representation_Dedekind_final} are locally absolutely uniformly convergent, computing the order amounts to estimating the gamma factor. And because the reciprocal of the gamma function is of order $1$, we have
      \[
        \frac{1}{\g(s,\z_{K})} \ll_{\e} e^{|s|^{1+\e}}.
      \]
      Therefore the reciprocal of the gamma factor is also of order $1$ and it follows that
      \[
        (s-1)\z_{K}(s) \ll_{\e} e^{|s|^{1+\e}}.
      \]
      This shows $(s-1)\z_{K}(s)$ is of order $1$ and hence $\z_{K}(s)$ is too after removing the polar divisor. It now remains to compute the residue of $\z_{K}(s)$ at $s = 1$. This result is known as the \textbf{analytic class number formula}\index{analytic class number formula}:

      \begin{theorem*}[Analytic class number formula]
        Let $K$ be a number field of signature $(r_{1},r_{2})$. Then
        \[
          \Res_{s = 1}\z_{K}(s) = \frac{2^{r_{1}}(2\pi)^{r_{2}}h_{K}R_{K}}{w_{K}\sqrt{|\D_{K}|}}.
        \]
      \end{theorem*}
      \begin{proof}
        The only term in \cref{equ:integral_representation_Dedekind_final} contributing to the pole is $-\frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\frac{2^{r_{1}}h_{K}R_{K}}{\w_{K}\sqrt{|\D|_{K}}s(1-s)}$. Observe that
        \[
          \lim_{s \to 1}\frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}} = (2\pi)^{r_{2}},
        \]
        because $\G\left(\frac{1}{2}\right) = \sqrt{\pi}$ and $\G(1) = 1$. Therefore
        \begin{align*}
          \Res_{s = 1}\z_{K}(s) &= \Res_{s = 1}\left(-\frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\frac{2^{r_{1}}h_{K}R_{K}}{\w_{K}\sqrt{|\D|_{K}}s(1-s)}\right) \\
          &= \lim_{s \to 1}\left(\frac{\pi^{\frac{r_{1}s}{2}}(2\pi)^{r_{2}s}}{\G\left(\frac{s}{2}\right)^{r_{1}}\G\left(s\right)^{r_{2}}}\frac{2^{r_{1}}h_{K}R_{K}}{\w_{K}\sqrt{|\D|_{K}}s}\right) \\
          &= \frac{2^{r_{1}}(2\pi)^{r_{2}}h_{K}R_{K}}{w_{K}\sqrt{|\D_{K}|}}.
        \end{align*}
      \end{proof}

      The usefulness of the analytic class number formula is that is allows for the estimation of the class number in terms of approximating the residue of the Dedekind zeta function at $s = 1$. We collect our work in the following theorem:

      \begin{theorem}\label{thm:Dedekind_Selberg}
        Let $K$ be a number field of degree $d$, signature $(r_{1},r_{2})$, and for each prime $p$ let $\w_{p,i}$ be a primitive $f_{p}(\mf{p}_{i})$-th root of unity for each prime $\mf{p}_{i}$ above $p$. Then $\z_{K}(s)$ is a Selberg class $L$-function with degree $d$ Euler product given by
        \[
          \z_{K}(s) = \prod_{p}\prod_{\substack{1 \le i \le r_{p} \\ 1 \le k \le f_{p}(\mf{p}_{i})}}(1-\w_{p,i}^{k}p^{-s})^{-1}.
        \]
        Moreover, it admits meromorphic continuation to $\C$, possesses the functional equation
        \[
          |\D_{K}|^{\frac{s}{2}}\pi^{-\frac{ds}{2}}\G\left(\frac{s}{2}\right)^{r_{1}+r_{2}}\Gamma\left(\frac{s+1}{2}\right)^{r_{2}}\z_{K}(s) = \L(s,\z_{K}) = \L(1-s,\z_{K}),
        \]
        and has a simple pole at $s = 1$ of residue $\frac{2^{r_{1}}(2\pi)^{r_{2}}h_{K}R_{K}}{w_{K}\sqrt{|\D_{K}|}}$.
      \end{theorem}
  \section{Quadratic Dedekind Zeta Functions}
    Given our discussion of quadratic number fields, it is a simple matter to determine quadratic Dedekind zeta function explicitly:

    \begin{theorem}\label{thm:factorization_of_Dedekind_of_quadratic}
      Let $\Q(\sqrt{d})$ be a quadratic number field and let $\chi_{\D_{d}}$ be the quadratic character associated to the fundamental discriminant $\D_{d}$. Then
      \[
        \z_{\Q(\sqrt{d})}(s) = \z(s)L(s,\chi_{\D_{d}}).
      \]
    \end{theorem}
    \begin{proof}
      By the identity theorem it suffices to prove this for $\s > 1$. Using \cref{prop:factorization_of_primes_quadratic}, the Euler product of $\z_{\Q(\sqrt{d})}(s)$ is given by
      \begin{align*}
        \z_{\Q(\sqrt{d})}(s) &= \prod_{\substack{p \\ \chi_{\D_{d}}(p) = 1}}(1-p^{-s})^{-1}(1-p^{-s})^{-1}\prod_{\substack{p \\ \chi_{\D_{d}}(p) = -1}}(1-p^{-s})^{-1}(1+p^{-s})^{-1}\prod_{\substack{p \\ \chi_{\D_{d}}(p) = 0}}(1-p^{-s})^{-1} \\
        &= \z(s)\prod_{\substack{p \\ \chi_{\D_{d}}(p) = 1}}(1-p^{-s})^{-1}\prod_{\substack{p \\ \chi_{\D_{d}}(p) = -1}}(1+p^{-s})^{-1}\prod_{\substack{p \\ \chi_{\D_{d}}(p) = 0}}1 \\
        &= \z(s)L(s,\chi_{\D_{d}}).
      \end{align*}
      This completes the proof.
    \end{proof}

    Almost immediately, we can prove an interesting expression for $a_{\Q(\sqrt{d})}(n)$:

    \begin{proposition}
      Let $\Q(\sqrt{d})$ be a quadratic number field and let $\chi_{\D_{d}}$ be the quadratic character associated to the fundamental discriminant $\D_{d}$. Then
      \[
        a_{\Q(\sqrt{d})}(n) = \sum_{d \mid n}\chi_{\D_{d}}(d).
      \]
    \end{proposition}
    \begin{proof}
      This follows from \cref{prop:coefficients_of_Dirichlet_series_are_unique} and \cref{rem:alternative_expression_for_Dirichlet_series_of_Dedekind_zeta_function} since the coefficients of the $L$-series of $\z(s)L(s,\chi_{\D_{d}})$ are $\sum_{d \mid n}\chi_{\D_{d}}(d)$.
    \end{proof}

    Since the residue of $\z(s)$ at its pole is $1$, the analytic class number formula gives a relationship between the value of Dirichlet $L$-functions at $s = 1$ and the class number of quadratic number fields. This is known as the \textbf{Dirichlet class number formula}\index{Dirichlet class number formula}:

    \begin{corollary*}[Dirichlet class number formula]
      Let $\Q(\sqrt{d})$ be a quadratic number field and let $\chi_{\D_{d}}$ be the quadratic character associated to the fundamental discriminant $\D_{d}$. Then
      \[
        L(1,\chi_{\D_{d}}) = \frac{2h_{d}\log|\e_{d}|}{\sqrt{|\D_{d}|}} \quad \text{or} \quad L(1,\chi_{\D_{d}}) = \frac{2\pi h_{d}}{w_{d}\sqrt{|\D_{d}|}},
      \]
      where $\e_{d}$ is a fundamental unit, according to if $d > 0$ or $d < 0$.
    \end{corollary*}
    \begin{proof}
      Let $(r_{1},r_{2})$ be the signature of $\Q(\sqrt{d})$. Combining \cref{thm:factorization_of_Dedekind_of_quadratic} with the analytic class number formula and that the residue of $\z(s)$ at its pole is $1$ gives
      \[
        L(1,\chi_{\D_{d}}) = \frac{2^{r_{1}}(2\pi)^{r_{2}}h_{d}R_{d}}{w_{d}\sqrt{|\D_{d}|}}.
      \]
      The result follows by \cref{prop:unit_group_quadratic}, \cref{prop:regulator_quadratic}, and that $(r_{1},r_{2})$ is $(2,0)$ or $(0,1)$ according to if $d > 0$ or $d < 0$.
    \end{proof}
    
    As $h_{d} \ge 1$ and $w_{d} \le 6$ (by \cref{prop:unit_group_quadratic}), the Dirichlet class number formula gives the estimate
    \begin{equation}\label{equ:lower_bound_at_1_Dirichlet_real_character}
      L(1,\chi_{\D_{d}}) \gg \frac{\log|\e_{d}|}{\sqrt{\D_{d}}} \quad \text{or} \quad L(1,\chi_{\D_{d}}) \gg \frac{1}{\sqrt{\D_{d}}},
    \end{equation}
    where $\e_{d}$ is a fundamental unit, according to if $d > 0$ or $d < 0$. By \cref{thm:fundamental_discriminant_character_primitive}, this is really a result about Dirichlet $L$-functions attached to primitive quadratic characters. Note that while \cref{equ:lower_bound_at_1_Dirichlet_real_character} is significantly weaker than Siegel's theorem, the implicit constant is not ineffective.
  \section{The Class Number of Quadratic Number Fields}
    The Dirichlet class number formula gives a relationship between the class number $h_{d}$ of the quadratic number field $\Q(\sqrt{d})$ and the value of the Dirichlet $L$-function $L(s,\chi_{\D_{d}})$ at $s = 1$ where $\chi_{\D_{d}}$ is the quadratic character given by the Kronecker symbol. As $\chi_{\D_{d}}$ is a primitive quadratic character of conductor $|\D_{d}| > 1$ (recall \cref{thm:fundamental_discriminant_character_primitive}), we know from \cref{thm:non-vanishing_of_Dirichlet_L-functions_at_s=1} that $L(1,\chi_{\D_{d}})$ is finite and nonzero. It is interesting to know whether or not this value is computable in general so that we may obtain another formula for the class number. We will actually obtain a formula for $L(1,\chi)$ where $\chi$ is any primitive character $\chi$ of conductor $q > 1$. The computation is fairly straightforward and only requires some basic properties of Ramanujan and Gauss sums that we have already developed. The idea is to rewrite the character values $\chi(n)$ so that we can collapse the infinite series into a Taylor series. Our result is the following:
    
    \begin{theorem}\label{thm:Value_of_Dirichlet_L-functions_at_s=1}
      Let $\chi$ be a primitive Dirichlet character with conductor $q > 1$. Then
      \[
        L(1,\chi) = -\frac{\tau(\chi)}{q}\sum_{a \tmod{q}}\cchi(a)\log\sin\left(\frac{\pi a}{q}\right) \quad \text{or} \quad L(1,\chi) = \frac{\pi i\tau(\chi)}{q^{2}}\sum_{a \tmod{q}}\cchi(a)a,
      \]
      according to whether $\chi$ is even or odd.
    \end{theorem}
    \begin{proof}
      Recall that the Dirichlet $L$-series $L(s,\chi)$ converges for $\s > 0$ and thus at $s = 1$. First compute
      \begin{align*}
        \chi(n) &= \frac{1}{\tau(\cchi)}\sum_{a \tmod{q}}\cchi(a)e^{\frac{2\pi ian}{q}} && \text{\cref{cor:gauss_sum_primitive_formula}} \\
        &= \frac{\chi(-1)}{\conj{\tau(\chi)}}\sum_{a \tmod{q}}\cchi(a)e^{\frac{2\pi ian}{q}} && \text{\cref{prop:Gauss_sum_reduction} (i) and $\chi(-1)^{2} = 1$} \\
        &= \frac{\chi(-1)\tau(\chi)}{\tau(\chi)\conj{\tau(\chi)}}\sum_{a \tmod{q}}\cchi(a)e^{\frac{2\pi ian}{q}} \\
        &= \frac{\chi(-1)\tau(\chi)}{q}\sum_{a \tmod{q}}\cchi(a)e^{\frac{2\pi ian}{q}} && \text{\cref{thm:Gauss_sum_modulus}}.
      \end{align*}
      Substituting the above result into the definition of $L(1,\chi)$, we find that
      \begin{equation}\label{equ:value_of_Dirichlet_L-functions_at_s=1_1}
        \begin{aligned}
          L(1,\chi) &= \sum_{n \ge 1}\frac{1}{n}\left(\frac{\chi(-1)\tau(\chi)}{q}\sum_{a \tmod{q}}\cchi(a)e^{\frac{2\pi ian}{q}}\right) \\
          &= \frac{\chi(-1)\tau(\chi)}{q}\sum_{a \tmod{q}}\cchi(a)\sum_{n \ge 1}\frac{e^{\frac{2\pi ian}{q}}}{n} \\
          &= \frac{\chi(-1)\tau(\chi)}{q}\sum_{a \tmod{q}}\cchi(a)\log\left(\left(1-e^{\frac{2\pi ia}{q}}\right)^{-1}\right),
        \end{aligned}
      \end{equation}
      where in the last line we have used the Taylor series of the logarithm. We will now simplify the last expression in \cref{equ:value_of_Dirichlet_L-functions_at_s=1_1}. Since $\sin(x) = \frac{e^{ix}-e^{-ix}}{2i}$, we have
      \[
        1-e^{\frac{2\pi ia}{q}} = -2ie^{\frac{\pi ia}{q}}\left(\frac{e^{\frac{\pi ia}{q}}-e^{-\frac{\pi ia}{q}}}{2i}\right) = -2ie^{\frac{\pi ia}{q}}\sin\left(\frac{\pi a}{q}\right).
      \]
      Therefore the last expression in \cref{equ:value_of_Dirichlet_L-functions_at_s=1_1} becomes
      \[
        \frac{\chi(-1)\tau(\chi)}{q}\sum_{a \tmod{q}}\cchi(a)\log\left(\left(-2ie^{\frac{\pi ia}{q}}\sin\left(\frac{\pi a}{q}\right)\right)^{-1}\right).
      \]
      As $a$ is taken modulo $q$, we have $0 < \frac{\pi a}{q} < \pi$ so that $\sin\left(\frac{\pi a}{q}\right)$ is never negative. Therefore we can split up the logarithm term and obtain
      \[
        -\frac{\chi(-1)\tau(\chi)}{q}\left(\log(-2i)\sum_{a \tmod{q}}\cchi(a)+\frac{\pi i}{q}\sum_{a \tmod{q}}\cchi(a)a+\sum_{a \tmod{q}}\cchi(a)\log\sin\left(\frac{\pi a}{q}\right)\right).
      \]
      By the Dirichlet orthogonality relations (namely \cref{cor:Dirichlet_orthogonality_relations} (i)), the first sum above vanishes. Therefore
      \begin{equation}\label{equ:value_of_Dirichlet_L-functions_at_s=1_2}
        L(1,\chi) = -\frac{\chi(-1)\tau(\chi)}{q}\left(\frac{\pi i}{q}\sum_{a \tmod{q}}\chi(a)a+\sum_{a \tmod{q}}\chi(a)\log\sin\left(\frac{\pi a}{q}\right)\right).
      \end{equation}
      \cref{equ:value_of_Dirichlet_L-functions_at_s=1_2} simplifies in that one of the two sums vanish depending on if $\chi$ is even or odd. For the first sum in \cref{equ:value_of_Dirichlet_L-functions_at_s=1_2}, the change of variables $a \to -a$ shows that
      \[
        \frac{\pi i}{q}\sum_{a \tmod{q}}\chi(a)a = -\frac{\chi(-1)\pi i}{q}\sum_{a \tmod{q}}\chi(a)a.
      \]
      Hence this sum vanishes if $\chi$ is even which proves the even case. For the second sum in \cref{equ:value_of_Dirichlet_L-functions_at_s=1_2}, the change of variables $a \to q-a$ shows that
      \[
        \sum_{a \tmod{q}}\chi(a)\log\sin\left(\frac{\pi a}{q}\right) = \chi(-1)\sum_{a \tmod{q}}\chi(a)\log\sin\left(\frac{\pi a}{q}\right).
      \]
      Therefore this sum vanishes if $\chi$ is odd proving in the odd case and completing the proof.
    \end{proof}
    
    \begin{remark}
      \cref{thm:Value_of_Dirichlet_L-functions_at_s=1} encodes some interesting identities. For example, if $\chi$ is the non-principal Dirichlet character modulo $4$ then $\chi$ is uniquely defined by $\chi(1) = 1$ and $\chi(3) = \chi(-1) = -1$. In particular, $\chi$ is odd and its conductor is $4$. Now
      \[
        \tau(\chi) = \sum_{a \tmod{4}}\chi(a)e^{\frac{2\pi ia}{4}} = e^{\frac{2\pi i}{4}}-e^{\frac{6\pi i}{4}} = i-(-i) = 2i,
      \]
      and so by \cref{thm:Value_of_Dirichlet_L-functions_at_s=1}, we get
      \[
        L(1,\chi) = \frac{\pi i\tau(\chi)}{16}(1-3) = \frac{\pi}{4}.
      \]
      Expanding $L(1,\chi)$ gives
      \[
        1-\frac{1}{3}+\frac{1}{5}-\frac{1}{7}+\cdots = \frac{\pi}{4},
      \]
      which is the famous \textbf{Madhavaâ€“Leibniz formula}\index{Madhavaâ€“Leibniz formula} for $\pi$.
    \end{remark}

    From the definition of $\chi_{\D_{d}}$, we see that $\chi_{\D_{d}}$ is even or odd according to if $d > 0$ or $d < 0$ (recall \cref{prop:discriminant_quadratic}). This gives an explicit formula for the class number of quadratic number fields:

    \begin{corollary}\label{cor:formula_for_class_number_quadratic_number_field}
      Let $\Q(\sqrt{d})$ be a quadratic number field. Then,
      \[
        h_{d} = -\frac{\tau(\chi)}{2\log|\e_{d}|\sqrt{|\D_{d}|}}\sum_{a \tmod{|\D_{d}|}}\cchi(a)\log\sin\left(\frac{\pi a}{|\D_{d}|}\right) \quad \text{or} \quad h_{d} = \frac{w_{d}i\tau(\chi)}{2|\D_{d}|^{\frac{3}{2}}}\sum_{a \tmod{|\D_{d}|}}\cchi(a)a,
      \]
      where $\e_{d}$ is a fundamental unit, according to if $d > 0$ or $d < 0$.
    \end{corollary}
    \begin{proof}
      This follows from Dirichlet's unit theorem, \cref{thm:Value_of_Dirichlet_L-functions_at_s=1}, and that $\chi_{\D_{d}}$ is even or odd according to if $d > 0$ or $d < 0$.
    \end{proof}

    Having given an explicit formula for the class number of quadratic number fields, we now turn to more useful estimates. By what we have seen, it suffices to obtain bounds for Dirichlet $L$-functions at $s = 1$ and the tighter these bounds are the tighter our estimates for the class number will be. Upper bounds are not too difficult to obtain:

    \begin{proposition}\label{prop:class_number_upper_bound}
      Let $\Q(\sqrt{d})$ be a quadratic number field. Then
      \[
        h_{d}\log|\e_{d}| \ll \sqrt{d}\log(d) \quad \text{or} \quad  h_{d} \ll \sqrt{d}\log(d),
      \]
      where $\e_{d}$ is a fundamental unit, according to if $d > 0$ or $d < 0$.
    \end{proposition}
    \begin{proof}
      This follows from the Dirichlet class number formula and \cref{lem:log_growth_of_Dirichlet_L-series_near_1} since $\D_{d} \asymp d$ (recall \cref{prop:discriminant_quadratic}).
    \end{proof}

    Effective lower bounds are difficult to obtain. However, if we allow the implicit constant to be ineffective we may use Siegel's theorem:

    \begin{proposition}\label{prop:class_number_lower_bound}
      Let $\Q(\sqrt{d})$ be a quadratic number field. Then there exists a positive constant $c(\e)$ such that
      \[
        h_{d}\log|\e_{d}| \ge c(\e)d^{\frac{1}{2}-\e} \quad \text{or} \quad  h_{d} \ge c(\e)d^{\frac{1}{2}-\e},
      \]
      where $\e_{d}$ is a fundamental unit, according to if $d > 0$ or $d < 0$.
    \end{proposition}
    \begin{proof}
      This follows from the Dirichlet class number formula and Siegel's theorem since $\D_{d} \asymp d$ (recall \cref{prop:discriminant_quadratic}).
    \end{proof}

    As a corollary we find that there are only finitely many imaginary quadratic number fields of a fixed class number:

    \begin{corollary}\label{cor:finitely_many_imaginary_quadratic_of_fixed_class_number}
      Let $n \ge 1$. Then there are finitely many imaginary quadratic number fields $\Q(\sqrt{d})$ of class number $n$.
    \end{corollary}
    \begin{proof}
      By \cref{prop:class_number_lower_bound}, we see that $h_{d} \to \infty$ as $d \to -\infty$. The claim follows at once.
    \end{proof}

    It is in \cref{cor:finitely_many_imaginary_quadratic_of_fixed_class_number} that we can see where the ineffectiveness of Siegel's theorem becomes apparent. Indeed, although there are finitely many imaginary quadratic number fields of class number $n \ge 1$, we cannot use the bound
    \[
      h_{d} \ge c(\e)d^{\frac{1}{2}-\e},
    \]
    from \cref{prop:class_number_lower_bound} to reduce this to a finite computation because the constant $c(\e)$ is ineffective. In other words, we cannot obtain lower bound on $d$ as $d \to -\infty$ that tells us when all class numbers are larger than $n$ even though we know such a bound exists.