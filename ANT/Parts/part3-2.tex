\chapter{Geometry of Number Fields}
  We can apply geometric tools to a number field $K$ by leveraging the distinct embeddings of $K$ into $\conj{\Q}$. This theory is developed under the umbrella of Minkowski space and we will use it to prove two crucial results about number fields: finiteness of the class number and Dirichlet's unit theorem.
  \section{Minkowski Space}
    Let $K$ be number field of degree $n$ and let $\s \in \Hom_{\Q}(K,\conj{\Q})$. Then either $\s$ is real or complex and if it is complex it has a paired $\Q$-embedding $\conj{\s} \in \Hom_{\Q}(K,\conj{\Q})$ given by the conjugate of $\s$. Accordingly, let $r_{1}$ and $2r_{2}$ be the number of real and complex $\Q$-embeddings of $K$ into $\conj{\Q}$ respectively. We call the pair $(r_{1},r_{2})$ the \textbf{signature}\index{signature} of $K$ and it satisfies the relation
    \[
      n = r_{1}+2r_{2}.
    \]
    Setting
    \[
      K_{\C} = \C^{n},
    \]
    we see that $K_{\C}$ is a $\C$-algebra and also a complex Hilbert space with respect to $\<\cdot,\cdot\>_{K_{\C}}$ which we take to be the standard complex inner product. We denote the associated Lebesgue measure by $d\l_{K_{\C}}$. We define the \textbf{canonical embedding}\index{canonical embedding} $j$ of $K$ to be the $\Q$-embedding
    \[
      j:K \to K_{\C} \qquad \k \mapsto (\s(\k))_{\s},
    \]
    where $\s$ runs over $\Hom_{\Q}(K,\conj{\Q})$. Consider the conjugation map
    \[
      F:\C \to \C \qquad z \mapsto \conj{z}.
    \]
    This induces an automorphism
    \[
      F:K_{\C} \to K_{\C} \qquad (z_{\s})_{\s} \mapsto (\conj{z_{\conj{\s}}})_{\s},
    \]
    that is clearly an involution. The inner product $\<\cdot,\cdot\>_{K_{\C}}$ is also $F$-equivariant since any $\mathbf{z},\mathbf{w} \in K_{\C}$ satisfy
    \[
      \<F(\mathbf{z}),F(\mathbf{z})\>_{K_{\C}} = \<(\conj{z_{\conj{\s}}})_{\s},(\conj{w_{\conj{\s}}})_{\s}\>_{K_{\C}} = \sum_{\s}\conj{z_{\conj{\s}}w_{\conj{\s}}} = \conj{\sum_{\s}z_{\s}w_{\s}} = F(\<\mathbf{z},\mathbf{w}\>_{K_{\C}}),
    \]
    where in the third equality we have used the fact that the complex $\Q$-embeddings of $K$ into $\conj{\Q}$ come in conjugate pairs. On $K_{\C}$ we also have linear maps
    \[
      \Trace_{K_{\C}}((z_{\s})_{\s}) = \sum_{\s}z_{\s} \quad \text{and} \quad \Norm_{K_{\C}}((z_{\s})_{\s}) = \prod_{\s}z_{\s},
    \]
    and clearly induce homomorphisms
    \[
      \Trace_{K_{\C}}:K_{\C} \to \C \quad \text{and} \quad \Norm_{K_{\C}}:K_{\C}^{\ast} \to \C^{\ast}.
    \]
    The composition of $j$ with $\Trace_{K_{\C}}$ and $\Norm_{K_{\C}}$ are $\Trace_{K}$ and $\Norm_{K}$ respectively since
    \[
      \Trace_{K_{\C}}(j(\k)) = \sum_{\s}\s(\k) = \Trace_{K}(\k) \quad \text{and} \quad \Norm_{K_{\C}}(j(\k)) = \prod_{\s}\s(\k) = \Norm_{K}(\k),
    \]
    where the last equality in each chain follow by \cref{prop:formulas_for_trace_and_norm}. We now define the \textbf{Minkowski space}\index{Minkowski space} $K_{\R}$ of $K$ by
    \[
      K_{\R} = \{(z_{\s})_{\s} \in K_{\C}:F((z_{\s})_{\s}) = (z_{\s})_{\s}\}.
    \]
    In other words, $K_{\R}$ consists of all of the $F$-invariant points of $K_{\C}$. That is, $\mathbf{z} \in K_{\R}$ if and only if $F(\mathbf{z}) = \mathbf{z}$ or equivalently $z_{\conj{\s}} = \conj{z_{\s}}$ for all $\s$. In particular, $j(K) \subset K_{\R}$ because $\conj{\s}(\k) = \conj{\s(\k)}$ by definition of $\conj{\s}$. We denote the restriction of the inner product $\<\cdot,\cdot\>_{K_{\C}}$ on $K_{\C}$ to $K_{\R}$ by $\<\cdot,\cdot\>_{K_{\R}}$. Note that $K_{\R}$ is an $\R$-algebra. Moreover, the inner product $\<\cdot,\cdot\>_{K_{\R}}$ turns $K_{\R}$ into a real Hilbert space. Indeed, for any $\mathbf{z},\mathbf{w} \in K_{\R}$ the conjugate symmetry and $F$-equivariance of the inner product together give
    \[
      \conj{\<\mathbf{z},\mathbf{w}\>} = F(\<\mathbf{w},\mathbf{z}\>) = \<F(\mathbf{z}),F(\mathbf{w})\> = \<\mathbf{z},\mathbf{w}\>,
    \]
    so that $\<\mathbf{z},\mathbf{w}\> \in \R$ is real. Accordingly, we call $\<\cdot,\cdot\>_{K_{\R}}$ the \textbf{Minkowski inner product}\index{Minkowski inner product}. We denote the restriction of the Lebesgue measure $d\l_{\C}$ to $K_{\R}$ by $d\l_{K_{\R}}$ which is also the Lebesgue measure associated to $\<\cdot,\cdot\>_{K_{\R}}$. We call $d\l_{K_{\R}}$ the \textbf{Minkowski measure}\index{Minkowski measure}. Lastly, we denote the restrictions of $\Trace_{K_{\C}}$ and $\Norm_{K_{\C}}$ to $K_{\R}$ by $\Trace_{K_{\R}}$ and $\Norm_{K_{\R}}$ respectively and call these maps the \textbf{Minkowski trace}\index{Minkowski trace} and \textbf{Minkowski norm}\index{Minkowski norm} respectively. We also have homomorphisms
    \[
      \Trace_{K_{\R}}:K_{\R} \to \R \quad \text{and} \quad \Norm_{K_{\R}}:K_{\R}^{\ast} \to \R^{\ast},
    \]
    $\mathbf{z} \in K_{\R}$ if and only if $z_{\conj{\s}} = \conj{z_{\s}}$ for all $\s$. As $j(K) \subset K_{\R}$, the compositions of $j$ with the Minkowski trace and Minkowski norm are the field trace and field norm respectively. We can now give a more explicit description of $K_{\R}$ and to do this we setup some notation. Let $\rho$ run over the real $\Q$-embeddings of $\Hom_{\Q}(K,\conj{\Q})$ and let $\tau$ run over a complete set of representatives of the pairs of complex $\Q$-embeddings of $\Hom_{\Q}(K,\conj{\Q})$. For any $\s \in \Hom_{\Q}(K,\conj{\Q})$, let $N_{\s} = 1,2$ according to if $\s$ is real or complex respectively. So $N_{\rho} = 1$ and $N_{\tau} = 2$. As $K_{\R}$ consists of exactly the $F$-invariant points of $K_{\C}$, we have
    \[
      K_{\R} = \{(z_{\s})_{\s} \in K_{\C}:\text{$z_{\rho} \in \R$ and $z_{\conj{\tau}} = \conj{z_{\tau}}$ for all $\rho$ and $\tau$}\}.
    \]
    We now describe an explicit isomorphism from the Minkowski space and $\R^{n}$:
    
    \begin{proposition}\label{prop:Minkowski_space_isomorphism}
      Let $K$ be a number field of degree $n$ and signature $(r_{1},r_{2})$. Also let $\s$ run over $\Hom_{\Q}(K,\conj{\Q})$, $\rho$ run over all such real $\Q$-embeddings, and $\tau$ run over a complete set of representatives of all such pairs of complex $\Q$-embeddings. Then there is an isomorphism
      \[
        K_{\R} \to \R^{n} \qquad z_{\s} \mapsto x_{\s} = \begin{cases} z_{\s} & \text{if $\s = \rho$}, \\ \Re(z_{\s}) & \text{if $\s = \tau$}, \\ \Im(z_{\s}) & \text{if $\s = \conj{\tau}$}. \end{cases}
      \]
      In particular, $K_{\R}$ is a $n$-dimensional real vector space. Moreover, the inner product $\<\cdot,\cdot\>$ on $\R^{n}$ induced by the Minkowski inner product is given by
      \[
        \<\mathbf{x},\mathbf{x}'\> = \sum_{\s}N_{\s}x_{\s}x'_{\s},
      \]
      for any $\mathbf{x},\mathbf{x}' \in \R^{n}$.
    \end{proposition}
    \begin{proof}
      This map is an isomorphism since it is invertible and linear in each component. Since there are $n$  elements of $\Hom_{\Q}(K,\conj{\Q})$, we see that $K_{\R}$ is an $n$-dimensional real vector space. We will now prove the statement about the inner product. Let $(z_{\s})_{\s}$ and $(z'_{\s})_{\s}$ be elements of $K_{\R}$ and let $(x_{\s})_{\s}$ and $(x'_{\s})_{\s}$ be the corresponding elements in $\R^{n}$. If $\s = \rho$ then
      \[
        x_{\rho} = z_{\rho} \quad \text{and} \quad x'_{\rho} = z'_{\rho},
      \]
      and thus
      \[
        x_{\rho}x'_{\rho} = z_{\rho}\conj{z'_{\rho}}.
      \]
      If $\s = \tau$ then
      \[
        x_{\tau} = \Re(z_{\tau}), \quad x_{\conj{\tau}} = \Im(z_{\tau}), \quad x'_{\tau} = \Re(z'_{\tau}), \text{and} \quad x'_{\conj{\tau}} = \Im(z'_{\tau}),
      \]
      and hence
      \[
        2(x_{\tau}x'_{\tau}+x_{\conj{\tau}}x'_{\conj{\tau}}) = 2(\Re(z_{\tau})\Re(z'_{\tau})+\Im(z_{\tau})\Im(z'_{\tau})) = 2\Re(z_{\tau}\conj{z'_{\tau}}) = z_{\tau}\conj{z'_{\tau}}+z_{\conj{\tau}}\conj{z'_{\conj{\tau}}}.
      \]
      This proves the claim about the inner product.
    \end{proof}
    
    Define the \textbf{Minkowski embedding}\index{Minkowski embedding} $\s_{K}$ of $K$ by
    \[
      \s_{K}:K \to \R^{n} \qquad \k \mapsto (\rho_{1}(\k),\ldots,\rho_{r_{1}}(k),\Re(\tau_{1}(\k)),\Im(\tau_{1}(\k)),\ldots,\Re(\tau_{r_{2}}(\k)),\Im(\tau_{r_{2}}(\k))),
    \]
    where $\rho_{1},\ldots,\rho_{r_{1}}$ are the real $\Q$-embeddings of $\Hom_{\Q}(K,\conj{\Q}) $and $\tau_{1},\ldots,\tau_{r_{2}}$ are representatives of pairs of complex $\Q$-embeddings of $\Hom_{\Q}(K,\conj{\Q})$. The Minkowski embedding $\s_{K}$ is then a $\Q$-embedding of $K$ into $\R^{n}$ since it is the composition of the canonical embedding $j$ (whose image under $K$ is in $K_{\R}$ as we have noted) and the isomorphism established by \cref{prop:Minkowski_space_isomorphism}. It is also independent of the choice of representatives $\tau_{1},\ldots,\tau_{r_{2}}$ since the complex $\Q$-embeddings of $\Hom_{\Q}(K,\conj{\Q})$ occur in conjugate pairs. As $j$ is a $\Q$-embedding and any fractional ideal $\mf{f}$ is a complete lattice, $j(\mf{f})$ is a complete lattice in $K_{\R}$. We now determine the covolume of $j(\mf{f})$:

    \begin{proposition}\label{prop:covolume_of_fractional_ideal_under_j}
      Let $K$ be a number field with signature $(r_{1},r_{2})$. Then $V_{j(\mf{f})}$ is the absolute value of the determinant of any embedding matrix for $\mf{f}$. In particular,
      \[
        V_{j(\mf{f})} = \Norm_{K}(\mf{f})\sqrt{|\D_{K}|},
      \]
      and
      \[
        V_{j(\mc{O}_{K})} = \sqrt{|\D_{K}|}.
      \]
    \end{proposition}
    \begin{proof}
      The last statement follows from the first two by taking $\mf{f} = \mc{O}_{K}$ so it suffices to prove the first two statements. Let $\k_{1},\ldots,\k_{n}$ be a basis for $\mf{f}$ and let $\s_{1},\ldots,\s_{n}$ be the elements of $\Hom_{\Q}(K,\conj{\Q})$. Then the associated generator matrix $P$ for $j(\mf{f})$ is given by
      \[
        P = \begin{pmatrix} \s_{1}(\k_{1}) & \cdots & \s_{1}(\k_{n}) \\ \vdots & & \vdots & \\ \s_{n}(\k_{1}) & \cdots & \s_{n}(\k_{n}) \end{pmatrix} = M(\k_{1},\ldots,\k_{n}),
      \]
      which is an embedding matrix for $\mf{f}$. Hence
      \[
        V_{j(\mf{f})} = |\det(M(\k_{1},\ldots,\k_{n}))|,
      \]
      proving the first statement. We will be done if we can show
      \[
        |\det(M(\k_{1},\ldots,\k_{n}))| = \Norm_{K}(\mf{f})|\det(M(\a_{1},\ldots,\a_{n}))|,
      \]
      for any integral basis $\a_{1},\ldots,\a_{n}$ since $|\det(M(\a_{1},\ldots,\a_{n}))| = \sqrt{|\D_{K}|}$ (as we have seen). As $\mf{f}$ is a fractional ideal, there exists a nonzero $\d \in \mc{O}_{K}$ and an integral ideal $\mf{a}$ such that
      \[
        \mf{f} = \frac{1}{\d}\mf{a}.
      \]
      Then $\d\k_{1},\ldots,\d\k_{n}$ is a basis for $\mf{a}$. By \cref{prop:norm_and_field_norms_are_identical,prop:base_change_quotient_determinant}, we have
      \[
        |\det(M(\d\k_{1},\ldots,\d\k_{n}))| = \Norm_{K}(\mf{a})|\det(M(\a_{1},\ldots,\a_{n}))|,
      \]
      since they together show that $\Norm_{K}(\mf{a})$ is the absolute value of the determinant of the base change matrix from $\k_{1},\ldots,\k_{n}$ to $\d\k_{1},\ldots,\d\k_{n}$. Similarly,
      \[
        |\det(M(\d\k_{1},\ldots,\d\k_{n}))| = |\Norm_{K}(\d)||\det(M(\k_{1},\ldots,\k_{n}))|,
      \]
      since \cref{prop:norm_and_field_norms_are_identical,prop:base_change_quotient_determinant} together show that $|\Norm_{K}(\d)|$ is the absolute value of the determinant of the base change matrix from $\k_{1},\ldots,\k_{n}$ to $\d\k_{1},\ldots,\d\k_{n}$. As $\Norm_{K}(\mf{f}) = \frac{\Norm_{K}(\mf{a})}{|\Norm_{K}(\d)|}$ by multiplicativity of the norm and \cref{prop:norm_and_field_norms_are_identical}, these two identities for $|\det(M(\d\k_{1},\ldots,\d\k_{n}))|$ together imply the claim.
    \end{proof}
    
    Now as $\s_{K}$ is also a $\Q$-embedding, $\s_{K}(\mf{f})$ is a complete lattice in $\R^{n}$. As a corollary of \cref{prop:covolume_of_fractional_ideal_under_j}, we can determine the covolume of $\s_{K}(\mf{f})$:
    
    \begin{corollary}\label{cor:covolume_of_fractional_ideal_under_canonical_embedding}
      Let $K$ be a number field with signature $(r_{1},r_{2})$. Then
      \[
        V_{\s_{K}(\mf{f})} = \Norm_{K}(\mf{f})\frac{\sqrt{|\D_{K}|}}{2^{r_{2}}}.
      \]
      In particular,
      \[
        V_{\s_{K}(\mc{O}_{K})} = \frac{\sqrt{|\D_{K}|}}{2^{r_{2}}}.
      \]
    \end{corollary}
    \begin{proof}
      The second statement follows from the first by taking $\mf{f} = \mc{O}_{K}$ so it suffices to prove the first statement. Let $\k_{1},\ldots,\k_{n}$ be a basis for $\mf{f}$, $\rho_{1},\ldots,\rho_{r_{1}}$ be the real $\Q$-embeddings of $\Hom_{\Q}(K,\conj{\Q})$ and $\tau_{1},\ldots,\tau_{r_{2}}$ be a complete set of representatives of pairs of complex $\Q$-embeddings of $\Hom_{\Q}(K,\conj{\Q})$. Then the associated generator matrix $P$ for $\s_{K}(\mf{f})$ is
      \[
        P = \begin{pmatrix} \rho_{1}(\k_{1}) & \cdots & \rho_{r_{1}}(\k_{1}) & \Re(\tau_{1}(\k_{1})) & \Im(\tau_{1}(\k_{1})) & \cdots & \Re(\tau_{r_{2}}(\k_{1})) & \Im(\tau_{r_{2}}(\k_{1})) \\ \vdots & & \vdots & \vdots & \vdots & & \vdots & \vdots \\ \rho_{1}(\k_{n}) & \cdots & \rho_{r_{1}}(\k_{n}) & \Re(\tau_{1}(\k_{n})) & \Im(\tau_{1}(\k_{n})) & \cdots & \Re(\tau_{r_{2}}(\k_{n})) & \Im(\tau_{r_{2}}(\k_{n})) \end{pmatrix}^{t}.
      \]
      By \cref{prop:covolume_of_fractional_ideal_under_j} we are done if the absolute value of the determinant of this matrix is $2^{-r_{2}}$ times the determinate of an embedding matrix for $\mf{f}$. To show this, first add an $i$ multiple of the imaginary columns to their corresponding real columns and then apply the identity $\Im(z) = \frac{z-\conj{z}}{2i}$ to the imaginary columns to obtain
      \[
        P' = \begin{pmatrix} \rho_{1}(\k_{1}) & \cdots & \rho_{r_{1}}(\k_{1}) & \tau_{1}(\k_{1}) & \frac{\tau_{1}(\k_{1})-\conj{\tau_{1}}(\k_{1})}{2i} & \cdots & \tau_{r_{2}}(\k_{1}) & \frac{\tau_{r_{2}}(\k_{1})-\conj{\tau_{r_{2}}}(\k_{1})}{2i} \\ \vdots & & \vdots & \vdots & \vdots & & \vdots & \vdots \\ \rho_{1}(\k_{n}) & \cdots & \rho_{r_{1}}(\k_{n}) & \tau_{1}(\k_{n}) & \frac{\tau_{1}(\k_{n})-\conj{\tau_{1}}(\k_{n})}{2i} & \cdots & \tau_{r_{2}}(\k_{n}) & \frac{\tau_{r_{2}}(\k_{n})-\conj{\tau_{r_{2}}}(\k_{n})}{2i} \end{pmatrix}^{t}.
      \]
      Since $P'$ differs from $P$ by column addition, their determinants are the same. Multiplying the imaginary columns of $P'$ by $-2i$ and then adding the corresponding columns to annihilate the negative terms results in
      \[
        P'' = \begin{pmatrix} \rho_{1}(\k_{1}) & \cdots & \rho_{r_{1}}(\k_{1}) & \tau_{1}(\k_{1}) &\conj{\tau_{1}}(\k_{1}) & \cdots & \tau_{r_{2}}(\k_{1}) & \conj{\tau_{r_{2}}}(\k_{1}) \\ \vdots & & \vdots & \vdots & \vdots & & \vdots & \vdots \\ \rho_{1}(\k_{n}) & \cdots & \rho_{r_{1}}(\k_{n}) & \tau_{1}(\k_{n}) & \conj{\tau_{1}}(\k_{n}) & \cdots & \tau_{r_{2}}(\k_{n}) & \conj{\tau_{r_{2}}}(\k_{n}) \end{pmatrix}^{t}.
      \]
      As $P''$ differs from $P'$ by column addition and column scaling of which there were $r_{2}$ many of factor $-2i$, the determinant of $P''$ is $(-2i)^{-r_{2}}$ that of $P'$. Altogether,
      \[
        V_{\mf{f}} = |\det(P)| = |\det(P')| = |(-2i)^{-r_{2}}\det(P'')| = 2^{-r_{2}}|\det(P'')|.
      \]
      Since the complex $\Q$-embeddings of $\Hom_{\Q}(K,\conj{\Q})$ occur in conjugate pairs and $\k_{1},\ldots,\k_{n}$ is a basis for $K$, we see that $P'' = M(\k_{1},\ldots,\k_{n})$ is an embedding matrix for $\mf{f}$.
    \end{proof}
  \section{Finiteness of the Class Number}
    Recall that the class number $h_{K}$ is a measure of how much the ring of integers $\mc{O}_{K}$ fails to be a principal ideal domain. From \cref{rem:general_class_number_not_finite}, the class number of an arbitrary Dedekind domain need not be finite. However, we will show that the class number $h_{K}$ for a number field $K$ is always finite and thus $\mc{O}_{K}$ only has finite failure from being a principal ideal domain:

    \begin{theorem}\label{equ:finitness_of_class_number}
      Let $K$ be a number field of degree $n$ and signature $(r_{1},r_{2})$. Also, let $X \subseteq \R^{n}$ be a compact convex symmetric set and set $M = \max_{\mathbf{x} \in X}\left(\prod_{1 \le i \le n}|x_{i}|\right)$. Then every ideal class contains an integral ideal $\mf{a}$ satisfying
      \[
        \Norm_{K}(\mf{a}) \le \frac{2^{r_{1}+r_{2}}M}{\Vol(X)}\sqrt{|\D_{K}|}.
      \]
      Moreover, the ideal class group $\Cl(K)$ is finite so that the class number $h_{K}$ is too.
    \end{theorem}
    \begin{proof}
      Let $\mf{f}$ be a fractional ideal, and set
      \[
        \l^{n} = 2^{n}\frac{V_{\s_{K}(\mf{f}^{-1})}}{\Vol(X)},
      \]
      for any $n \ge 1$. Then by construction,
      \[
        \Vol(\l X) = \l^{n}\Vol(X) = 2^{n}V_{\s_{K}(\mf{f}^{-1})}.
      \]
      By Minkowski's lattice point theorem, there exists a nonzero $\a \in \mf{f}^{-1}$ such that $\s_{K}(\a) \in \s_{K}(\mf{f}^{-1})$ and $\s_{K}(\a) \in \l X$. Since $\a \in \mf{f}^{-1}$, $\a\mf{f} \subseteq \mc{O}_{K}$ so that $\a\mf{f}$ is an integral ideal in the same ideal class as $\mf{f}$. Now let $\s$ run over $\Hom_{\Q}(K,\conj{\Q})$. Since the norm is multiplicative, we have
      \[
        \Norm_{K}(\a\mf{f}) = |\Norm_{K}(\a)|\Norm_{K}(\mf{f}) = \left|\prod_{\s}\s(\a)\right|\Norm_{K}(\mf{f}) \le \l^{n}M\Norm_{K}(\mf{f}),
      \]
      where in the first equality we have applied multiplicativity of the norm and \cref{prop:norm_and_field_norms_are_identical}, in the second we have used \cref{prop:formulas_for_trace_and_norm}, and the inequality follows since $\s_{K}(\a) \in \l X$. This inequality, our choice of $\l^{n}$, and \cref{cor:covolume_of_fractional_ideal_under_canonical_embedding} together give
      \[
        \Norm_{K}(\a\mf{f}) \le \l^{n}M\Norm_{K}(\mf{f}) = 2^{n}M\Norm_{K}(\mf{f})\frac{V_{\s_{K}(\mf{f}^{-1})}}{\Vol(X)} = 2^{n}M\frac{\sqrt{|\D_{K}|}}{2^{r_{2}}\Vol(X)} = \frac{2^{r_{1}+r_{2}}M}{\Vol(X)}\sqrt{|\D_{K}|},
      \]
      which proves the first statement since the fractional ideal $\mf{f}$ was arbitrary. We now prove that the class group is finite. By what we have just proved, we can find a complete set of representatives of $\Cl(K)$ consisting of integral ideals of bounded norm. Since the norm is multiplicative, the prime factors of these representatives have bounded norm as well. As we have seen, the norm of a prime integral ideal is exactly the prime $p$ below it. Thus the norms of these prime factors are bounded primes $p$. As there are finitely many prime integral ideals above any prime $p$ (because $p\mc{O}_{K}$ factors into a product of prime integral ideals and these are exactly the prime integral ideals above $p$), it follows that these representatives have finitely many prime factors. Altogether this means that there are finitely many representatives. Hence $\Cl(K)$ is finite and so the class number $h_{K}$ is too.
    \end{proof}

    We would like to obtain an explicit bound in \cref{equ:finitness_of_class_number} by making a choice for the set $X$. To obtain a bound that is not too large, we need to ensure that the volume of $X$ is large while the constant $M$ is small. The following lemma dictates our choice of $X$ and computes its volume:

    \begin{lemma}\label{lem:Minkowski_bound_lemma}
      Suppose $n$ is a positive integer and write $n = r_{1}+2r_{2}$ for some nonnegative integers $r_{1}$ and $r_{2}$. Let $X \subset \R^{n}$ to be the compact convex symmetric set given by
      \[
        X = \left\{\mathbf{x} \in \R^{n}:\sum_{1 \le i \le r_{1}}|x_{i}|+2\sum_{\substack{1 \le j \le r_{2} \\ j \equiv 1 \tmod{2}}}\sqrt{x_{r_{1}+j}^{2}+x_{r_{1}+j+1}^{2}} \le n\right\}.
      \]
      Then
      \[
        \Vol(X) = \frac{n^{n}}{n!}2^{r_{1}}\left(\frac{\pi}{2}\right)^{r_{2}}.
      \]
    \end{lemma}
    \begin{proof}
      Making the change of variables $x_{r_{1}+j} \mapsto u_{j}\sin(\t_{j})$ and $x_{r_{1}+j+1} \mapsto u_{j}\cos(\t_{j})$ for all $j$ gives
      \[
        \Vol(X) = \int_{X'}u_{1} \cdots u_{r_{2}}\,dx_{1} \cdots dx_{r_{1}}\,du_{1}\t_{1} \cdots du_{r_{2}}\t_{r_{2}},
      \]
      where
      \[
        X' = \left\{(x_{1},\ldots,x_{r_{1}},u_{1},\t_{1},\ldots,u_{r_{2}},\t_{r_{2}}):\sum_{1 \le i \le r_{1}}|x_{i}|+2\sum_{1 \le j \le r_{2}}u_{j} \le n\right\}.
      \]
      Since the integrand is independent of the $\t_{j}$, we have
      \[
        \Vol(X) = (2\pi)^{r_{2}}\int_{X'}u_{1} \cdots u_{r_{2}}\,dx_{1} \cdots dx_{r_{1}}\,du_{1} \cdots du_{r_{2}}.
      \]
      Making the change of variables $u_{j} \mapsto \frac{u_{j}}{2}$ for all $j$ and using the fact that the integrand is symmetric in the $x_{i}$ for all $i$ gives
      \begin{equation}\label{equ:Minkowski_bound_lemma_1}
        \Vol(X) = 2^{r_{1}}\left(\frac{\pi}{2}\right)^{r_{2}}\int_{X''}u_{1} \cdots u_{r_{2}}\,dx_{1} \cdots dx_{r_{1}}\,du_{1} \cdots du_{r_{2}},
      \end{equation}
      where
      \[
        X'' = \left\{(x_{1},\ldots,x_{r_{1}},u_{1},\ldots,u_{r_{2}}):\sum_{1 \le i \le r_{1}}x_{i}+\sum_{1 \le j \le r_{2}}u_{j} \le n\right\}.
      \]
      To compute the remaining integral, for nonnegative integers $\ell$ and $k$ and $t \ge 0$, we let
      \[
        X''_{\ell,k}(t) = \left\{(x_{1},\ldots,x_{\ell},u_{1},\ldots,u_{k}):\sum_{1 \le i \le \ell}x_{i}+\sum_{1 \le j \le k}u_{j} \le t\right\},
      \]
      and set 
      \[
        I_{\ell,k}(t) = \int_{X''_{\ell,k}(t)}u_{1} \cdots u_{\ell}\,dx_{1} \cdots dx_{n}\,du_{1} \cdots du_{k}.
      \]
      Then we have to compute $I_{r_{1},r_{2}}(n)$. To this end, the change of variables $x_{i} \mapsto tx_{i}$ and $u_{j} \mapsto tu_{j}$ for all $i$ and $j$ gives
      \begin{equation}\label{equ:Minkowski_bound_lemma_2}
        I_{\ell,k}(t) = t^{\ell+2k}I_{\ell,k}(1).
      \end{equation}
      Now note that the condition
      \[
        \sum_{1 \le i \le \ell}x_{i}+\sum_{1 \le j \le k}u_{j} \le t,
      \]
      is equivalent to
      \[
        \sum_{1 \le i \le \ell-1}x_{i}+\sum_{1 \le j \le k}u_{j} \le t-x_{i}.
      \]
      This fact together with the Fubini–Tonelli theorem and \cref{equ:Minkowski_bound_lemma_2} gives
      \[
        I_{\ell,k}(1) = \int_{0}^{1}I_{\ell-1,k}(1-x_{\ell})\,dx_{\ell} = \int_{0}^{1}(1-x_{\ell})^{\ell-1+2k}I_{\ell-1,k}(1)\,dx_{\ell} = \frac{1}{\ell+2k}I_{\ell-1,k}(1).
      \]
      Repeating this procedure $\ell-1$ times results in
      \begin{equation}\label{equ:Minkowski_bound_lemma_3}
        I_{\ell,k}(1) = \frac{1}{(\ell+2k) \cdots (2k+1)}I_{0,k}(1).
      \end{equation}
      Similarly, the condition
      \[
        \sum_{1 \le j \le k}u_{j} \le t,
      \]
      is equivalent to
      \[
        \sum_{1 \le j \le k-1}u_{j} \le t-u_{k}.
      \]
      This fact together with the Fubini–Tonelli theorem, \cref{equ:Minkowski_bound_lemma_2}, and \cref{prop:integral_reprepsentation_for_beta_function}, gives
      \[
        I_{0,k}(1) = \int_{0}^{1}u_{k}I_{0,k-1}(1-u_{k})\,du_{k} = \int_{0}^{1}u_{k}(1-u_{k})^{2k-2}I_{0,k-1}(1)\,du_{k} = B(1,2k-1)I_{0,k-1}(1) = \frac{1}{2k}I_{0,k-1}(1).
      \]
      Repeating this procedure $k-1$ times results in
      \begin{equation}\label{equ:Minkowski_bound_lemma_4}
        I_{0,k}(1) = \frac{1}{k!},
      \end{equation}
      since $I_{0,0}(1) = 1$. Combining \cref{equ:Minkowski_bound_lemma_2,equ:Minkowski_bound_lemma_3,equ:Minkowski_bound_lemma_4} we find that
      \[
        I_{\ell,k}(t) = t^{\ell+2k}\frac{1}{(\ell+2k)!}.
      \]
      In particular, $I_{r_{1},r_{2}}(n) = \frac{n^{n}}{n!}$ and from \cref{equ:Minkowski_bound_lemma_1} we obtain
      \[
        \Vol(X) = \frac{n^{n}}{n!}2^{r_{1}}\left(\frac{\pi}{2}\right)^{r_{2}},
      \]
      as desired.
    \end{proof}

    Observe that the set $X$ in \cref{lem:Minkowski_bound_lemma} just consists of those points in $\R^{n}$ whose induced norm corresponding to the induced Minkowski inner product is at most $n$ (recall \cref{prop:Minkowski_space_isomorphism}). We can now obtain an explicit bound in \cref{equ:finitness_of_class_number} known as the \textbf{Minkowski bound}\index{Minkowski bound}:

    \begin{theorem*}[Minkowski bound]
      Let $K$ be a number field of degree $n$ and signature $(r_{1},r_{2})$. Then every ideal class contains an integral ideal $\mf{a}$ satisfying
      \[
        \Norm_{K}(\mf{a}) \le \left(\frac{4}{\pi}\right)^{r_{2}}\frac{n!}{n^{n}}\sqrt{|\D_{K}|}.
      \]
    \end{theorem*}
    \begin{proof}
      Let $X$ be given by
      \[
        X = \left\{\mathbf{x} \in \R^{n}:\sum_{1 \le i \le r_{1}}|x_{i}|+2\sum_{\substack{1 \le j \le r_{2} \\ j \equiv 1 \tmod{2}}}\sqrt{x_{r_{1}+j}^{2}+x_{r_{1}+j+1}^{2}} \le n\right\}.
      \]
      Then \cref{equ:finitness_of_class_number,lem:Minkowski_bound_lemma} together give
      \[
        \Norm_{K}(\mf{a}) \le M\left(\frac{4}{\pi}\right)^{r_{2}}\frac{n!}{n^{n}}\sqrt{|\D_{K}|},
      \]
      where $M = \max_{\mathbf{x} \in X}\left(\prod_{1 \le \ell \le n}|x_{\ell}|\right)$. But for all $\mathbf{x} \in X$, the arithmetic-geometric mean inequality gives
      \[
        \left(\prod_{1 \le \ell \le n}|x_{\ell}|\right)^{\frac{1}{n}} \le \frac{1}{n}\sum_{1 \le \ell \le n}|x_{\ell}| \le 1,
      \]
      where the second inequality holds by the definition of $X$. Hence $M \le 1$ and this completes the proof.
    \end{proof}

    As a corollary we can obtain a lower bound for the discriminant of a number field and show that every number field $K$, other than $\Q$, has at least one ramified prime in $\mc{O}_{K}/\Z$:

    \begin{corollary}
      Let $K$ be a number field of degree $n$. Then
      \[
        |\D_{K}| \ge \left(\frac{\pi}{4}\right)^{\frac{n}{2}}\frac{n^{n}}{n!}.
      \]
      In particular, there is at least one ramified prime in $\mc{O}_{K}/\Z$ provided the degree of $K$ is at least $2$. 
    \end{corollary}
    \begin{proof}
      Since the norm of every integral ideal is at least $1$, $\pi < 4$, and $r_{2}$ is at most $n$, the desired inequality follows immediately from Minkowski's bound. Now suppose $n \ge 2$. In the case $n = 2$, the lower bound is larger than $1$ so that $|\D_{K}|$ is at least $2$ for every quadratic number field. As $n^{n} \ge n!$ for all $n \ge 1$ (which easily follows by induction), $\left(\frac{\pi}{4}\right)^{\frac{n}{2}}\frac{n^{n}}{n!}$ is an increasing function in $n$. Therefore $|\D_{K}| \ge 2$ for all $n \ge 2$ so that $|\D_{K}|$ has a prime divisor. This means at least one prime of $K$ ramifies in $\mc{O}_{K}/\Z$.
    \end{proof}

    Generally speaking, the class number $h_{K}$ is one of the most difficult pieces of arithmetic data about $K$ to compute. For example, it is still unknown if there are infinitely many number fields of class number $1$, that is, number fields such that their ring of integers are principal ideal domains.
  \section{Dirichlet's Unit Theorem}
    Let $K$ be a number field of signature $(r_{1},r_{2})$. We define the \textbf{rank}\index{rank} $r_{K}$ of $K$ to be
    \[
      r_{K} = r_{1}+r_{2}-1.
    \]
    This will be an important in the following. Another very important piece of arithmetic data about $K$ is the structure of the unit group $\mc{O}_{K}^{\ast}$. Note that $\mc{O}_{K}^{\ast}$ is closed under conjugation because $\Norm_{K}(\a) = \Norm_{K}(\conj{\a})$ as a consequence of \cref{prop:formulas_for_trace_and_norm}. Moreover, since the norm of a unit is $\pm1$, we can express the unit group as
    \[
      \mc{O}_{K}^{\ast} = \{\e \in \mc{O}_{K}:\Norm_{K}(\e) = \pm 1\}.
    \]
    Our main goal will be to describe the group structure of $\mc{O}_{K}^{\ast}$ completely. Let $\W$ denote the group of all roots of unity. We will set $\mu(K) = \mc{O}_{K}^{\ast} \cap \W$ so that $\mu(K)$ is the subgroup of $\mc{O}_{K}^{\ast}$ consisting of all of the roots of unity in $K$. Clearly $\{\pm 1\} \subseteq \mu(K)$. In fact, $\mu(K)$ is finite since any root of unity in $K$ is a root of $x^{n}-1$ and thus an $n$-th root of unity. We set
    \[
      w_{K} = |\mu(K)|.
    \]
    Our goal will be to show that $\mc{O}_{K}^{\ast}$ is a direct product of $\mu(K)$ and a free abelian group of rank $r_{K}$. Determining that the rank of the free group is exactly $r_{K}$ will be the most difficult part of the proof. We will require a map on $K^{\ast}$ that transitions between the field trace and the field norm. Let $\rho_{1},\ldots,\rho_{r_{1}}$ be the real $\Q$-embeddings of $\Hom_{\Q}(K,\conj{\Q})$ and $\tau_{1},\ldots,\tau_{r_{2}}$ be a complete set of representatives of pairs of complex $\Q$-embeddings of $\Hom_{\Q}(K,\conj{\Q})$. First consider the map
    \[
      \ell:K_{\R}^{\ast} \to \R^{r_{K}+1} \qquad (z_{\s})_{\s} \mapsto (\log|z_{\rho_{1}}|,\ldots,\log|z_{\rho_{r_{1}}}|,2\log|z_{\tau_{1}}|,\ldots,2\log|z_{\tau_{r_{2}}}|).
    \]
    This map is independent of the choice of representatives $\tau_{1},\ldots,\tau_{r_{2}}$ because $z_{\conj{\tau}} = \conj{z_{\tau}}$ for $\mathbf{z} \in K_{\R}$.
    We define the \textbf{logarithmic embedding}\index{logarithmic embedding} $\log_{K}$ of $K$ by
    \[
      \log_{K}:K^{\ast} \to \R^{r_{K}+1} \qquad \k \mapsto (\log|\rho_{1}(\k)|,\ldots,\log|\rho_{r_{1}}(\k)|,2\log|\tau_{1}(\k)|,\ldots,2\log|\tau_{r_{2}}(\k)|).
    \]
    Then $\log_{K}$ is just the restriction of $j$ to $K^{\ast}$ composed with $\ell$. Since $\ell$ is a homomorphism and $j$ is a $\Q$-embedding, $\log_{K}$ is a homomorphism. We distinguish the subsets
    \[
      S = \{\mathbf{x} \in  \R_{+}^{r_{K}+1}:\Norm_{\R^{r_{K}+1}/\R}(\mathbf{x}) = 1\} \quad \text{and} \quad H = \{\mathbf{x} \in \R^{r_{K}+1}:\Trace_{\R^{r_{K}+1}/\R}(\mathbf{x}) = 0\},
    \]
    called the \textbf{norm-one hypersurface}\index{norm-one hypersurface} and \textbf{trace-zero hyperplane}\index{trace-zero hyperplane} of $\R^{r_{K}+1}$ respectively. Note that $H$ is an $r_{K}$-dimensional subspace of $\R^{r_{K}+1}$. We will also make use of the subset
    \[
      U = \{\mathbf{z} \in K_{\R}:\Norm_{K_{\R}}(\mathbf{z}) = \pm 1\}.
    \]
    Let $\l$ denote the restriction of $\log_{K}$ to $\mc{O}_{K}^{\ast}$ and set
    \[
      \L = \log_{K}(\mc{O}_{K}^{\ast}),
    \]
    so that $\L$ is the image of $\l$. We call $\L$ the \textbf{unit lattice}\index{unit lattice} of $K$. It is not immediately obvious that $\L$ is a lattice, but we will show this and more. Observe that $\ell$ takes $U$ into $H$ since $\Trace_{\R^{r_{K}+1}/\R}(\ell(\mathbf{z})) = \log|\Norm_{K_{\R}}(\mathbf{z})| = 1$. In particular, $\L \subset H$ since $j(\mc{O}_{K}^{\ast}) \subset U$. All of this data can be collected into the following commutative diagram:

    \begin{center}
      \begin{tikzcd}[row sep=large, column sep=large]
        \mc{O}_{K}^{\ast} \arrow{d} \arrow{r}{j} \arrow[bend left]{rr}{\log_{K}} & U \arrow{d} \arrow{r}{\ell} & H \arrow{d} \\
        K^{\ast} \arrow{d}{\Norm} \arrow{r}{j} & K_{\R} \arrow{d}{\Norm_{K_{\R}}}^{\ast} \arrow{r}{\ell} & \R^{r_{K}+1} \arrow{d}{\Trace_{\R^{r_{K}+1}/\R}} \\
        \Q^{\ast} \arrow{r} & \R^{\ast} \arrow{r}{\log|\phantom{\cdot}|} & \R.
      \end{tikzcd}
    \end{center}
    We first show that the logarithmic embedding fits into an exact sequence:

    \begin{proposition}\label{prop:exact_sequence_for_Dirichlets_unit_theorem}
      Let $K$ be a number field. Then the sequence

      \begin{center}
        \begin{tikzcd}[row sep=large, column sep=large]
          1 \arrow{r} & \mu(K) \arrow{r} & \mc{O}_{K}^{\ast} \arrow{r}{\l} & \L \arrow{r} & 0,
        \end{tikzcd}
      \end{center}

      is exact.
    \end{proposition}
    \begin{proof}
      Exactness of this sequence means that $\mu(K)$ is the kernel of $\l$. If $\w \in \mu(K)$ then $|\w| = 1$ and it follows that $\l(\w) = 0$. Therefore $\ker\l$ contains $\mu(K)$. To see that this is all of $\ker\l$, suppose $\e \in \mc{O}_{K}^{\ast}$ is such that $\l(\e) = 0$. But then every component of $j(\e)$ is has absolute value $1$ and therefore belongs to a bounded subset of the Minkowski space $K_{\R}$. Since $\mc{O}_{K}^{\ast}$ is a subgroup of $\mc{O}_{K}$ and $j(\mc{O}_{K})$ is a complete lattice in $K_{\R}$ (as we have already remarked), $j(\mc{O}_{K}^{\ast})$ is a lattice in $K_{\R}$. But then $j(\e)$ belongs to a discrete set by \cref{prop:integral lattice_if_and_only_if_discrete_subgroup}. Together, $j(\e)$ belongs to a discrete and bounded set and hence is necessarily finite. Since $j$ is a $\Q$-embedding, it follows that the subgroup $\ker\l$ of $\mc{O}_{K}^{\ast}$ contains finitely many elements and hence only roots of unity because $\ker\l \subset K \subset \C$. Thus $\ker\l = \mu(K)$.
    \end{proof}

    Our aim now is to show that the unit lattice $\L$ is a a free abelian group of rank $r_{K}$. For this, we will require a lemma:

    \begin{lemma}\label{lem:finitely_many_elements_of_fixed_norm}
      Let $K$ be a number field. There are finitely many elements in $\mc{O}_{K}$ of a given norm up to multiplication by units.
    \end{lemma}
    \begin{proof}
      Recall that the norm of an algebraic integer is an integer and that the elements of norm $\pm1$ are exactly the units of $K$. Therefore it suffices to prove the claim for norm $n \ge 2$ (the norm is only zero for zero itself). Further recall that $\mc{O}_{K}/n\mc{O}_{K}$ is finite (with $\Norm_{K}(n\mc{O}_{K})$ many elements). Therefore, it suffices to show that in each coset there is at most one element of norm $n$ up to multiplication by units. To show this, suppose $\a$ and $\b$ are two representatives in the same class are are of norm $n$. Writing $\a = \b+n\g$ for some $n\g \in n\mc{O}_{K}$, we have
      \[
        \frac{\a}{\b} = 1+\frac{n}{\b}\g = 1+\frac{\Norm_{K}(\b)}{\b}\g,
      \]
      which is an element of $\mc{O}_{K}$ because $\frac{\Norm_{K}(\b)}{\b}$ is since $\Norm_{K}(\b) \in \b\mc{O}_{K}$ as any integral ideal contains it norm. Hence $\frac{\a}{\b} \in \mc{O}_{K}$, and interchanging the roles of $\a$ and $\b$ shows that $\frac{\b}{\a} \in \mc{O}_{K}$ too. But then $\frac{\a}{\b}$ is a unit in $\mc{O}_{K}$ and thus $\a$ and $\b$ differ up to multiplication by a unit.
    \end{proof}

    Recall that $\L \subset H$. We will show $\L$ is a lattice in $H$, actually a complete lattice, and compute its rank as a free abelian group:

    \begin{theorem}\label{thm:unit_group_complete_lattice}
      Let $K$ be a number field of degree $n$ and signature $(r_{1},r_{2})$. Then the unit lattice $\L$ is a complete lattice in the trace-zero hyperplane $H$ of $\R^{r_{K}+1}$. In particular, $\L$ is a free abelian group of rank $r_{K}$.
    \end{theorem}
    \begin{proof}
      Throughout, let $\s$ run over $\Hom_{\Q}(K,\conj{\Q})$, $\rho$ run over all such real $\Q$-embeddings, and $\tau$ run over a complete set of representatives of all such pairs of complex $\Q$-embeddings. We first prove $\L$ is a lattice in $H$. Since $\l$ is a homomorphism (because $\log_{K}$ is), $\L$ is a subgroup of $H$. So by \cref{prop:integral lattice_if_and_only_if_discrete_subgroup}, $\L$ is a lattice if and only if it is discrete. In particular, we will show that for any $c > 0$, the bounded region
      \[
        X = \{\mathbf{x} \in \R^{r_{K}+1}:\text{$|x_{\rho}| \le c$ and $|x_{\tau}| \le 2c$ for all $\rho$ and $\tau$}\},
      \]
      contains only finitely many points of $\L$. The preimage of $X$ under $\ell$ is
      \[
        \ell^{-1}(X) = \{\mathbf{z} \in K_{\R}:\text{$e^{-c} \le |z_{\s}| \le e^{c}$ for all $\s$}\},
      \]
      and hence it contains finitely many points of $j(\mc{O}_{K}^{\ast})$ because this is a subset of the lattice $j(\mc{O}_{K})$. It follows that $X$ contains finitely many points of $\L$ (as the preimage of $\mathbf{x}$ in $\R^{n}$ under $\ell$ contains $2^{n}$ points of $K_{\R}$) so that $\L$ is discrete and thus a lattice. We will now show that $\L$ is a complete lattice in $H$ and since $H$ is an $r_{K}$-dimensional real vector space, this will also prove the claim about the rank of $\L$. By \cref{prop:complete_integral lattice_if_and_only_if_bounded_translates_cover} it suffices to show that there is a bounded subset $M$ of the trace-zero hyperplane $H$ whose translates by $\L$ cover $H$. Actually, since $\ell$ is surjective it suffices to construct a bounded subset $T$ of $U$ such that
      \[
        U = \bigcup_{\e \in \mc{O}_{K}^{\ast}}j(\e)T.
      \]
      Indeed, if such $T$ exists then any $\mathbf{z} \in T$ satisfies $|\Norm_{K_{\R}}(\mathbf{z})| = \prod_{\s}|z_{\s}| = 1$ and hence each $z_{\s}$ is bounded above and away from zero because $T$ is bounded. Setting $M = \ell(T)$, it follows that $M$ is also bounded (because $\log|z|$ is continuous) and
      \[
        H = \bigcup_{\l}(M+\l).
      \]
      It now suffices to construct such a subset $T$. For every $\s$, fix constants $c_{\s} > 0$ satisfying
      \[
        c_{\s} = c_{\conj{\s}} \quad \text{and} \quad \prod_{\s}c_{\s} > \left(\frac{2}{\pi}\right)^{r_{2}}\sqrt{|D_{K}|},
      \]
      and set $C = \prod_{\s}c_{\s}$. Now consider the bounded subset
      \[
        Z = \{\mathbf{z} \in K_{\R}:\text{$|z_{\s}| < c_{\s}$ for all $\s$}\}.
      \]
      For any $\mathbf{w} \in U$, we have
      \[
        \mathbf{w}Z = \{\mathbf{z} \in K_{\R}:\text{$|z_{\s}| < |w_{\s}|c_{\s}$ for all $\s$}\},
      \]
      and $\prod_{\s}|w_{\s}|c_{\s} = \Norm_{K_{\R}}(\mathbf{w})C = C$ so that $\mathbf{w}Z$ is also bounded. By \cref{prop:Minkowski_space_isomorphism}, the volume of $\mathbf{w}Z$ is $2^{r_{2}}$ times the volume of
      \[
        X = \{\mathbf{x} \in \R^{n}:\text{$|x_{\rho}| < c_{\rho}$ and $x_{\tau}^{2}+x_{\conj{\tau}}^{2} < c_{\tau}^{2}$ for all $\rho$ and $\tau$}\},
      \]
      which is $\prod_{\rho}(2c_{\rho})\prod_{\tau}(\pi c_{\tau}^{2}) = C2^{r_{1}}\pi^{r_{2}}$ because $X$ is the product of $r_{1}$ many intervals each of length $2c_{\rho}$ and $r_{2}$ many disks each of of radius $c_{\tau}$. Thus $\Vol(\mathbf{w}Z) = C2^{r_{K}+1}\pi^{r_{2}}$. By \cref{prop:covolume_of_fractional_ideal_under_j}, $V_{j(\mc{O}_{K})} = \sqrt{|D_{K}|}$ and our choice of $C$ gives
      \[
        \Vol(\mathbf{w}Z) > 2^{n}V_{j(\mc{O}_{K})}.
      \]
      Since $j(\mc{O}_{K})$ is a complete lattice in $K_{\R}$, Minkowski's lattice point theorem implies that there exists some nonzero $\a \in \mc{O}_{K}$ such that $j(\a) \in \mathbf{w}Z$. Now by \cref{lem:finitely_many_elements_of_fixed_norm}, there exist finitely many nonzero elements $\a_{1},\ldots,\a_{m}$ of $\mc{O}_{K}$ such that every $\a \in \mc{O}_{K}$ with $0 < \Norm_{K}(\a) \le C$ is equal to $\a_{i}$ for some $1 \le i \le m$ by multiplying by a unit. Set
      \[
        T = U \cap \left(\bigcup_{1 \le i \le m}j(\a_{i})^{-1}Z\right).
      \]
      Then $T$ is a bounded subset of $U$ since $Z$ is a bounded subset of $K_{\R}$ (and thus the $j(\a_{i})^{-1}Z$ are too). We now claim that
      \[
        U = \bigcup_{\e \in \mc{O}_{K}^{\ast}}j(\e)T.
      \]
      Indeed, since $\mathbf{w}^{-1} \in U$ for any $\mathbf{w} \in U$  we have shown implies that there exists a nonzero $\a \in \mc{O}_{K}$ such that $j(\a) \in \mathbf{w}^{-1}Z$. Hence $j(\a) = \mathbf{w}^{-1}\mathbf{z}$ for some $\mathbf{z} \in Z$. But as
      \[
        |\Norm_{K}(\a)| = |\Norm_{K_{\R}}(j(\a))| = |\Norm_{K_{\R}}(\mathbf{w}^{-1}\mathbf{z})| = |\Norm_{K_{\R}}(\mathbf{z})| < C,
      \]
      it follows that there exists an $\a_{i}$ and $\e \in \mc{O}_{K}^{\ast}$ such that $\a_{i} = \a\e$. Writing $\mathbf{w} = j(\a)^{-1}\mathbf{z}$ (recall that $K_{\R}$ is commutative), we have 
      \[
        \mathbf{w} = j(\a)^{-1}\mathbf{z} = j(\a_{i}\e^{-1})^{-1}\mathbf{z} = j(\e)j(\a_{i})^{-1}\mathbf{z},
      \]
      where the last equality holds because $j$ is a $\Q$-embedding. As $\mathbf{w},j(\e) \in U$, we see that $j(\a_{i})^{-1}\mathbf{z} \in U$ and thus $j(\a_{i})^{-1}\mathbf{z} \in T$. But then $\mathbf{w} \in j(\e)T \subset U$ as desired.
    \end{proof}

    By \cref{thm:unit_group_complete_lattice}, there exist elements $\e_{1},\ldots,\e_{r_{K}}$ of $\mc{O}_{K}^{\ast}$ such that $\l(\e_{1}),\ldots,\l(\e_{r_{K}})$ is a basis for the unit lattice $\L$ by taking the preimage under $j$ of any basis for $\L$. We say that $\e_{1},\ldots,\e_{r_{K}}$ are a \textbf{system of fundamental units}\index{system of fundamental units} of $K$ and we call any such element a \textbf{fundamental unit}\index{fundamental unit} for $K$. The structure theorem for $\mc{O}_{K}^{\ast}$ known as \textbf{Dirichlet's unit theorem}\index{Dirichlet's unit theorem} says that $\mc{O}_{K}^{\ast}$ is a product of a root of unity in $K$ and powers of fundamental units:

    \begin{theorem*}[Dirichlet's unit theorem]
      Let $K$ be a number field of signature $(r_{1},r_{2})$. Then
      \[
        \mc{O}_{K}^{\ast} \cong \mu(K) \x \Z^{r_{K}}.
      \]
      In particular, if $\e_{1},\ldots,\e_{r_{K}}$ is a system of fundamental units for $K$ then any unit $\e$ of $K$ is of the form
      \[
        \e = \w\e_{1}^{\nu_{1}} \cdots \e_{r_{K}}^{\nu_{r_{K}}},
      \]
      for some $\w \in \mu(K)$ and $\nu_{i} \in \Z$ for $1 \le i \le r_{K}$.
    \end{theorem*}
    \begin{proof}
      By \cref{prop:exact_sequence_for_Dirichlets_unit_theorem} we have an exact sequence

      \begin{center}
        \begin{tikzcd}[row sep=large, column sep=large]
          1 \arrow{r} & \mu(K) \arrow{r} & \mc{O}_{K}^{\ast} \arrow{r}{\l} & \L \arrow{r} & 0,
        \end{tikzcd}
      \end{center}

      and by \cref{thm:unit_group_complete_lattice} we know that $\L$ is a free abelian group of rank $r_{K}$. Let $\e_{1},\ldots,\e_{r_{K}}$ be a system of fundamental units for $K$ and let $E$ be the subgroup of $\mc{O}_{K}^{\ast}$ generated by them. Then $\l$ induces an isomorphism between $E$ and $\L$ so that $\mu(K) \cap E = \{1\}$ because the sequence is exact. As $\mu(K)$ and $E$ are subgroups, $\mu(K) \cap E = \{1\}$ implies $\mc{O}_{K}^{\ast} \cong \mu(K) \x E$. Since $E \cong \Z^{r_{K}}$ (because $\L \cong \Z^{r_{K}}$), we have $\mc{O}_{K}^{\ast} \cong \mu(K) \x \Z^{r_{K}}$. Moreover, from the isomorphism $E \cong \Z^{r_{K}}$ we see that any element of $E$ is of the form $\e_{1}^{\nu_{1}} \cdots \e_{r_{K}}^{\nu_{r_{K}}}$ with $\nu_{i} \in \Z$ for $1 \le i \le r_{K}$. This completes the proof.
    \end{proof}

    Note that Dirichlet's unit theorem also implies that $\L$ is a complete lattice in $H$ (by the definition of $\l$). In other words, we may reference this result instead of \cref{thm:unit_group_complete_lattice}. We will now discuss the covolume $V_{\L}$ of $\L$. Let $\e_{1},\ldots,\e_{r_{K}}$ be a system of fundamental units for $K$. Then $\l(\e_{1}),\ldots,\l(\e_{r_{K}})$ is a basis for $\L$. Setting
    \[
      \l_{0} = \frac{1}{\sqrt{r_{K}+1}}\mathbf{1},
    \]
    we see that $\l_{0}$ is a unit vector in $\R^{r_{K}+1}$ since $||\mathbf{1}|| = r_{K}+1$ and is orthogonal to $H$ because $\Trace_{\R^{r_{K}+1}/\R}(\l_{0}) = \sqrt{r_{K}+1}$ is nonzero. As $\l_{0}$ is orthogonal to $\L \subset H$, we see that $\l_{0},\l(\e_{1}),\ldots,\l(\e_{r_{K}})$ is a basis for the complete lattice $\L' = \Z\l_{0}+\L$ in $\R^{r_{K}+1}$. Since $\l_{0}$ is a unit vector, the volume of the fundamental domain for $\L'$ in $\R^{r_{K}+1}$ is equal to the volume of the fundamental domain for $\L$ in $\H$. By \cref{prop:covolume_equals_volume_of_fundamental_domain}, the corresponding covolumes are equal which is to say $V_{\L} = V_{\L'}$. So it suffices to compute $V_{\L'}$. The generator matrix $P$ for $\L'$ associated to the basis $\l_{0},\l(\e_{1}),\ldots,\l(\e_{r_{K}})$ is given by
    \[
      P = \begin{pmatrix} \frac{1}{\sqrt{r_{K}+1}} & \l(\e_{1})_{1} & \cdots & \l(\e_{r_{K}})_{1} \\ \vdots & \vdots & & \vdots \\ \frac{1}{\sqrt{r_{K}+1}} & \l(\e_{1})_{r_{K}+1} & \cdots & \l(\e_{r_{K}})_{r_{K}+1} \end{pmatrix}.
    \]
    Adding all of the rows to a fixed row results in
    \[
      P' = \begin{pmatrix} \frac{1}{\sqrt{r_{K}+1}} & \l(\e_{1})_{1} & \cdots & \l(\e_{r_{K}})_{1} \\ \vdots & \vdots & & \vdots \\ \sqrt{r_{K}+1} & 0 & & 0 \\ \vdots & \vdots & & \vdots \\ \frac{1}{\sqrt{r_{K}+1}} & \l(\e_{1})_{r_{K}+1} & \cdots & \l(\e_{r_{K}})_{r_{K}+1} \end{pmatrix},
    \]
    because $\l(\e) \in H$ for all $\e \in \mc{O}_{K}^{\ast}$. As $P'$ differs from $P$ be row addition, their determinants are the same. Cofactor expanding along the row with all zeros except the first entry, and that this row is arbitrary, shows
    \begin{equation}\label{equ:covolume_of_unit_lattice}
      V_{\L} = \sqrt{r_{K}+1}R_{K},
    \end{equation}
    where $R_{K}$ is the absolute value of the determinant of any rank $r_{K}$ minor of
    \[
      \begin{pmatrix} \l(\e_{1})_{1} & \cdots & \l(\e_{r_{K}})_{1} \\ \vdots & & \vdots \\ \l(\e_{1})_{r_{K}+1} & \cdots & \l(\e_{r_{K}})_{r_{K}+1}  \end{pmatrix}.
    \]
    We call $R_{K}$ the \textbf{regulator}\index{regulator} of $K$. Since $V_{\L}$ is independent of the choice of basis, the regulator $R_{K}$ is independent of any choice of a system of fundamental units for $K$. Moreover, since $H$ is a real inner product space we see that the regulator is roughly a measure of the density of the fundamental units in $K$ (recall \cref{prop:covolume_equals_volume_of_fundamental_domain}). The smaller the regulator the more dense the fundamental units are.