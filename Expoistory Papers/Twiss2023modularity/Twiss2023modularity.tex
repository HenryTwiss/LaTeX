\documentclass[12pt,reqno,oneside]{amsart}
\usepackage{import}
\input{preamble}

%=================%
%  Title & Index  %
%=================%
\title{Modularity for the quadratic theta function}
\author{Henry Twiss}
\date{\today}
\makeindex

\begin{document}

\begin{abstract}
    The prototypical half-integral weight modular form is the quadratic theta function $\t(z) = \sum_{n \in \Z}e^{2\pi in^{2}z}$. While is it often mentioned that the factor of modularity is the theta multiplier $\tlegendre{c}{d}\e_{d}^{-1}(cz+d)^{\frac{1}{2}}$, there is not an easily available modern proof. This purpose of this paper is to present a full proof and show that $\t(z)$ is a weight $\frac{1}{2}$ modular form on $\G_{0}(4)\backslash\H$.
\end{abstract}

\maketitle

\section{Preliminaries}
    Let $N \ge 1$ and $k \ge 1$ be odd. A modular form $f:\H \to \C$ of half-integral weight $\frac{k}{2}$ on $\G_{0}(4N)\backslash\H$ is a function satisfying the following properties:
    \begin{enumerate}[label=(\roman*)]
        \item Holomorphy: $f$ is holomorphic on $\H$,
        \item Modularity: $f(\g z) = \tlegendre{c}{d}\e_{d}^{-k}(cz+d)^{\frac{k}{2}}f(z)$ for $\g = \begin{psmallmatrix} a & b \\ c & d \end{psmallmatrix} \in \G_{0}(4N)$,
        \item Holomorphy at the cusps: $f$ is holomorphic at the cusps of $\G_{0}(4N)\backslash\H$ and $f$ is a cuspform if it decays to zero near the cusps.
    \end{enumerate}
    Condition (ii) is the most important property. The factor of modularity
    \[
        j(\g,z) = \legendre{c}{d}\e_{d}^{-1}(cz+d)^{\frac{1}{2}},
    \]
    is called the theta multiplier. For the theta multiplier, we take the principal branch of the square root (we will always take the principal branch from now on), $\legendre{c}{d}$ is the Jacobi symbol ($d$ is necessarily odd since $\det(\g) = 1$ and $c \equiv 0 \tmod{4}$) with the stipulations $\legendre{c}{d} = \legendre{-c}{-d}$ (so that we may take $d > 0$) and $\legendre{0}{d} = 1$. This last requirement is simply $\legendre{0}{1} = 1$ because if $c = 0$ then $\det(\g) = 1$ implies $d = \pm 1$. Also, we set $\e_{d} = 1,i$ depending on if $d \equiv 1,3 \tmod{4}$.
    
    We define the quadratic theta function $\t(z)$ by
    \[
        \t(z) = \sum_{n \in \Z}e^{2\pi in^{2}z}.
    \]
    It obeys a simple relationship to Jacobi's theta function $\vt(z) = \sum_{n \in \Z}e^{-\pi n^{2}z}$:
    \begin{equation}\label{equ:Jacobi_theta_relation}
        \t\left(\frac{iz}{2}\right) = \vt(z),
    \end{equation}
    for $z \in \H$. It is well-known that $\t(z)$ is holomorphic on $\Re(z) > 0$, and so $\t(z)$ is holomorphic on $\H$. Moreover, Jacobi's theta function obeys the transformation law
    \begin{equation}\label{equ:Jacobi_transformation_law}
        \vt(z) = \frac{1}{\sqrt{z}}\vt\left(\frac{1}{z}\right).
    \end{equation}
\section{Modularity of \texorpdfstring{$\t(z)$}{t(z)}}:
    Poisson summation is the main ingredient needed to show $\t(z)$ is modular on $\G_{0}(4)\backslash\H$ of weight $\frac{1}{2}$ with factor of modularity given by the theta multiplier.

    \begin{theorem}\label{thm:modularity}
    Let $\g = \begin{psmallmatrix} a & b \\ c & d \end{psmallmatrix} \in \G_{0}(4)$. Then for $z \in \H$,
    \[
        \t(\g z) = \legendre{c}{d}\e_{d}^{-1}\sqrt{cz+d}\t(z).
    \]
    \end{theorem}
    \begin{proof}
        Recall that
        \begin{equation}\label{equ:generating_set}
            \G_{0}(4) = \left\<\begin{pmatrix} 1 & 0 \\ 4 & 1 \end{pmatrix},\begin{pmatrix} 1 & 1 \\ 0 & 1 \end{pmatrix}\right\> \quad \text{and} \quad \G_{0}(2) = \left\<\begin{pmatrix} 1 & 0 \\ 2 & 1 \end{pmatrix},\begin{pmatrix} 1 & 2 \\ 0 & 1 \end{pmatrix}\right\>.
        \end{equation}
        We first argue
        \[
            \G_{0}(4) = \begin{pmatrix} 2 & 0 \\ 0 & 1 \end{pmatrix}^{-1} \G(2) \begin{pmatrix} 2 & 0 \\ 0 & 1 \end{pmatrix}.
        \]
        This decomposition follows by \cref{equ:generating_set} and the computations
        \[
            \begin{pmatrix} 2 & 0 \\ 0 & 1 \end{pmatrix} \begin{pmatrix} 1 & 0 \\ 4 & 1 \end{pmatrix} \begin{pmatrix} 2 & 0 \\ 0 & 1 \end{pmatrix}^{-1} = \begin{pmatrix} 1 & 0 \\ 2 & 1 \end{pmatrix} \quad \text{and} \quad \begin{pmatrix} 2 & 0 \\ 0 & 1 \end{pmatrix} \begin{pmatrix} 1 & 1 \\ 0 & 1 \end{pmatrix} \begin{pmatrix} 2 & 0 \\ 0 & 1 \end{pmatrix}^{-1} = \begin{pmatrix} 1 & 2 \\ 0 & 1 \end{pmatrix}.
        \]
        We will now make two reductions to for the modularity condition. For the first reduction, define $\wtilde{\t}(z) = \t\left(\frac{z}{2}\right)$. Since $\t(z)$ is $1$-periodic, $\wtilde{\t}(z)$ is $2$-periodic. Moreover, for any $\g \in \G_{0}(4)$, let $\eta = \begin{psmallmatrix} a & 2b \\ \frac{c}{2} & d\end{psmallmatrix} \in \G(2)$ so that
        \[
            \g = \begin{pmatrix} 2 & 0 \\ 0 & 1 \end{pmatrix}^{-1} \eta \begin{pmatrix} 2 & 0 \\ 0 & 1 \end{pmatrix}.
        \]
        Then
        \begin{equation}\label{equ:reduction_1}
            \t(\g z) = \wtilde{\t}\left(2\begin{pmatrix} 2 & 0 \\ 0 & 1 \end{pmatrix}^{-1} \eta \begin{pmatrix} 2 & 0 \\ 0 & 1 \end{pmatrix}z\right) = \wtilde{\t}(2\eta z).
        \end{equation}
        It now suffices to prove a compatible modularity condition for $\wtilde{\t}(\eta z)$. This is the first reduction. For the second reduction, let $w = \begin{psmallmatrix} 0 & -1 \\ 1 & 0 \end{psmallmatrix}z = -\frac{1}{z}$. By \cref{equ:Jacobi_transformation_law}, we see that
        \[
            \wtilde{\t}(w) = \vt(-iw) = \frac{1}{\sqrt{-iw}}\vt\left(-\frac{1}{iw}\right) = \frac{1}{\sqrt{-iw}}\wtilde{\t}\left(\frac{-1}{w}\right) = \sqrt{\frac{z}{i}}\wtilde{\t}(z).
        \]
        Since $\begin{psmallmatrix} 0 & -1 \\ 1 & 0 \end{psmallmatrix}^{2} = I$, if we let $\eta' = \begin{psmallmatrix} a' & b' \\ c' & d' \end{psmallmatrix}$ where $\eta'$ is defined by
        \[
            \eta' = \eta\begin{pmatrix} 0 & -1 \\ 1 & 0 \end{pmatrix} = \begin{pmatrix} 2b & -a \\ d & -\frac{c}{2} \end{pmatrix},
        \]
        then
        \begin{equation}\label{equ:reduction_2}
            \wtilde{\t}(\eta z) = \wtilde{\t}\left(\eta \begin{pmatrix} 0 & -1 \\ 0 & 1 \end{pmatrix}^{2} z\right) = \wtilde{\t}(\eta'w).
        \end{equation}
        By \cref{equ:reduction_1,equ:reduction_2} it further suffices to prove a compatible modularity condition for $\wtilde{\t}(\eta'w)$. This is the second reduction and is what we will prove. To apply Poisson summation we need to sieve out an additive character in $\wtilde{\t}(\eta'w)$. To acomplish this, observe
        \[
            \eta' w = \frac{a'w+b'}{c'w+d'} = \frac{c'(a'w+b')}{c'(c'w+d')} = \frac{a'c'w+a'd'-1}{c'(c'w+d')} = \frac{a'(c'w+d')-1}{c'(c'w+d')} = \frac{a'}{c'}-\frac{1}{c'(c'w+d')}.
        \]
        We can now sieve out the character:
        \begin{equation}\label{equ:character_sieve}
            \begin{aligned}
                \wtilde{\t}(\eta'w) &= \sum_{n \in \Z}e^{\pi in^{2}\eta'w} \\
                &= \sum_{n \in \Z}e^{\pi in^{2}\left(\frac{a'}{c'}-\frac{1}{c'(c'w+d')}\right)} \\
                &= \sum_{n \in \Z}e^{\frac{2\pi in^{2}\frac{a'}{2}}{c'}}e^{-\frac{\pi in^{2}}{c'(c'w+d')}} \\
                &= \sum_{\a \tmod{c'}}e^{\frac{2\pi in^{2}\frac{a'}{2}}{c'}}\sum_{m \in \Z}e^{-\frac{\pi i(c'm+\a)^{2}}{c'(c'w+d')}} \\
                &= \sum_{\a \tmod{c'}}e^{\frac{2\pi i\a^{2}\frac{a'}{2}}{c'}}\sum_{m \in \Z}e^{-\frac{\pi ic'\left(m+\frac{\a}{c'}\right)^{2}}{c'w+d'}},
            \end{aligned}
        \end{equation}
        where the second to last equality follows because $e^{\frac{2\pi in^{2}\frac{a'}{2}}{c'}}$ only depends on $n$ modulo $c'$. Indeed, $\frac{a'}{2} = b$ is an integer and writing $n = mc'+\a$ with $\a$ taken modulo $c'$ we have $(mc'+\a)^{2} \equiv \a^{2} \tmod{c'}$. We will apply Poisson summation to the sum
        \[
            \sum_{m \in \Z}e^{-\frac{\pi ic'\left(m+\frac{\a}{c'}\right)^{2}}{c'w+d'}}.
        \]
        By the identity theorem, it suffices to prove a transformation formula for $\wtilde{\t}(\eta w)$ on a set containing a limit point. We will prove this on a vertical line in $\H$, so set $w = \frac{iy-d'}{c'}$ for $y > 0$. Now set
        \[
            f(x) = e^{-\frac{\pi ic'\left(x+\frac{\a}{c'}\right)^{2}}{c'w+d'}},
        \]
        and observe $f(x)$ is a Schwarz function. We compute its Fourier transform:
        \begin{equation}\label{equ:Fourier_transform_1}
            \hat{f}(t) = \int_{-\infty}^{\infty}f(x)e^{-2\pi itx}\,dx = \int_{-\infty}^{\infty}e^{-\frac{\pi ic'\left(x+\frac{\a}{c'}\right)^{2}}{c'w+d'}}e^{-2\pi itx}\,dx = \int_{-\infty}^{\infty}e^{-\pi\left(\frac{ic'\left(x+\frac{\a}{c'}\right)^{2}}{c'w+d'}+2itx\right)}\,dx.
        \end{equation}
        Making the change of variables $x \to \sqrt{-\frac{i(c'w+d')}{c'}}x-\frac{\a}{c'}$ the last integral in \cref{equ:Fourier_transform_1} gives
        \begin{equation}\label{equ:Fourier_transform_2}
            \sqrt{-\frac{i(c'w+d')}{c'}}e^{\frac{2\pi i t\a}{c'}}\int_{-\infty}^{\infty}e^{-\pi\left(x^{2}+2itx\sqrt{-\frac{i(c'w+d')}{c'}}\right)}\,dx = \sqrt{\frac{c'w+d'}{ic'}}e^{\frac{2\pi i t\a}{c'}}\int_{-\infty}^{\infty}e^{-\pi\left(x^{2}+2itx\sqrt{-\frac{i(c'w+d')}{c'}}\right)}\,dx.
        \end{equation}
        Complete the square in the exponent of the last integral in \cref{equ:Fourier_transform_2}:
        \[
            -\pi\left(x^{2}+2itx\sqrt{-\frac{i(c'w+d')}{c'}}\right) = -\pi\left(\left(x+it\sqrt{-\frac{i(c'w+d')}{c'}}\right)^{2}-\frac{it^{2}(c'w+d')}{c'}\right),
        \]
        This implies that the last integral in \cref{equ:Fourier_transform_2} is equal to
        \[
            \sqrt{\frac{c'w+d'}{ic'}}e^{\frac{2\pi i t\a}{c'}}e^{\frac{\pi it^{2}(c'w+d')}{c'}}\int_{-\infty}^{\infty}e^{-\pi\left(x+it\sqrt{-\frac{i(c'w+d')}{c'}}\right)^{2}}\,dx.
        \]
        The change of variables $x \to x-it\sqrt{-\frac{i(c'w+d')}{c'}}$ is valid by complexifying the integral, noting that the integrand is entire, and shifting the line of integration. This results in
        \[
            \sqrt{\frac{c'w+d'}{ic'}}e^{\frac{2\pi i t\a}{c'}}e^{\frac{\pi it^{2}(c'w+d')}{c'}}\int_{-\infty}^{\infty}e^{-\pi x^{2}}\,dx = \sqrt{\frac{c'w+d'}{ic'}}e^{\frac{2\pi i t\a}{c'}}e^{\frac{\pi it^{2}(c'w+d')}{c'}}.
        \]
        where equality follows because the remaining integral is the Gaussian integral. In conclusion,
        \begin{equation}\label{equ:Fourier_transform_result}
            \hat{f}(t) = \sqrt{\frac{c'w+d'}{ic'}}e^{\frac{2\pi i t\a}{c'}}e^{\frac{\pi it^{2}(c'w+d')}{c'}}.
        \end{equation}
        Poisson summation along with \cref{equ:character_sieve,equ:Fourier_transform_result} give the first and second equalities in the following chain:
        \begin{equation}\label{equ:computation_after_Poisson_summation}
            \begin{aligned}
                \wtilde{\t}(\eta' w) &= \sum_{\a \tmod{c'}}e^{\frac{2\pi i\a^{2}\frac{a'}{2}}{c'}}\sum_{m \in \Z}f(m) \\
                &= \sum_{\a \tmod{c'}}e^{\frac{2\pi i\a^{2}\frac{a'}{2}}{c'}}\sum_{t \in \Z}\hat{f}(t) \\
                &= \sum_{\a \tmod{c'}}e^{\frac{2\pi i\a^{2}\frac{a'}{2}}{c'}}\sum_{t \in \Z}\sqrt{\frac{c'w+d'}{ic'}}e^{\frac{2\pi i t\a}{c'}}e^{\frac{\pi it^{2}(c'w+d')}{c'}} \\
                &= \sqrt{\frac{c'w+d'}{ic'}}\sum_{\a \tmod{c'}}e^{\frac{2\pi i\a^{2}\frac{a'}{2}}{c'}}\sum_{t \in \Z}e^{\frac{2\pi i t\a}{c'}}e^{\frac{\pi it^{2}(c'w+d')}{c'}} \\
                &= \sqrt{\frac{c'w+d'}{ic'}}\sum_{t \in \Z}e^{\frac{\pi it^{2}(c'w+d')}{c'}}\sum_{\a \tmod{c'}}e^{\frac{2\pi i\a^{2}\frac{a'}{2}}{c'}}e^{\frac{2\pi i t\a}{c'}} \\
                &= \sqrt{\frac{c'w+d'}{ic'}}\sum_{t \in \Z}e^{\pi it^{2}w}\sum_{\a \tmod{c'}}e^{\frac{2\pi i\left(\a^{2}\frac{a'}{2}+t\a+t^{2}\frac{d'}{2}\right)}{c'}}.
            \end{aligned}
        \end{equation}
        Now $\det(\eta') = 1$ implies $a'd' \equiv 1 \tmod{c'}$. In other words, $a'$ and $d'$ are inverses modulo $c'$. Then $\frac{a'}{2}(\a+td')^{2} \equiv \a^{2}\frac{a'}{2}+t\a+t^{2}\frac{d'}{2} \tmod{c'}$, so the last line in \cref{equ:computation_after_Poisson_summation} is equal to
        \[
            \sqrt{\frac{c'w+d'}{ic'}}\sum_{t \in \Z}e^{\pi it^{2}w}\sum_{\a \tmod{c'}}e^{\frac{2\pi i\frac{a'}{2}(\a+td')^{2}}{c'}}.
        \]
        For fixed $t$, $\a \to \a-td'$ is a bijection on $\Z/c'\Z$. Since, $\det(\eta') = 1$ implies $(d',c') = 1$ so that $\a \to \a d'$ is a bijection on $\Z/c'\Z$ too. Moreover, $a'd' \equiv 1 \tmod{c'}$. These facts justify the first three equalities in the following chain:
        \begin{equation}\label{equ:simplification_1}
            \sum_{\a \tmod{c'}}e^{\frac{2\pi i\frac{a'}{2}(\a+td')^{2}}{c'}} = \sum_{\a \tmod{c'}}e^{\frac{2\pi i\frac{a'}{2}\a^{2}}{c'}} = \sum_{\a \tmod{c'}}e^{\frac{2\pi i\frac{a'}{2}(\a d')^{2}}{c'}} = \sum_{\a \tmod{c'}}e^{\frac{2\pi i\frac{d'}{2}\a^{2}}{c'}} = g\left(\frac{d'}{2},c'\right).
        \end{equation}
        The last equality is the definition of the Gauss sum. The quadratic Gauss sum has explicit evaulation:
        \begin{equation}\label{equ:simplification_2}
            g\left(\frac{d'}{2},c'\right) = \legendre{\frac{d'}{2}}{c'}\e_{c'}\sqrt{c'}.
        \end{equation}
        \cref{equ:simplification_1,equ:simplification_2} together imply
        \[
            \sqrt{\frac{c'w+d'}{ic'}}\sum_{t \in \Z}e^{\pi it^{2}w}\sum_{\a \tmod{c'}}e^{\frac{2\pi i\frac{a'}{2}(\a+td')^{2}}{c'}} = \legendre{\frac{d'}{2}}{c'}\e_{c'}\sqrt{c'}\sqrt{\frac{c'w+d'}{ic'}}\sum_{t \in \Z}e^{\pi it^{2}w} = \legendre{\frac{d'}{2}}{c'}\e_{c'}\sqrt{\frac{c'w+d'}{i}}\wtilde{\t}(w).
        \]
        All together we have shown
        \begin{equation}\label{equ:modularity_condition_packed_1}
            \wtilde{\t}(\eta' w) = \legendre{\frac{d'}{2}}{c'}\e_{c'}\sqrt{\frac{c'w+d'}{i}}\wtilde{\t}(w).
        \end{equation}
        We will unpack this modularity condition to one for $\t(z)$. Rewriting \cref{equ:modularity_condition_packed_1} in terms of $\eta$, and noting that $\tlegendre{\frac{c}{4}}{d} = \tlegendre{c}{d}$ because $c \equiv 0 \tmod{4}$, gives
        \begin{equation}\label{equ:modularity_condition_packed_2}
            \wtilde{\t}(\eta z) = \legendre{c}{d}\legendre{-1}{d}\e_{d}\sqrt{\frac{dz-\frac{c}{2}}{i}}\wtilde{\t}(z).
        \end{equation}
        By changing variables $z \to 2z$ and rewriting \cref{equ:modularity_condition_packed_2} in terms of $\t(z)$, we find
        \[
            \t(\g z) = \legendre{c}{d}\legendre{-1}{d}\e_{d}\sqrt{\frac{-\left(\frac{d}{2z}+\frac{c}{2}\right)}{i}}\sqrt{\frac{2z}{i}}\t(z) = \legendre{c}{d}\e_{d}^{-1}\sqrt{cz+d}\t(z),
        \]
        where the last equality follows because $\legendre{-1}{d} = 1,-1$ depending on if $d \equiv 1,3 \tmod{4}$ so that $\legendre{-1}{d}\e_{d} = \e_{d}^{-1}$.
    \end{proof}
\section{The Modular Form \texorpdfstring{$\t(z)$}{t(z)} \& Additional Results}
    To complete the verification that $\t(z)$ is a modular form, we need to verify holomorphy at the cusps. There are three cusps of $\G_{0}(4)$ and they are $\infty$, $0$, and $\frac{1}{2}$ respectively. To see this, we compute the orbits of $\infty$, $0$, and $\frac{1}{2}$:
    \begin{align*}
        \G_{0}(4)\infty &= \left\{\frac{a}{c}:(a,c) = 1, c \equiv 0 \tmod{4} \right\} \\
        \G_{0}(4)0 &= \left\{\frac{b}{d}:(b,d) = 1, d \equiv 1,3 \tmod{4} \right\} \\
        \G_{0}(4)\frac{1}{2} &= \left\{\frac{b}{d}:(b,d) = 1, d \equiv 2 \tmod{4} \right\},
    \end{align*}
    Every element of $\Q \cup \{\infty\}$ belongs to one of these three distinct sets so $\infty$, $0$, and $\frac{1}{2}$ are all the cusps. We only need to verify holomorphy on a set of scaling matrices for the cusps, so let us choose the scaling matrices
    \[
        \s_{\infty} = I, \s_{0} = \begin{pmatrix} 0 & -1 \\ 1 & 0 \end{pmatrix}, \quad \s_{0} = \begin{pmatrix} 0 & -1 \\ 1 & 0 \end{pmatrix}, \quad \text{and} \quad \s_{\frac{1}{2}} = \begin{pmatrix} 1 & 1 \\ 2 & 3 \end{pmatrix}.
    \]
    For the cusp at $\infty$, \cref{equ:Jacobi_theta_relation} implies
    \[
        |\t(z)| \ll \vt(\Im(z)) \ll 1,
    \]
    for large $z$. For the cusps at $0$ and $\frac{1}{2}$, we have analogous estimates:
    \[
    \t(\s_{0} z) \ll \sum_{n \in \Z}e^{-\frac{2\pi in^{2}\conj{z}}{|z|^{2}}} \ll 1 \quad \text{and} \quad \t(\s_{\frac{1}{2}} z) \ll \sum_{n \in \Z}e^{\frac{2\pi in^{2}(2|z|+3z+2\conj{z}+1)}{|2z+3|^{2}}} \ll 1,
    \]
    This proves $\t(z)$ is holomorphic at the cusps. Since $\t(z)$ is holomorphic on $\H$ and at the cusps, \cref{thm:modularity} implies $\t(z)$ is a modular form on $\G_{0}(4)\backslash\H$ of weight $\frac{1}{2}$. We package this into a theorem:

    \begin{theorem}\label{thm:quadratic_theta_is_modular}
    The quadratic theta function
    \[
        \t(z) = \sum_{n \in \Z}e^{2\pi in^{2}z},
    \]
    is a modular form of of weight $\frac{1}{2}$ on $\G_{0}(4)\backslash\H$.
    \end{theorem}

    If we square the quadratic theta function $\t^{2}(z)$ we obtain a modular form of odd weight and nontrivial character:

    \begin{corollary}
        $\t^{2}(z)$ is a weight $1$ modular form on $\G_{0}(4)\backslash\H$ with character $\tlegendre{-1}{d}$.
    \end{corollary}
    \begin{proof}
        Squaring the modularity condition in \cref{thm:modularity} gives
        \[
            \t^{2}(\g z) = \legendre{-1}{d}(cz+d)\t^{2}(z).
        \]
        The holomorphy condititions for $\t^{2}(z)$ follow from those of $\t(z)$.
    \end{proof}
    
    The most surprising fact about $\t(z)$ and $\t^{2}(z)$ is that their factors of modularity contain (modified) Jacobi symbols. The reason this is surprising is that these symbols have nothing to do with the congruence subgroup $\G_{0}(4)$, and so the modular forms are ``seeing more'' than what the congruence subgroup is controlling.
    
    As a last corollary, we have an interesting identity involving Jacobi symbols:

    \begin{corollary}
    Let $\g = \begin{psmallmatrix} a & b \\ c & d \end{psmallmatrix},\g' = \begin{psmallmatrix} a' & b' \\ c' & d' \end{psmallmatrix} \in \G_{0}(4)$. Then
    \[
        \legendre{c'a+d'c}{c'b+d'd}\e_{d'd}^{-1} = \legendre{c'}{d'}\legendre{c}{d}\e_{d'}^{-1}\e_{d}^{-1}
    \]
    \end{corollary}
    \begin{proof}
    By \cref{thm:modularity}, the theta multiplier $j(\g,z)$ satisfies the coycycle condition. As a consquence, we find
    \[
        \legendre{c'a+d'c}{c'b+d'd}\e_{c'b+d'd}^{-1} = \legendre{c'}{d'}\legendre{c}{d}\e_{d'}^{-1}\e_{d}^{-1}.
    \]
    But $\e_{c'b+d'd} = \e_{d'd}$ because $c'b+d'd \equiv d'd \tmod{4}$ since $c \equiv 0 \tmod{4}$.
    \end{proof}

\end{document}